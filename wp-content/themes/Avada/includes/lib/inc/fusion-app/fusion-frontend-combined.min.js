var cssua=function(e,t,i){"use strict";var n=" ua-",o=/\s*([\-\w ]+)[\s\/\:]([\d_]+\b(?:[\-\._\/]\w+)*)/,s=/([\w\-\.]+[\s\/][v]?[\d_]+\b(?:[\-\._\/]\w+)*)/g,a=/\b(?:(blackberry\w*|bb10)|(rim tablet os))(?:\/(\d+\.\d+(?:\.\w+)*))?/,r=/\bsilk-accelerated=true\b/,l=/\bfluidapp\b/,u=/(\bwindows\b|\bmacintosh\b|\blinux\b|\bunix\b)/,d=/(\bandroid\b|\bipad\b|\bipod\b|\bwindows phone\b|\bwpdesktop\b|\bxblwp7\b|\bzunewp7\b|\bwindows ce\b|\bblackberry\w*|\bbb10\b|\brim tablet os\b|\bmeego|\bwebos\b|\bpalm|\bsymbian|\bj2me\b|\bdocomo\b|\bpda\b|\bchtml\b|\bmidp\b|\bcldc\b|\w*?mobile\w*?|\w*?phone\w*?)/,c=/(\bxbox\b|\bplaystation\b|\bnintendo\s+\w+)/,p={parse:function(e,t){var i={};if(t&&(i.standalone=t),!(e=(""+e).toLowerCase()))return i;for(var n,p,f=e.split(/[()]/),h=0,g=f.length;h<g;h++)if(h%2){var m=f[h].split(";");for(n=0,p=m.length;n<p;n++)if(o.exec(m[n])){var v=RegExp.$1.split(" ").join("_"),b=RegExp.$2;(!i[v]||parseFloat(i[v])<parseFloat(b))&&(i[v]=b)}}else{var y=f[h].match(s);if(y)for(n=0,p=y.length;n<p;n++){var w=y[n].split(/[\/\s]+/);w.length&&"mozilla"!==w[0]&&(i[w[0].split(" ").join("_")]=w.slice(1).join("-"))}}if(d.exec(e))i.mobile=RegExp.$1,a.exec(e)&&(delete i[i.mobile],i.blackberry=i.version||RegExp.$3||RegExp.$2||RegExp.$1,RegExp.$1?i.mobile="blackberry":"0.0.1"===i.version&&(i.blackberry="7.1.0.0"));else if(u.exec(e))i.desktop=RegExp.$1;else if(c.exec(e)){i.game=RegExp.$1;var _=i.game.split(" ").join("_");i.version&&!i[_]&&(i[_]=i.version)}return i.intel_mac_os_x?(i.mac_os_x=i.intel_mac_os_x.split("_").join("."),delete i.intel_mac_os_x):i.cpu_iphone_os?(i.ios=i.cpu_iphone_os.split("_").join("."),delete i.cpu_iphone_os):i.cpu_os?(i.ios=i.cpu_os.split("_").join("."),delete i.cpu_os):"iphone"!==i.mobile||i.ios||(i.ios="1"),i.opera&&i.version?(i.opera=i.version,delete i.blackberry):r.exec(e)?i.silk_accelerated=!0:l.exec(e)&&(i.fluidapp=i.version),i.applewebkit?(i.webkit=i.applewebkit,delete i.applewebkit,i.opr&&(i.opera=i.opr,delete i.opr,delete i.chrome),i.safari&&(i.chrome||i.crios||i.opera||i.silk||i.fluidapp||i.phantomjs||i.mobile&&!i.ios?delete i.safari:i.version&&!i.rim_tablet_os?i.safari=i.version:i.safari={419:"2.0.4",417:"2.0.3",416:"2.0.2",412:"2.0",312:"1.3",125:"1.2",85:"1.0"}[parseInt(i.safari,10)]||i.safari)):i.msie||i.trident?(i.opera||(i.ie=i.msie||i.rv),delete i.msie,i.windows_phone_os?(i.windows_phone=i.windows_phone_os,delete i.windows_phone_os):"wpdesktop"!==i.mobile&&"xblwp7"!==i.mobile&&"zunewp7"!==i.mobile||(i.mobile="windows desktop",i.windows_phone=+i.ie<9?"7.0":+i.ie<10?"7.5":"8.0",delete i.windows_nt)):(i.gecko||i.firefox)&&(i.gecko=i.rv),i.rv&&delete i.rv,i.version&&delete i.version,i},format:function(e){function t(e,t){e=e.split(".").join("-");var i=n+e;if("string"==typeof t){for(var o=(t=t.split(" ").join("_").split(".").join("-")).indexOf("-");o>0;)i+=n+e+"-"+t.substring(0,o),o=t.indexOf("-",o+1);i+=n+e+"-"+t}return i}var i="";for(var o in e)o&&e.hasOwnProperty(o)&&(i+=t(o,e[o]));return i},encode:function(e){var t="";for(var i in e)i&&e.hasOwnProperty(i)&&(t&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t}};p.userAgent=p.ua=p.parse(t,i);var f=p.format(p.ua)+" js";return e.className?e.className=e.className.replace(/\bno-js\b/g,"")+f:e.className=f.substr(1),p}(document.documentElement,navigator.userAgent,navigator.standalone),FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Toolbar=window.wp.Backbone.View.extend({isSidebarOpen:!1,template:FusionPageBuilder.template(jQuery("#fusion-app-front-end-toolbar").html()),events:{"click .trigger-submenu-toggling":"toggleSubMenu","click .fusion-builder-preview-viewport .toggle-viewport":"previewViewport","click #fusion-frontend-builder-toggle-global-panel":"togglePanel","click .fusion-exit-builder-list a":"exitBuilder","click [data-link]":"languageSwitch","click .preview a":"previewToggle","click .toolbar-toggle a":"toolbarToggle","click .fusion-builder-save-page":"savePage","click .fusion-builder-keyboard-shortcuts":"openKeyBoardShortCuts","change .save-wrapper .post-status input":"updatePostStatus"},initialize:function(e){this.languageData={switcher:!1,active:!1},this.viewport="desktop",this.languageFlags=!0,this.previewMode=!1,this.toggleSubMenusCloseHandler(),this.listenTo(e.fusionApp,"change:hasChange",this.render),this.listenTo(FusionEvents,"fusion-disconnected",this.setWarningColor),this.listenTo(FusionEvents,"fusion-reconnected",this.removeWarningColor),this.listenTo(FusionEvents,"fusion-sidebar-toggled",this.setActiveStyling),this.listenTo(FusionEvents,"fusion-app-setup",this.reEnablePreviewMode)},render:function(){return this.$el.html(this.template({switcher:this.languageData.switcher,postChanged:FusionApp.get("hasChange"),postStatus:FusionApp.getPost("post_status"),sidebarOpen:jQuery("body").hasClass("expanded")})),void 0!==FusionApp&&FusionApp.builderToolbarView&&jQuery(".fusion-builder-live-toolbar").append(FusionApp.builderToolbarView.render().el),this.previewViewport(),this},previewViewport:function(e){var t=this,i=jQuery("li.fusion-builder-preview-viewport .viewport-indicator"),n=jQuery(i.find("a[data-indicate-viewport]"));e&&(e.preventDefault(),this.viewport=jQuery(e.currentTarget).attr("data-viewport")),_.each(n,function(e){var i=jQuery(e).data("indicate-viewport");jQuery(e).removeClass("active"),t.viewport===i&&jQuery(e).addClass("active")}),jQuery("a.viewport-indicator > span").removeClass("active"),jQuery('a.viewport-indicator > span[data-indicate-viewport="'+t.viewport+'"]').addClass("active"),jQuery(window).trigger("resize"),jQuery("#fb-preview")[0].contentWindow.jQuery("body").trigger("resize"),jQuery("#fb-preview").attr("data-viewport",t.viewport)},previewToggle:function(e){e&&e.preventDefault(),this.previewMode?(jQuery("body").removeClass("fusion-builder-preview-mode"),jQuery("#fb-preview")[0].contentWindow.jQuery("body").removeClass("fusion-builder-preview-mode"),jQuery(".fusion-builder-live .fusion-builder-live-toolbar .fusion-toolbar-nav li.preview a").removeClass("active"),this.isSidebarOpen&&(FusionApp.sidebarView.openSidebar(),this.isSidebarOpen=!1),jQuery("#fb-preview")[0].contentWindow.jQuery("#fusion-preview-frame-builder-no-controls-css-css").attr("media","none"),this.previewMode=!1,FusionEvents.trigger("fusion-preview-toggle")):this.enablePreviewMode(!0)},reEnablePreviewMode:function(){this.previewMode&&this.enablePreviewMode(!1)},toolbarToggle:function(e){void 0!==e&&e.preventDefault(),jQuery("body").toggleClass("collapsed-toolbar")},enablePreviewMode:function(e){e=void 0!==e&&e,jQuery("#fb-preview")[0].contentWindow.jQuery("body").addClass("fusion-builder-preview-mode"),jQuery("body").addClass("fusion-builder-preview-mode"),jQuery(".fusion-builder-live .fusion-builder-live-toolbar .fusion-toolbar-nav li.preview a").addClass("active"),e&&(this.isSidebarOpen=FusionApp.sidebarView.panelIsOpen(),FusionApp.sidebarView.closeSidebar(),this.clearSelection(jQuery("#fb-preview")[0].contentWindow),jQuery("#fb-preview").contents().find(".medium-editor-toolbar-actions.visible").removeClass("visible"),jQuery(".ui-dialog-content").dialog("close")),jQuery("#fb-preview")[0].contentWindow.jQuery("#fusion-preview-frame-builder-no-controls-css-css").attr("media","all"),this.previewMode=!0,FusionEvents.trigger("fusion-preview-toggle")},clearSelection:function(e){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():e.selection&&e.selection.empty()},exitBuilder:function(e){var t=jQuery(e.currentTarget),i=t.attr("href"),n=jQuery("#fb-preview").attr("src");e.preventDefault(),t.parent().hasClass("exit-to-dashboard")||(t.parent().hasClass("exit-to-back-end")?i=FusionApp.data.backendLink||t.data("admin-url")+"?post="+FusionApp.getPost("post_id")+"&action=edit":(-1!==n.indexOf("builder=true")&&"?"===(n=(n=n.split("builder=true"))[0])[n.length-1]&&(n=n.slice(0,-1)),i=n)),FusionApp.modifierActive?window.open(i,"_blank"):FusionApp.hasContentChanged("page")?FusionApp.confirmationPopup({title:fusionBuilderText.unsaved_changes,content:fusionBuilderText.changes_will_be_lost,class:"fusion-confirmation-unsaved-changes",actions:[{label:fusionBuilderText.cancel,classes:"cancel no",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.just_leave,classes:"dont-save yes",callback:function(){FusionApp.manualSwitch=!0,window.location.href=i}},{label:fusionBuilderText.leave,classes:"save yes",callback:function(){var e={action:"exit_builder"};e.link=i,FusionApp.savePostContent(e)}}]}):(FusionApp.manualSwitch=!0,window.location.href=i)},updateLanguageSwitcher:function(){this.languageData={switcher:FusionApp.data.languageSwitcher,active:FusionApp.data.language},this.render()},getLanguageFlag:function(e,t){var i="";return void 0===e&&(i=t),this.languageFlags&&(void 0!==e.flag&&(i='<img src="'+e.flag+'" /> '),void 0!==e.country_flag_url&&(i='<img src="'+e.country_flag_url+'" /> ')),i},getLanguageLabel:function(e,t){var i="";return void 0===e&&(i=t),void 0!==e.native_name&&(i+=e.native_name),void 0!==e.name&&(i+=e.name),i},getLanguageLink:function(e,t){return void 0===e?t:void 0!==e.url?e.url:t},languageSwitch:function(e){var t=jQuery(e.currentTarget).data("link");e.preventDefault(),""!==t&&(FusionApp.hasContentChanged("global")?FusionApp.fullRefresh(t,e):FusionApp.checkLink(e,t))},togglePanel:function(e){void 0!==e&&e.preventDefault(),void 0!==FusionApp.sidebarView.togglePanel&&FusionApp.sidebarView.togglePanel()},setActiveStyling:function(e){var t=this.$el.find("#fusion-frontend-builder-toggle-global-panel");e?t.addClass("active"):t.removeClass("active")},toggleSubMenu:function(e){var t,i=jQuery(e.target),n=jQuery(".fusion-builder-live-toolbar .trigger-submenu-toggling"),o=jQuery(".fusion-builder-live-toolbar .submenu-trigger-target");void 0!==e&&e.preventDefault(),jQuery("body").hasClass("fusion-hide-all-tooltips")||(i.hasClass("trigger-submenu-toggling")||(i=jQuery(i.closest(".trigger-submenu-toggling"))),(t=i.parent().find(".submenu-trigger-target")).length&&("false"===t.attr("aria-expanded")?(t.attr("aria-expanded","true"),i.addClass("active"),_.each(n,function(e){jQuery(e)[0]!==jQuery(i)[0]&&jQuery(e).removeClass("active")}),_.each(o,function(e){jQuery(e)[0]!==jQuery(t)[0]&&jQuery(e).attr("aria-expanded","false")})):(t.attr("aria-expanded","false"),i.removeClass("active"))))},toggleSubMenusCloseHandler:function(){var e,t,i=!1;try{t={get passive(){return i=!0,!0}},window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){i=!1}e=!!i&&{passive:!0},window.addEventListener("click",this.toggleSubMenusClose,e),window.frames[0].window.addEventListener("click",this.toggleSubMenusClose,e)},toggleSubMenusClose:function(e){var t,i=jQuery(e.target),n=jQuery(".fusion-builder-live-toolbar .submenu-trigger-target");if(i.hasClass("trigger-submenu-toggling")||i.closest(".trigger-submenu-toggling").length){if(i.hasClass("submenu-trigger-target")||(i=i.parent().find(".submenu-trigger-target")),!(t=i.parent().find(".submenu-trigger-target")).length)return;_.each(n,function(e){t[0].offsetParent!==e.offsetParent&&jQuery(e).attr("aria-expanded",!1)})}else n.attr("aria-expanded",!1),_.each(jQuery(".fusion-builder-live-toolbar .trigger-submenu-toggling.active"),function(e){jQuery(e).removeClass("active")})},openKeyBoardShortCuts:function(e){void 0!==e&&(e.preventDefault(),e.stopPropagation()),jQuery(".fusion-builder-dialog").length&&jQuery(".fusion-builder-dialog").is(":visible")?FusionApp.multipleDialogsNotice():(new FusionPageBuilder.keyBoardShorCutsView).render()},setWarningColor:function(){this.$el.find(".fusion-builder-save-page").addClass("failed")},removeWarningColor:function(){this.$el.find(".fusion-builder-save-page").removeClass("failed")},savePage:function(e){e&&e.preventDefault(),"true"!==jQuery(e.target).data("disabled")&&!0!==jQuery(e.target).data("disabled")&&FusionApp.savePostContent()},updatePostStatus:function(){var e=this.$el.find(".save-wrapper .post-status input:checked").length?this.$el.find(".save-wrapper .post-status input:checked").val():FusionApp.getPost("post_status");FusionApp.setPost("post_status",e),FusionApp.contentChange("page","page-setting")}})});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Dialog=Backbone.Model.extend({initialize:function(){var e=this;this.dialogWidth=.85*jQuery(window).width(),this.dialogHeight=.9*jQuery(window).height(),this.setDialogData(),jQuery(window).resize(function(){e.resizeDialog()}),this.extendDialog()},extendDialog:function(){jQuery.widget("ui.dialog",jQuery.extend({},jQuery.ui.dialog.prototype,{_title:function(e){var t=this.element.find(".fusion-builder-modal-top-container"),i=e.closest(".ui-dialog-titlebar");i.after(t),i.parent(".fusion-builder-child-element").length?i.find(".ui-dialog-title").before('<span class="ui-dialog-close fusion-back-menu-item"><svg version="1.1" width="18" height="18" viewBox="0 0 32 32"><path d="M12.586 27.414l-10-10c-0.781-0.781-0.781-2.047 0-2.828l10-10c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-6.586 6.586h19.172c1.105 0 2 0.895 2 2s-0.895 2-2 2h-19.172l6.586 6.586c0.39 0.39 0.586 0.902 0.586 1.414s-0.195 1.024-0.586 1.414c-0.781 0.781-2.047 0.781-2.828 0z"></path></svg></span>'):void 0!==this.options.type&&i.find(".ui-dialog-titlebar-close").before('<div class="fusion-utility-menu-wrap"><span class="fusion-utility-menu fusiona-ellipsis"></span></div>'),this.options.title?e.html(this.options.title):e.html("&#160;")},_hide:function(e){jQuery("#fb-preview")[0].contentWindow.jQuery("body").removeClass("fusion-dialog-ui-active"),this._trigger("close",e)}}))},resizeDialog:function(){this.dialogWidth=.85*jQuery(window).width(),this.dialogHeight=.9*(jQuery(window).height()-54)-jQuery(".fusion-builder-large-library-dialog .ui-dialog-titlebar").height(),jQuery(".fusion_builder_modal_settings:ui-dialog, #fusion-builder-front-end-library:ui-dialog, .fusion-builder-keyboard-shortcuts-dialog .ui-dialog-content:ui-dialog, .fusion-builder-preferences-dialog .ui-dialog-content:ui-dialog").dialog("option","width",this.dialogWidth),jQuery(".fusion_builder_modal_settings:ui-dialog, #fusion-builder-front-end-library:ui-dialog, .fusion-builder-keyboard-shortcuts-dialog .ui-dialog-content:ui-dialog, .fusion-builder-preferences-dialog .ui-dialog-content:ui-dialog").dialog("option","height",this.dialogHeight)},setDialogData:function(){"undefined"!=typeof Storage&&"undefined"!==localStorage.getItem("dialogData")&&localStorage.getItem("dialogData")?(this.dialogData=JSON.parse(localStorage.getItem("dialogData")),this.dialogData.of=window,this.dialogData.width=this.dialogData.width>jQuery(window).width()?jQuery(window).width():this.dialogData.width,this.dialogData.height=this.dialogData.height>jQuery(window).height()?jQuery(window).height():this.dialogData.height):this.dialogData={width:450,height:400,position:{my:"right bottom",at:"right-50 bottom-100",of:window}}},saveDialogPosition:function(e){this.dialogData.position={my:"left top",at:"left+"+e.left+" top+"+e.top},this.storeDialogData()},saveDialogSize:function(e){this.dialogData.width=e.width,this.dialogData.height=e.height,this.storeDialogData()},maybeRepositionDialog:function(e){return jQuery(window).width()<e.offset().left+e.width()&&(jQuery(e).position({my:"center",at:"center",of:window}),!0)},storeDialogData:function(){var e=jQuery.extend(!0,{},this.dialogData);delete e.of,delete e.position.of,"undefined"!=typeof Storage&&localStorage.setItem("dialogData",JSON.stringify(e))},dialogTabs:function(e){e.find(".fusion-tabs-menu a").on("click",function(t){var i=jQuery(this).attr("href")+".fusion-tab-content";jQuery(this).parent("li").siblings().removeClass("current"),jQuery(this).parent("li").addClass("current"),t.preventDefault(),e.find(".fusion-tab-content").hide().removeClass("active"),e.find(i).show().addClass("active"),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50),FusionEvents.trigger("fusion-tab-changed"),0<e.closest(".fusion-sidebar-section").length?jQuery(i).closest(".fusion-tabs").scrollTop(0):e.closest(".ui-dialog-content").scrollTop(0)}),e.find(".fusion-tabs-menu > li:first-child a").trigger("click")},addResizingClasses:function(){jQuery("body").addClass("fusion-preview-block fusion-dialog-resizing")},removeResizingClasses:function(){jQuery("body").removeClass("fusion-preview-block fusion-dialog-resizing")},addResizingHoverEvent:function(){jQuery(".ui-dialog .ui-resizable-handle").hover(function(){jQuery("body").addClass("fusion-preview-block")},function(){jQuery("body").hasClass("fusion-dialog-resizing")||jQuery("body").removeClass("fusion-preview-block")})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Validate=Backbone.Model.extend({cssValue:function(e,t){var i,n,o,s=!0,a=this;return"0"===e||""===e||0<=e.indexOf("calc(")&&0<=e.indexOf(")")||(0<=e.indexOf(" ")?(o=e.split(" "),_.each(o,function(e){a.cssValue(e,!1)||(s=!1)}),s):(i=parseFloat(e),n=e.replace(i,""),!(!0!==t||""!==n&&n)||!(isNaN(i)||0>_.indexOf(["rem","em","ex","%","px","cm","mm","in","pt","pc","ch","vh","vw","vmin","vmax"],n))))},validateColor:function(e,t){return""===e||!!_.isString(e)&&("hex"===t?this.colorHEX(e):"rgba"===t?this.colorRGBA(e):-1!==e.indexOf("rgba")?this.colorRGBA(e):this.colorHEX(e))},colorHEX:function(e){var t;return""===e||-1!==e.indexOf("#")&&(t=e.replace("#",""),!isNaN(parseInt(t,16)))},colorRGBA:function(e){var t,i=!0;return""===e||-1!==e.indexOf("rgba(")&&-1!==e.indexOf(")")&&4===(t=e.replace("rgba(","").replace(")","").split(",")).length&&(_.each(t,function(e){var t=parseFloat(e,10);return isNaN(t)?(i=!1,!1):0>t||255<t?(i=!1,!1):void 0}),i)},message:function(e,t,i,n){var o=jQuery('.fusion-builder-option[data-option-id="'+t+'"]'),s="fusion-builder-validation";o.length&&("add"===e?(o.find("."+s).length||(o.find(".option-details").append('<div class="fusion-builder-validation error"></div>'),jQuery(i).addClass("error")),o.find("."+s).html(n)):"remove"===e&&(o.find("."+s).remove(),jQuery(i).removeClass("error")))}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Callback=Backbone.Model.extend({});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Dependencies=Backbone.Model.extend({initialize:function(e,t,i,n,o){var s,a=this;switch(this.$targetEl=void 0!==i?i:t.$el,this.repeaterFields=void 0!==n&&n,this.$parentEl=void 0!==o?o:this.$targetEl,this.type=t.type,this.type){case"TO":a.dependencyKey="required",a.settingKey="setting",a.operatorKey="operator",s=t.options;break;case"PO":a.dependencyKey="dependency",a.settingKey="field",a.operatorKey="comparison",s=t.options;break;case"EO":a.dependencyKey="dependency",a.settingKey="element",a.operatorKey="operator",s=e}a.repeaterFields?a.currentOptions=n:a.currentOptions=s,a.parentValues=void 0!==t.parentValues&&t.parentValues,a.collectDependencies(),a.collectDependencyIds(),void 0!==a.dependencyIds&&a.dependencyIds.length&&(this.$targetEl.on("change paste keyup fusion-change",a.dependencyIds.substring(2),function(){a.processDependencies(jQuery(this).attr("id"),t)}),"object"==typeof a.dependencies&&_.each(_.keys(a.dependencies),function(e){FusionEvents.on("fusion-param-default-update-"+e,function(){a.processDependencies(e,t)})})),void 0!==a.parentDependencyIds&&a.parentDependencyIds.length&&this.$parentEl.on("change paste keyup fusion-change",a.parentDependencyIds.substring(2),function(){a.processDependencies(jQuery(this).attr("id"),t,!0)}),a.dependenciesInitialCheck(t),"PO"===t.type?a.processPoDefaults(t):"EO"===t.type&&"undefined"!=typeof avadaPanelIFrame&&a.processEoDefaults(t)},dependenciesInitialCheck:function(e){var t=this;jQuery.each(_.keys(t.dependencies),function(i,n){void 0===t.currentOptions[n]&&t.processDependencies(n,e)}),jQuery.each(t.currentOptions,function(i){t.processDependencies(i,e)})},buildPassedArray:function(e,t){var i,n=this,o=[];return jQuery.each(e,function(e,s){var a=s[n.settingKey],r=s[n.operatorKey],l=s.value,u=-1!==a.indexOf("parent_"),d=n.repeaterFields&&u?n.$parentEl.find("#"+a.replace("parent_","")).val():n.$targetEl.find("#"+a).val(),c=n.repeaterFields&&u?n.$parentEl.find(".fusion-builder-module-settings").data("element"):n.$targetEl.find(".fusion-builder-module-settings").data("element"),p=!1;void 0===d&&("TO"===n.type?d=FusionApp.settings[a]:"PO"===n.type&&(void 0!==FusionApp.data.postMeta[a]&&(d=FusionApp.data.postMeta[a]),void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion[a]&&(d=FusionApp.data.postMeta._fusion[a]))),""!==d||u||"true"!==n.$targetEl.find("#"+a).closest(".fusion-builder-option").attr("data-dynamic")||(d="using-dynamic-value"),void 0!==d&&""!==d||"EO"!==n.type||void 0===fusionAllElements[c]||void 0===fusionAllElements[c].defaults||void 0===fusionAllElements[c].defaults[a]||(d=fusionAllElements[c].defaults[a]),void 0!==d?"TO"===n.type||"FBE"===n.type?(p=n.doesTestPass(d,l,r),!1===t&&n.$targetEl.find("[data-option-id="+a+"]").is(":hidden")&&!n.$targetEl.find("[data-option-id="+a+"]").closest(".repeater-fields").length&&(p=!1),o.push(Number(p))):(""!==d&&"default"!==d||void 0!==FusionApp.settingsPoTo[a]&&(i=FusionApp.settingsPoTo[a],d=FusionApp.settings[i],d=n.fixPoToValue(d)),o.push(n.doesTestPass(d,l,r))):(n.parentValues&&"parent_"===a.substring(0,7)&&(d="object"==typeof n.parentValues&&n.parentValues[a.replace(s.element.substring(0,7),"")]?n.parentValues[a.replace(s.element.substring(0,7),"")]:""),o.push(n.doesTestPass(d,l,r)))}),o},collectDependencies:function(){var e,t,i,n=this,o=[];jQuery.each(n.currentOptions,function(s,a){e=a[n.dependencyKey],_.isUndefined(e)||(t=s,jQuery.each(e,function(e,s){i=s[n.settingKey],_.isUndefined(o[i])?o[i]=[{option:t,or:a.or}]:o[i].push({option:t,or:a.or})}))}),n.dependencies=o},collectDependencyIds:function(){var e,t,i=this,n="",o="";jQuery.each(i.currentOptions,function(s,a){e=a[i.dependencyKey],_.isUndefined(e)||jQuery.each(e,function(e,s){"parent_"===(t=s[i.settingKey]).substring(0,7)&&0>o.indexOf("#"+t.replace("parent_",""))?o+=", #"+t.replace("parent_",""):0>n.indexOf("#"+t)&&(n+=", #"+t)})}),i.dependencyIds=n,""!==o&&i.repeaterFields&&(i.parentDependencyIds=o)},hideShowOption:function(e,t){e?this.$targetEl.find('[data-option-id="'+t+'"]').fadeIn(300):this.$targetEl.find('[data-option-id="'+t+'"]').hide()},toGutterCheck:function(e){var t,i,n=!1;return(t=!_.isUndefined(e.class)&&"fusion-or-gutter"===e.class&&e.class)||(i=!_.isUndefined(e.class)&&"fusion-or-gutter"!==e.class&&e.class.replace("fusion-gutter-","").split("-")),(t||i)&&(n=!0),{single:t,sequence:i,check:n}},processDependencies:function(e,t,i){var n,o,s,a,r,l,u=this,d={},c={},p=!1;"function"==typeof t.beforeProcessDependencies&&t.beforeProcessDependencies(),void 0!==i&&i&&(e="parent_"+e),jQuery.each(u.dependencies[e],function(e,t){p=!1,n=t.option,s=u.currentOptions[n][u.dependencyKey],o=[],d={},"TO"===u.type||"FBE"===u.type?(d=u.toGutterCheck(u.currentOptions[n]),o=u.buildPassedArray(s,d.check),p=d.sequence||d.single?u.checkGutterOptionVisibility(d.sequence,o,d.single):u.checkTOVisibility(o),u.hideShowOption(p,n,u.$targetEl),jQuery.each(u.dependencies[n],function(e,t){a=t.option,r=u.currentOptions[a][u.dependencyKey],p=!1,c={},l=[],c=u.toGutterCheck(u.currentOptions[a]),l=u.buildPassedArray(r,c.check),p=c.sequence||c.single?u.checkGutterOptionVisibility(c.sequence,l,c.single):u.checkTOVisibility(l),u.hideShowOption(p,a)})):"PO"!==u.type&&"EO"!==u.type||(o=u.buildPassedArray(s,d.check),p=u.checkOptionVisibility(o,t),u.hideShowOption(p,n))})},doesTestPass:function(e,t,i){var n,o,s=!1;switch(i){case"=":case"==":case"equals":jQuery.isArray(e)?jQuery(e[0]).each(function(e,i){if(jQuery.isArray(t))jQuery(t).each(function(e,t){if(i==t)return s=!0,!0});else if(i==t)return s=!0,!0}):jQuery.isArray(t)?jQuery(t).each(function(t,i){e==i&&(s=!0)}):e==t&&(s=!0);break;case"!=":case"not":jQuery.isArray(e)?jQuery(e).each(function(e,i){if(jQuery.isArray(t))jQuery(t).each(function(e,t){if(i!=t)return s=!0,!0});else if(i!=t)return s=!0,!0}):jQuery.isArray(t)?jQuery(t).each(function(t,i){e!=i&&(s=!0)}):e!=t&&(s=!0);break;case">":case"greater":case"is_larger":parseFloat(e)>parseFloat(t)&&(s=!0);break;case">=":case"greater_equal":case"is_larger_equal":parseFloat(e)>=parseFloat(t)&&(s=!0);break;case"<":case"less":case"is_smaller":parseFloat(e)<parseFloat(t)&&(s=!0);break;case"<=":case"less_equal":case"is_smaller_equal":parseFloat(e)<=parseFloat(t)&&(s=!0);break;case"contains":jQuery.isPlainObject(e)&&(t=Object.keys(t).map(function(e){return[e,t[e]]}),e=n),jQuery.isPlainObject(t)&&(n=Object.keys(t).map(function(e){return t[e]}),t=n),jQuery.isArray(t)?jQuery(t).each(function(t,i){var n=!1,o=i[0],a=i[1];if(jQuery(e).each(function(e,t){var i=t[0],r=t[1];if(o===i&&a==r)return s=!0,n=!0,!1}),!0===n)return!1}):-1!==e.toString().indexOf(t)&&(s=!0);break;case"doesnt_contain":case"not_contain":jQuery.isPlainObject(e)&&(n=Object.keys(e).map(function(t){return e[t]}),e=n),jQuery.isPlainObject(t)&&(n=Object.keys(t).map(function(e){return t[e]}),t=n),jQuery.isArray(t)?jQuery(t).each(function(t,i){-1===e.toString().indexOf(i)&&(s=!0)}):-1===e.toString().indexOf(t)&&(s=!0);break;case"is_empty_or":""!==e&&e!=t||(s=!0);break;case"not_empty_and":""!==e&&e!=t&&(s=!0);break;case"is_empty":case"empty":case"!isset":e&&""!==e&&null!==e||(s=!0);break;case"not_empty":case"!empty":case"isset":e&&""!==e&&null!==e&&(s=!0);break;case"is_media":e&&(o="string"==typeof e?JSON.parse(e):e)&&o.url&&(s=!0)}return s},checkOptionVisibility:function(e,t){var i=!1;return-1===jQuery.inArray(!1,e)&&_.isUndefined(t.or)?i=!0:-1===jQuery.inArray(!0,e)||_.isUndefined(t.or)||(i=!0),i},checkTOVisibility:function(e){var t=!1;return-1===jQuery.inArray(0,e)&&(t=!0),t},checkGutterOptionVisibility:function(e,t,i){var n,o=[],s=0,a=!1;if(i)o=t;else if(0<e.length)for(n=0;n<t.length;n++)0===n?o.push(t[n]):"and"===e[n-1]?o[o.length-1]=o[o.length-1]*t[n]:o.push(t[n]);for(n=0;n<o.length;n++)s+=o[n];return a=1<=s,a=Boolean(a)},fixPoToValue:function(e){switch(e){case"hide":case"0":e="no";break;case"show":case"1":e="yes"}return e},processEoDefaults:function(e){var t,i=e.model.get("element_type"),n=FusionApp.elementDefaults[i];"object"==typeof n&&"object"==typeof n.settings_to_params&&_.each(n.settings_to_params,function(i,n){var o,s="";t=FusionApp.settings[n],-1!==n.indexOf("[")&&(n=n.split("[")[0],t=FusionApp.settings[n]),"object"==typeof i&&(i=i.param),(o=e.$el.find("#"+i).closest(".fusion-builder-option")).length&&(s=jQuery(o).attr("class").split(" ").pop()),jQuery(o).hasClass("fusion-builder-option range")||(t=FusionApp.sidebarView.fixToValueName(n,t,s),e.$el.find('.description [data-fusion-option="'+n+'"]').html(t))})},processPoDefaults:function(e){var t,i,n,o=e.$el,s="";_.each(FusionApp.settingsPoTo,function(e,a){t=FusionApp.settings[e],_.isUndefined(t)||(n=o.find('[data-option-id="'+a+'"]'),i=n.val(),n.length&&(s=jQuery(n).attr("class").split(" ").pop()),"default"!==i&&(t=FusionApp.sidebarView.fixToValueName(e,t,s),n.find(".description a").html(t)))})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Assets=Backbone.Model.extend({initialize:function(){this.webfonts,this.webfontsArray,this.webfontsGoogleArray,this.webfontsStandardArray,this.webfontRequest=!1},getWebFonts:function(){var e=this;if(!e.webfonts||!e.webfontsArray)return"undefined"!=typeof fusionAppConfig&&"object"==typeof fusionAppConfig.fusion_web_fonts?(e.webfonts=fusionAppConfig.fusion_web_fonts,void e.setFontArrays()):!1!==e.webfontRequest?e.webfontRequest:e.webfontRequest=jQuery.post(ajaxurl,{action:"fusion_get_webfonts_ajax"},function(t){e.webfonts=JSON.parse(t),e.setFontArrays()})},setFontArrays:function(){var e=this;e.webfontsArray=[],_.each(e.webfonts.google,function(t){e.webfontsArray.push(t.family)}),e.webfontsGoogleArray=e.webfontsArray,e.webfontsStandardArray=[],_.each(e.webfonts.standard,function(t){e.webfontsArray.push(t.family),e.webfontsStandardArray.push(t.family)})}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{elementCount:0,views:{}},getViews:function(){return this.get("views")},getView:function(e){return this.get("views")[e]},getChildViews:function(e){var t=this.get("views"),i={};return _.each(t,function(t,n){e===t.model.attributes.parent&&(i[n]=t)}),i},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,t){var i=this.get("views");i[e]=t,this.set({views:i})},removeView:function(e){var t=this.get("views"),i={};_.each(t,function(t,n){n!=e&&(i[n]=t)}),this.set({views:i})},removeViews:function(){this.set({views:{}})},countElementsByType:function(e){var t=this.get("views"),i=0;return _.each(t,function(t){t.model.attributes.type===e&&i++}),i},clear:function(){var e=this.get("views");_.each(e,function(e){e.unbind(),e.remove(),delete e.$el,delete e.el}),this.set("elementCount",0),this.set("views",{})}}),(FusionPageBuilder=FusionPageBuilder||{}).fusionActiveStates={previewToggle:function(e,t){var i,n,o,s,a,r,l=this,u=!0;i=(t=void 0===t?jQuery(e.currentTarget):t).data("type"),n=t.data("selector"),o=void 0!==t.data("toggle")?t.data("toggle"):"",s=void 0!==t.data("append")&&t.data("append"),a=-1!==n.indexOf("$el")?300:0,r={type:i,selector:n,toggle:o,append:s},e&&e.preventDefault(),"animation"===i&&"fusion_content_boxes"!==this.model.get("element_type")&&(u=!1),t.hasClass("active")?(void 0!==this.activeStates[n+"-"+i+"-"+o]&&(this.activeStates[n+"-"+i+"-"+o]=!1),setTimeout(function(){l.triggerRemoveState(r)},a)):(u&&(this.activeStates[n+"-"+i+"-"+o]=r),setTimeout(function(){l.triggerActiveState(r)},a)),u&&this.$el.find('[data-type="'+i+'"][data-selector="'+n+'"][data-toggle="'+o+'"]').toggleClass("active")},triggerActiveState:function(e){var t,i,n,o=this,s=this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live");if("string"==typeof e.selector&&-1!==e.selector.indexOf("$el")?i=s:s.hasClass("fusion-builder-column")?i=s.find(e.selector):s.hasClass("fusion-builder-live-element")?i=s.find(".fusion-builder-element-content "+e.selector):s.hasClass("fusion-builder-live-child-element")&&(i=s.find(".fusion-builder-child-element-content "+e.selector)),i.length){if("animation"===e.type)return"fusion_content_boxes"===this.model.get("element_type")?void this.contentBoxAnimations(e):void i.each(function(){var t=jQuery(this);e.toggle=t.attr("data-animationtype"),n=t.attr("data-animationduration"),t.css("-moz-animation-duration",n+"s"),t.css("-webkit-animation-duration",n+"s"),t.css("-ms-animation-duration",n+"s"),t.css("-o-animation-duration",n+"s"),t.css("animation-duration",n+"s"),t.removeClass(_.fusionGetAnimationTypes().join(" ")),setTimeout(function(){t.addClass(e.toggle)},50)});e.append?(t=e.selector.split(","),_.each(t,function(t){(i=s.find(t)).length&&i.addClass(t.replace(".","")+e.toggle)})):i.addClass(e.toggle),i.one("mouseleave",function(){o.$el.find('[data-type="'+e.type+'"][data-selector="'+e.selector+'"][data-toggle="'+e.toggle+'"]').removeClass("active"),o.activeStates[e.selector+"-"+e.type+"-"+e.toggle]=!1,o.triggerRemoveState(e)})}},triggerRemoveState:function(e){var t,i,n=this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live");"string"==typeof e.selector&&-1!==e.selector.indexOf("$el")?i=n:n.hasClass("fusion-builder-column")?i=n.find(e.selector):n.hasClass("fusion-builder-live-element")?i=n.find(".fusion-builder-element-content "+e.selector):n.hasClass("fusion-builder-live-child-element")&&(i=n.find(".fusion-builder-child-element-content "+e.selector)),i.length&&("animation"!==e.type?e.append?(t=e.selector.split(","),_.each(t,function(t){i.removeClass(t.replace(".","")+e.toggle)})):i.removeClass(e.toggle):i.each(function(){var t=jQuery(this);e.toggle=t.attr("data-animationtype"),t.removeClass(e.toggle)}))},triggerTemporaryState:function(e){e.find(".option-preview-toggle").length&&!e.find(".option-preview-toggle").hasClass("active")&&(this.previewToggle(!1,e.find(".option-preview-toggle")),this._tempStateRemove(e))},tempStateRemove:function(e){e.find(".option-preview-toggle").length&&e.find(".option-preview-toggle").hasClass("active")&&this.previewToggle(!1,e.find(".option-preview-toggle"))},triggerActiveStates:function(){var e=this;_.each(this.activeStates,function(t){e.triggerActiveState(t)})},removeActiveStates:function(){var e=this;_.each(this.activeStates,function(t){e.triggerRemoveState(t)})},contentBoxAnimations:function(){var e=0;(this.$targetEl&&this.$targetEl.length?this.$targetEl:jQuery("#fb-preview").contents().find(".fusion-builder-live")).find(".content-box-column").each(function(){var t,i,n=jQuery(this),o=n.find(".fusion-animated");setTimeout(function(){o.css("visibility","visible"),t=o.data("animationtype"),i=o.data("animationduration"),o.addClass(t),i&&(o.css("-moz-animation-duration",i+"s"),o.css("-webkit-animation-duration",i+"s"),o.css("-ms-animation-duration",i+"s"),o.css("-o-animation-duration",i+"s"),o.css("animation-duration",i+"s")),(n.closest(".fusion-content-boxes").hasClass("content-boxes-timeline-horizontal")||n.closest(".fusion-content-boxes").hasClass("content-boxes-timeline-vertical"))&&n.addClass("fusion-appear"),setTimeout(function(){o.removeClass(t)},1e3*i)},e),e+=parseInt(jQuery(this).closest(".fusion-content-boxes").attr("data-animation-delay"),10)})}};FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Hotkeys=Backbone.Model.extend({initialize:function(){var e=this;jQuery("body").on("keydown",function(t){e.isValidTarget(t)&&e.checkKey(t)})},attachListener:function(){var e=this;jQuery(document.getElementById("fb-preview").contentWindow.document).off("keydown"),jQuery(document.getElementById("fb-preview").contentWindow.document).on("keydown",function(t){e.isValidTarget(t)&&e.checkKey(t)})},checkKey:function(e){if((void 0===FusionApp||void 0===FusionApp.preferencesData||"off"!==FusionApp.preferencesData.keyboard_shortcuts)&&(e.ctrlKey||e.metaKey||e.shiftKey)){if(this.isShiftKey(e)&&!this.isMetaKey(e))switch(e.keyCode){case 80:e.preventDefault(),jQuery(".fusion-toolbar-nav li.preview a").trigger("click");break;case 84:void 0!==FusionApp.sidebarView&&(e.preventDefault(),FusionApp.sidebarView.togglePanel());break;case 87:e.preventDefault(),jQuery(".fusion-builder-wireframe-toggle").trigger("click")}if(this.isMetaKey(e)&&!this.isShiftKey(e))switch(e.keyCode){case 13:0<jQuery(".fusion-builder-dialog .ui-dialog-buttonset .ui-button").length?jQuery(".fusion-builder-dialog .ui-dialog-buttonset .ui-button").trigger("click"):jQuery(".fusion-builder-dialog .ui-button.ui-dialog-titlebar-close").trigger("click");break;case 49:e.preventDefault(),jQuery(".fusion-builder-preview-desktop").trigger("click");break;case 50:e.preventDefault(),jQuery(".fusion-builder-preview-mobile.portrait").trigger("click");break;case 51:e.preventDefault(),jQuery(".fusion-builder-preview-mobile.landscape").trigger("click");break;case 52:e.preventDefault(),jQuery(".fusion-builder-preview-tablet.portrait").trigger("click");break;case 53:e.preventDefault(),jQuery(".fusion-builder-preview-tablet.landscape").trigger("click");break;case 68:e.preventDefault(),jQuery(".fusion-builder-clear-layout").trigger("click");break;case 81:e.preventDefault(),jQuery(".fusion-exit-builder-list .exit-to-back-end a").trigger("click");break;case 83:e.preventDefault(),jQuery(".fusion-builder-save-page").data("disabled")||jQuery(".fusion-builder-save-page").trigger("click");break;case 89:e.preventDefault(),FusionEvents.trigger("fusion-history-redo");break;case 90:e.preventDefault(),FusionEvents.trigger("fusion-history-undo")}if(this.isMetaKey(e)&&this.isShiftKey(e))switch(e.keyCode){case 67:0===jQuery("body").find(".ui-dialog").length&&void 0!==FusionApp.sidebarView&&(e.preventDefault(),FusionApp.sidebarView.openOption("_fusion_builder_custom_css","po"));break;case 83:e.preventDefault(),0!==jQuery("body").find(".ui-dialog").length||FusionApp.sidebarView.panelIsOpen()||jQuery(".fusion-builder-save-template").trigger("click")}}},isMetaKey:function(e){return!(!e.ctrlKey&&!e.metaKey)},isShiftKey:function(e){return!!e.shiftKey},isValidTarget:function(e){return!(jQuery(e.target).is("input")||jQuery(e.target).is("textarea")||jQuery(e.target).is(".fusion-live-editable"))}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(e){var t,i={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return(t=t||_.template(e,null,i))(n)}});var FusionEvents=_.extend({},Backbone.Events);jQuery,jQuery(document).ready(function(){var e=Backbone.Model.extend({initialize:function(){this.builderId=builderId,this.connected=!0,this.initialData={},this.callback=new FusionPageBuilder.Callback,this.dialog=new FusionPageBuilder.Dialog,this.assets=new FusionPageBuilder.Assets,this.inlineEditor=new FusionPageBuilder.inlineEditor,this.validate=new FusionPageBuilder.Validate,this.hotkeys=new FusionPageBuilder.Hotkeys,this.settings="undefined"!=typeof fusionSettings&&fusionSettings,this.elementDefaults="undefined"!=typeof fusionAllElements?jQuery.extend(!0,{},fusionAllElements):{},this.editedDefaults={},this.editedTo={},this.contentChanged={},this.data={},this.data.postMeta={},this.data.samePage=!0,this.builderActive=!1,this.hasEditableContent=!0,this.customSave={},this.settingsPoTo=!1,this.settingsToPo=!1,this.settingsToParams=!1,this.settingsToExtras=!1,this.storedPoCSS={},this.storedToCSS={},this.toolbarView=new FusionPageBuilder.Toolbar({fusionApp:this}),this.builderToolbarView=!1,this.sidebarView=!1,this.renderUI(),this.scripts={},this.listenTo(FusionEvents,"fusion-preview-update",this.toggleFontAwesomePro),this.listenTo(FusionEvents,"fusion-to-status_fontawesome-changed",this.FontAwesomeSubSets),this.setHeartbeatListeners(),this.correctLayoutTooltipPosition(),this.refreshCounter=0,this.hasChange=!1,this.showLoader(),this.modifierActive=!1,window.onkeydown=this.keyActive.bind(this),window.onkeyup=this.keyInactive.bind(this),document.getElementById("fb-preview").contentWindow.onkeydown=this.keyActive.bind(this),document.getElementById("fb-preview").contentWindow.onkeyup=this.keyInactive.bind(this),this.manualSwitch=!1,this.linkSelectors="td.tribe-events-thismonth a, .tribe-events-month-event-title a,.fusion-menu a, .fusion-secondary-menu a, .fusion-logo-link, .widget a, .woocommerce-tabs a, .fusion-posts-container a:not(.fusion-rollover-gallery), .fusion-rollover .fusion-rollover-link, .project-info-box a, .fusion-meta-info-wrapper a, .related-posts a, .related.products a, .woocommerce-page .products .product a, #tribe-events-content a, .fusion-breadcrumbs a, .single-navigation a, .fusion-column-inner-bg a"},iframeLoaded:function(){this.linkListeners(),FusionEvents.trigger("fusion-iframe-loaded")},keyActive:function(e){(e.ctrlKey||17==e.keyCode||91==e.keyCode||93==e.keyCode)&&(this.modifierActive=!0)},keyInactive:function(e){(e.ctrlKey||17==e.keyCode||91==e.keyCode||93==e.keyCode)&&(this.modifierActive=!1)},hideLoader:function(){jQuery("#fb-preview-loader").removeClass("fusion-loading"),jQuery("#fusion-frontend-builder-toggle-global-panel, #fusion-frontend-builder-toggle-global-page-settings").css("pointer-events","auto")},showLoader:function(){jQuery("body").hasClass("expanded")?jQuery("#fb-preview-loader").css("width","calc(100% - "+jQuery("#customize-controls").width()+"px)"):jQuery("#fb-preview-loader").css("width","100%"),jQuery("#fusion-frontend-builder-toggle-global-panel, #fusion-frontend-builder-toggle-global-page-settings").css("pointer-events","none"),jQuery("#fb-preview-loader").addClass("fusion-loading")},correctLayoutTooltipPosition:function(){jQuery(document).on("mouseenter",".fusion-layout-buttons .fusion-builder-layout-button-load-dialog",function(){var e=jQuery(this).find(".fusion-builder-load-template-dialog-container"),t=e.offset().left+e.outerWidth(),i=jQuery(this).closest(".ui-dialog-content"),n=i.offset().left+i.outerWidth();t>n&&jQuery(this).find(".fusion-builder-load-template-dialog").css("left","-"+(t-n+20)+"px")}),jQuery(document).on("mouseleave",".fusion-layout-buttons .fusion-builder-layout-button-load-dialog",function(){jQuery(this).find(".fusion-builder-load-template-dialog").css("left","")})},setHeartbeatListeners:function(){var e=this;jQuery(document).on("heartbeat-tick",function(t,i){void 0!==i["wp-auth-check"]&&!1===i["wp-auth-check"]&&FusionApp.connected&&(e.connected=!1,FusionEvents.trigger("fusion-disconnected"),window.adminpage="post-php"),void 0!==i.fusion_builder&&(fusionAppConfig.fusion_load_nonce=i.fusion_builder.fusion_load_nonce,e.connected=!0,delete window.adminpage,FusionEvents.trigger("fusion-reconnected"))})},renderUI:function(){void 0!==FusionPageBuilder.SidebarView&&(this.sidebarView=new FusionPageBuilder.SidebarView,jQuery(".fusion-builder-panel-main").append(this.sidebarView.render().el)),this.iconPicker()},setup:function(){this.previewWindow=jQuery("#fb-preview")[0].contentWindow,this.updateData(),jQuery("body").append(this.toolbarView.render().el),void 0!==FusionPageBuilder.AppView&&this.getPost("post_type")&&-1!==builderConfig.allowed_post_types.indexOf(this.getPost("post_type"))?(this.builderActive=!0,"undefined"!==this.data.template_override&&"undefined"!==this.data.template_override.content&&""!==this.data.template_override.content&&!1!==this.data.template_override.content&&-1===this.data.template_override.content.post_content.indexOf("fusion_tb_content")&&(this.hasEditableContent=!1),"undefined"==typeof FusionPageBuilderApp?(window.FusionPageBuilderApp=new FusionPageBuilder.AppView({el:jQuery("#fb-preview").contents().find(".fusion-builder-live")}),void 0!==FusionPageBuilder.BuilderToolbar&&(this.builderToolbarView=new FusionPageBuilder.BuilderToolbar,this.toolbarView.render())):(FusionPageBuilderApp.fusionBuilderReset(),FusionPageBuilderApp.$el=jQuery("#fb-preview").contents().find(".fusion-builder-live"),FusionPageBuilderApp.render()),FusionPageBuilderApp.initialBuilderLayout(this.data),this.listenTo(FusionEvents,"fusion-builder-loaded",this.hideLoader)):(this.builderActive=!1,jQuery(document.getElementById("fb-preview").contentWindow.document).ready(this.hideLoader)),FusionEvents.trigger("fusion-app-setup"),this.listenForLeave(),(this.sidebarView||"undefined"!=typeof FusionPageBuilderApp)&&this.createMapObjects(),jQuery("#fb-preview").removeClass("refreshing"),void 0!==this.hotkeys&&this.hotkeys.attachListener()},linkListeners:function(){var e=this;jQuery("#fb-preview")[0].contentWindow.jQuery("#tribe-events").off(),void 0!==jQuery("#fb-preview")[0].contentWindow.tribe_ev&&jQuery("#fb-preview")[0].contentWindow.jQuery(jQuery("#fb-preview")[0].contentWindow.tribe_ev.events).on("post-collect-bar-params.tribe",function(){var t=jQuery("#fb-preview")[0].contentWindow.tribe_ev.state.cur_url;t=-1!==t.indexOf("?")?t+"&builder=true&builder_id="+e.builderId:t+"?builder=true&builder_id="+e.builderId,jQuery("#fb-preview")[0].contentWindow.tribe_ev.state.cur_url=t,e.showLoader()}),jQuery("#fb-preview").contents().on("click",this.linkSelectors,function(t){t.preventDefault(),e.checkLink(t)})},listenForLeave:function(){document.getElementById("fb-preview").contentWindow.addEventListener("beforeunload",this.leavingAlert.bind(this)),window.addEventListener("beforeunload",this.leavingAlert.bind(this)),this.manualSwitch=!1},leavingAlert:function(e){this.hasContentChanged()&&!this.manualSwitch&&(e.returnValue=fusionBuilderText.changes_will_be_lost)},savePostContent:function(e){var t=this,i=this.getAjaxData("fusion_app_save_post_content"),n=jQuery(".fusion-builder-save-page").outerWidth()+jQuery(".fusion-exit-builder").outerWidth(),o=jQuery(".fusion-builder-save-page");o.toggleClass("sending").blur(),"object"!=typeof e||void 0===e.action||"switch_page"!==e.action&&"exit_builder"!==e.action||(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top","54px"),jQuery("#fusion-builder-confirmation-modal-dark-overlay").before('<div class="fusion-builder-confirmation-modal-save"></div>'),jQuery(".fusion-builder-confirmation-modal-save").attr("style","width:calc(100% - "+n+"px);")),jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,dataType:"json",data:i,success:function(i){"object"==typeof i&&(i.success&&void 0===i.data.failure?(o.removeClass("sending").blur(),o.addClass("success"),"object"==typeof e&&void 0!==e.action&&"switch_page"===e.action?t.switchPage(e.builderid,e.linkhref,e.linkhash):"object"==typeof e&&void 0!==e.action&&"exit_builder"===e.action?(t.manualSwitch=!0,window.location.href=e.link):(setTimeout(function(){o.removeClass("success"),FusionApp.contentReset()},2e3),FusionEvents.trigger("fusion-app-saved"))):void 0===i.data.failure||"logged_in"!==i.data.failure&&"nonce_check"!==i.data.failure?(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top",""),jQuery(".fusion-builder-confirmation-modal-save").remove(),t.hideLoader(),o.removeClass("sending").blur(),o.addClass("failed"),setTimeout(function(){o.removeClass("failed")},2e3),FusionApp.confirmationPopup({title:fusionBuilderText.problem_saving,content:fusionBuilderText.changes_not_saved+t.getSaveMessages(i.data),type:"error",icon:'<i class="fusiona-exclamation-triangle"></i>',actions:[{label:fusionBuilderText.ok,classes:"save yes",callback:function(){"undefined"!=typeof wp&&void 0!==wp.heartbeat&&wp.heartbeat.connectNow(),FusionApp.confirmationPopup({action:"hide"})}}]})):(jQuery("#fusion-builder-confirmation-modal-dark-overlay").css("top",""),jQuery(".fusion-builder-confirmation-modal-save").remove(),t.hideLoader(),o.removeClass("sending").blur(),o.addClass("failed"),"undefined"!=typeof wp&&void 0!==wp.heartbeat?(FusionApp.confirmationPopup({action:"hide"}),wp.heartbeat.connectNow()):FusionApp.confirmationPopup({title:fusionBuilderText.page_save_failed,content:fusionBuilderText.authentication_no_heartbeat,type:"error",icon:'<i class="fusiona-exclamation-triangle"></i>',actions:[{label:fusionBuilderText.ok,classes:"save yes",callback:function(){"undefined"!=typeof wp&&void 0!==wp.heartbeat&&wp.heartbeat.connectNow(),FusionApp.confirmationPopup({action:"hide"})}}]})))}})},getSaveMessages:function(e){var t="";return"object"==typeof e.failure&&_.each(e.failure,function(e){"string"==typeof e?t+='<li class="failure"><i class="fusiona-exclamation-triangle"></i>'+e+"</li>":"object"==typeof e&&_.each(e,function(e){"string"==typeof e&&(t+='<li class="failure"><i class="fusiona-exclamation-triangle"></i>'+e+"</li>")})}),"object"==typeof e.success&&_.each(e.success,function(e){"string"==typeof e?t+='<li class="success"><i class="fusiona-check"></i>'+e+"</li>":"object"==typeof e&&_.each(e,function(e){"string"==typeof e&&(t+='<li class="success"><i class="fusiona-check"></i>'+e+"</li>")})}),""!==t?'<ul class="fusion-save-data-list">'+t+"</ul>":""},createMapObjects:function(){this.settingsToParams||"undefined"==typeof FusionPageBuilderApp||this.createSettingsToParams(),this.settingsToExtras||"undefined"==typeof FusionPageBuilderApp||this.createSettingsToExtras(),this.settingsToPo||this.createSettingsToPo()},createSettingsToParams:function(){var e,t={};_.each(fusionAllElements,function(i,n){_.isUndefined(i.settings_to_params)||_.each(i.settings_to_params,function(i,o){e={param:_.isObject(i)&&!_.isUndefined(i.param)?i.param:i,callback:i.callback||!1,element:n},_.isObject(t[o])?t[o].push(e):(t[o]=[],t[o].push(e))})}),this.settingsToParams=t},createSettingsToExtras:function(){var e,t={};_.each(fusionAllElements,function(i,n){_.isUndefined(i.settings_to_extras)||_.each(i.settings_to_extras,function(i,o){e={param:_.isObject(i)&&!_.isUndefined(i.param)?i.param:i,callback:i.callback||!1,element:n},_.isObject(t[o])?t[o].push(e):(t[o]=[],t[o].push(e))})}),this.settingsToExtras=t},createSettingsToPo:function(){var e,t={},i={};_.each(this.data.fusionPageOptions,function(n,o){_.each(n.fields,function(n,s){_.isUndefined(n.to_default)||(e={to:_.isObject(n.to_default)&&!_.isUndefined(n.to_default.id)?n.to_default.id:n.to_default,callback:n.to_default.callback||!1,option:s,tab:o},_.isObject(t[e.to])?t[e.to].push(e):(t[e.to]=[],t[e.to].push(e)),_.isObject(i[s])?i[s]=e.to:(i[s]=[],i[s]=e.to))})}),this.settingsToPo=t,this.settingsPoTo=i},updateData:function(){void 0!==this.data.language&&void 0!==this.initialData.languageTo&&this.initialData.language!==this.data.language&&void 0!==FusionApp.sidebarView&&this.languageSwitch(),this.getPost("post_id")===this.initialData.postDetails.post_id?this.data.samePage=!0:(this.updateURL(this.initialData.postDetails.post_permalink),this.data=this.initialData,this.data.samePage=!1,this.contentReset("page"),this.storedPoCSS=!1,this.customSave={},FusionEvents.trigger("fusion-history-clear"),!1!==this.toolbarView&&this.data.language&&this.toolbarView.updateLanguageSwitcher(),FusionEvents.trigger("fusion-data-updated"))},getPost:function(e){return"object"==typeof this.data.postDetails&&(void 0===e?jQuery.extend(!0,{},this.data.postDetails):void 0!==this.data.postDetails[e]&&this.data.postDetails[e])},getDynamicPost:function(e){return"post_meta"===e?"object"!=typeof this.data.examplePostDetails?FusionApp.data.postMeta:this.data.examplePostDetails.post_meta:"fusion_tb_section"===FusionApp.data.postDetails.post_type&&void 0!==FusionApp.data.postMeta._fusion&&void 0!==FusionApp.data.postMeta._fusion.dynamic_content_preview_type&&void 0!==FusionApp.initialData.dynamicPostID?FusionApp.initialData.dynamicPostID:"object"!=typeof this.data.examplePostDetails?this.getPost(e):void 0===e?jQuery.extend(!0,{},this.data.examplePostDetails):void 0===this.data.examplePostDetails[e]?this.getPost(e):this.data.examplePostDetails[e]},setPost:function(e,t){"object"!=typeof this.data.postDetails&&(this.data.postDetails={}),this.data.postDetails[e]=t},getPreviewUrl:function(){return FusionApp.previewWindow.location.href.replace("builder=true","builder=false&fbpreview=true")},languageSwitch:function(){this.editedDefaults[this.data.language]=jQuery.extend(!0,{},fusionAllElements),this.editedTo[this.data.language]=jQuery.extend(!0,{},FusionApp.settings),void 0!==this.editedTo[this.initialData.language]?FusionApp.settings=this.editedTo[this.initialData.language]:FusionApp.settings=this.initialData.languageTo,window.fusionOptionName=this.initialData.optionName,void 0!==this.editedDefaults[this.initialData.language]?window.fusionAllElements=jQuery.extend(!0,{},this.editedDefaults[this.initialData.language]):void 0!==this.initialData.languageDefaults?window.fusionAllElements=jQuery.extend(!0,fusionAllElements,this.initialData.languageDefaults):window.fusionAllElements=jQuery.extend(!0,{},this.elementDefaults),FusionApp.sidebarView.refreshTo()},fullRefresh:function(e,t,i){this.showLoader(),e=void 0!==e&&e,t=void 0===t?{}:t,this.setGoogleFonts(),this.reInitIconPicker(),this.doTheFullRefresh(e,t,i)},setBuilderStatus:function(){var e=!1,t=void 0!==this.data.postMeta.fusion_builder_status&&this.data.postMeta.fusion_builder_status;"undefined"!=typeof FusionPageBuilderApp&&(e="active"),e!==t&&(this.data.postMeta.fusion_builder_status=e,this.contentChange("page","page-option"))},getAjaxData:function(e,t){var i={post_id:this.getPost("post_id"),fusion_load_nonce:fusionAppConfig.fusion_load_nonce,custom:jQuery.param(this.customSave),builder_id:this.builderId};return"fusion_app_full_refresh"!==e&&"fusion_app_preview_only"!==e&&(i.query=FusionApp.data.query),void 0===t&&(t={}),"string"==typeof e&&(i.action=e),this.hasContentChanged("page","page-setting")&&(i.post_details=this.getPost(),void 0!==i.post_details.post_content&&delete i.post_details.post_content),"undefined"!=typeof FusionPageBuilderApp&&this.hasContentChanged("page","builder-content")&&(void 0!==t.post_content?i.post_content=t.post_content:(FusionPageBuilderApp.builderToShortcodes(),i.post_content=this.getPost("post_content")),this.setGoogleFonts()),this.setBuilderStatus(),this.sidebarView&&(this.hasContentChanged("global","theme-option")||this.hasContentChanged("page","page-option"))&&(this.reInitIconPicker(),this.hasContentChanged("global","theme-option")&&(i.fusion_options=jQuery.param(FusionApp.settings)),this.hasContentChanged("page","page-option")&&(i.meta_values=jQuery.param(this.data.postMeta))),"object"==typeof i.post_details&&(i.post_details=jQuery.param(i.post_details)),"undefined"!=typeof fusionOptionName&&(i.option_name=fusionOptionName),"object"==typeof FusionApp.data.examplePostDetails&&void 0!==FusionApp.data.examplePostDetails.post_id&&(i.target_post=FusionApp.data.examplePostDetails.post_id),i},doTheFullRefresh:function(e,t,i){var n=this.getAjaxData("fusion_app_full_refresh",i);this.refreshCounter=this.refreshCounter+1,jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fb-preview").addClass("refreshing"),FusionEvents.trigger("fusion-preview-refreshed"),this.formPost(n)},formPost:function(e,t,i){var n=jQuery("#refresh-form"),o=void 0!==t&&t?t:jQuery("#fb-preview").attr("src");n.empty(),"string"!=typeof i&&(i=jQuery("#fb-preview").attr("name"),this.previewWindow.name=i),n.attr("target",i),n.attr("action",o),_.each(e,function(e,t){"post_content"===t&&(e=window.encodeURIComponent(e)),n.append('<input type="hidden" name="'+t+'" value="'+e+'" />')}),this.manualSwitch=!0,n.submit().empty()},previewRefresh:function(){var e=this,t="&refresh="+(e.refreshCounter-1);this.manualSwitch=!0,jQuery("#fb-preview").attr("src",function(i,n){return-1===n.indexOf("&post_id=")&&(n+="&post_id="+e.getPost("post_id")),-1===n.indexOf(t)?n+="&refresh="+e.refreshCounter:n=n.replace(t,"&refresh="+e.refreshCounter),n}),FusionEvents.trigger("fusion-preview-refreshed")},checkLink:function(e,t){var i,n,o,s=this,a=void 0===t?jQuery(e.currentTarget).attr("href"):t,r="",l="",u="";e.preventDefault(),-1!==a.indexOf("#")&&(o=a.split("#"),a=o[0],r="#_"+o[1]),"object"==typeof e&&(l=e.currentTarget.pathname,u=e.currentTarget.hostname),void 0!==t&&((i=document.createElement("a")).href=t,l=i.pathname,u=i.hostname),"#"===a.charAt(0)||""!==r&&l===location.pathname?"function"==typeof(n=this.previewWindow.jQuery(jQuery(e.currentTarget))).fusion_scroll_to_anchor_target&&n.fusion_scroll_to_anchor_target():location.hostname!==u&&void 0===t||(this.showLoader(),this.hasContentChanged("page")?FusionApp.confirmationPopup({title:fusionBuilderText.unsaved_changes,content:fusionBuilderText.changes_will_be_lost,class:"fusion-confirmation-unsaved-changes",actions:[{label:fusionBuilderText.cancel,classes:"cancel no",callback:function(){s.hideLoader(),FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.just_leave,classes:"dont-save yes",callback:function(){s.switchPage(s.builderId,a,r)}},{label:fusionBuilderText.leave,classes:"save yes",callback:function(){var e={action:"switch_page"};e.builderid=s.builderId,e.linkhref=a,e.linkhash=r,s.savePostContent(e)}}]}):s.switchPage(s.builderId,a,r))},switchPage:function(e,t,i){var n={};jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fb-preview").addClass("refreshing"),this.manualSwitch=!0,this.hasContentChanged("global","theme-option")?(n={fusion_load_nonce:fusionAppConfig.fusion_load_nonce,builder_id:this.builderId,action:"fusion_app_switch_page",fusion_options:jQuery.param(FusionApp.settings),option_name:fusionOptionName},jQuery("#fb-preview").addClass("refreshing"),t=-1!==t.indexOf("?")?t+"&builder=true&builder_id="+e+i:t+"?builder=true&builder_id="+e+i,this.formPost(n,t)):this.goToURL(e,t,i)},goToURL:function(e,t,i){var n;this.manualSwitch=!0,jQuery(".ui-dialog-content").length&&jQuery(".ui-dialog-content").dialog("close"),jQuery("#fusion-close-element-settings").length&&jQuery("#fusion-close-element-settings").trigger("click"),jQuery("#fusion-builder-confirmation-modal").hide(),jQuery("#fusion-builder-confirmation-modal-dark-overlay").hide(),n=-1!==t.indexOf("?")?t+"&builder=true&builder_id="+e+i:t+"?builder=true&builder_id="+e+i,jQuery("#fb-preview").attr("src",n)},updateURL:function(e){var t=document.getElementById("fb-preview").contentWindow.document;""!==e&&"?fb-edit=1"!==e||(e=jQuery("#fb-preview").attr("src").split("?")[0]+"?fb-edit=1"),window.history.replaceState({url:e},t.title,e),document.title=t.title},removeScripts:function(e,t){var i=jQuery("<div>"+e+"</div>"),n=i.find("script"),o=[];return n.length?(n.each(function(){jQuery(this).attr("src")?o.push({type:"src",value:jQuery(this).attr("src")}):o.push({type:"inline",value:jQuery(this).html()}),jQuery(this).remove()}),this.scripts[t]=o,i.html()):i.html()},injectScripts:function(e){var t,i,n=jQuery("#fb-preview").contents().find("body")[0],o=this.scripts[e],s=document.getElementById("fb-preview").contentWindow.document,a=s.write,r=this;s.write=function(){},void 0!==o&&o.length&&_.each(o,function(o,s){i="fusion-script-"+e+"-"+s,jQuery("#fb-preview").contents().find("body").find("#"+i).length&&jQuery("#fb-preview").contents().find("body").find("#"+i).remove(),(t=document.createElement("script")).setAttribute("type","text/javascript"),t.setAttribute("id","fusion-script-"+e+"-"+s),"src"===o.type?t.setAttribute("src",o.value):t.innerHTML=o.value,"inline"!==o.type||-1===o.value.indexOf("hbspt.forms.create")?n.appendChild(t):r.initHubSpotForm(o,e,t)}),s.write=a},initHubSpotForm:function(e,t,i){var n=this,o=void 0!==FusionApp.previewWindow.hbspt?0:500,s=jQuery("#fb-preview").contents().find('div[data-cid="'+t+'"]').find(".fusion-builder-element-content").first();this.hubspotRepeat="undefined"===this.hubspotRepeat?0:this.hubspotRepeat+1,5<this.hubspotRepeat||setTimeout(function(){void 0!==FusionApp.previewWindow.hbspt?s.length&&(n.hubspotRepeat=0,s.find(".hbspt-form").remove(),s[0].appendChild(i)):n.initHubSpotForm(e,t,i)},o)},deleteScripts:function(e){var t=this.scripts[e];t&&(_.each(t,function(t,i){var n="fusion-script-"+e+"-"+i;jQuery("#fb-preview").contents().find("body").find("#"+n).length&&jQuery("#fb-preview").contents().find("body").find("#"+n).remove()}),delete this.scripts[e])},elementSearchFilter:function(e){var t,i;e.find(".fusion-elements-filter").on("change paste keyup",function(){jQuery(this).val()?(i=jQuery(this).val().toLowerCase(),e.find(".fusion-builder-all-modules li").each(function(){"portfolio"===(t=jQuery(this).find(".fusion_module_title").text().trim().toLowerCase())&&(t+=" recent works"),-1!==t.search(i)||jQuery(this).hasClass("spacer")?jQuery(this).show():jQuery(this).hide()})):e.find(".fusion-builder-all-modules li").show()}),setTimeout(function(){jQuery(".fusion-elements-filter").focus()},50)},setElementFonts:function(e){var t,i,n=this.getPost("post_content"),o={},s=[];return"string"==typeof n&&""!==n&&-1!==n.indexOf("fusion_font_")&&(t=new RegExp('(fusion_font_[^=]*=")([^"]*)"',"g"),"object"==typeof(i=this.getPost("post_content").match(t))&&_.each(i,function(e,t){var i=e.slice(0,-1).split('="'),n=i[0].replace("fusion_font_family_","").replace("fusion_font_subset_","").replace("fusion_font_variant_",""),a="family";-1!==i[0].indexOf("fusion_font_subset_")?a="subset":-1!==i[0].indexOf("fusion_font_variant_")&&(a="variant"),""===i[1]&&"family"===a||("object"!=typeof o[n]?o[n]={}:"family"===a&&(s.push(o[n]),o[n]={}),o[n][a]=i[1],void 0!==o[n].family&&void 0!==o[n].subset&&void 0!==o[n].variant&&(s.push(o[n]),delete o[n]))}),_.each(o,function(e,t){void 0!==e.family&&""!==e.family&&s.push(o[t])}),_.each(s,function(t,i){void 0!==t.family&&""!==t.family&&(void 0===e[t.family]&&(e[t.family]={variants:[],subsets:[]}),"string"!=typeof t.variant||e[t.family].variants.includes(t.variant)||e[t.family].variants.push(t.variant),"string"!=typeof t.subset||e[t.family].subsets.includes(t.subset)||e[t.family].subsets.push(t.subset))})),e},setGoogleFonts:function(){var e=this,t={},i=jQuery("#fb-preview").contents().find("[data-fusion-google-font]");t=this.setElementFonts(t),i.length&&i.each(function(){void 0===t[jQuery(this).attr("data-fusion-google-font")]&&(t[jQuery(this).attr("data-fusion-google-font")]={variants:[],subsets:[]}),jQuery(this).attr("data-fusion-google-variant")&&t[jQuery(this).attr("data-fusion-google-font")].variants.push(jQuery(this).attr("data-fusion-google-variant")),jQuery(this).attr("data-fusion-google-subset")&&t[jQuery(this).attr("data-fusion-google-font")].subsets.push(jQuery(this).attr("data-fusion-google-subset"))}),"object"==typeof this.data.postMeta._fusion_google_fonts?(_.each(this.data.postMeta._fusion_google_fonts,function(t,i){_.each(t,function(t,n){e.data.postMeta._fusion_google_fonts[i][n]=_.values(t)})}),_.isEqual(this.data.postMeta._fusion_google_fonts,t)||(_.isEmpty(t)&&(t=""),this.data.postMeta._fusion_google_fonts=t,this.contentChange("page","page-option"))):_.isEmpty(t)||(this.data.postMeta._fusion_google_fonts=t,this.contentChange("page","page-option"))},toggleFontAwesomePro:function(e){("status_fontawesome_pro"===e||"fontawesome_v4_compatibility"===e&&0===jQuery("#fontawesome-shims-css").length)&&jQuery.ajax({type:"GET",url:fusionAppConfig.ajaxurl,dataType:"json",data:{action:"fusion_font_awesome",fusion_load_nonce:fusionAppConfig.fusion_load_nonce,pro_status:FusionApp.settings.status_fontawesome_pro},success:function(t){fusionAppConfig.fontawesomeicons=t.icons,jQuery("#fontawesome-css").attr("href",t.css_url),"fontawesome_v4_compatibility"===e?jQuery("body").append('<link rel="stylesheet" id="fontawesome-shims-css" href="'+t.shims_url+'" type="text/css" media="all">'):jQuery("#fontawesome-shims-css").attr("href",t.css_url),FusionApp.reInitIconPicker()}})},FontAwesomeSubSets:function(){FusionApp.reInitIconPicker()},hasContentChanged:function(e,t){var i=!1;return void 0!==e?i=void 0!==t?void 0!==this.contentChanged[e]&&void 0!==this.contentChanged[e][t]&&!0===this.contentChanged[e][t]:void 0!==this.contentChanged[e]&&!_.isEmpty(this.contentChanged[e]):_.each(this.contentChanged,function(e){_.isEmpty(e)||(i=!0)}),i},contentChange:function(e,t){"object"!=typeof this.contentChanged[e]&&(this.contentChanged[e]={}),this.contentChanged[e][t]=!0,FusionApp.set("hasChange",!0)},iconPicker:function(){var e=fusionAppConfig.fontawesomeicons,t='<div class="fusion-icons-rendered" style="height:0px; overflow:hidden;">',i='<div class="fusion-icon-picker-nav-rendered" style="height:0px; overflow:hidden;">',n={fas:"Solid",far:"Regular",fal:"Light",fab:"Brands"},o={fas:"",fab:"",far:"",fal:""},s=this,a="undefined"!=typeof fusionIconSearch&&Array.isArray(fusionIconSearch);!jQuery(".fusion-icons-rendered").length&&Array.isArray(s.settings.status_fontawesome)&&(_.each(e,function(e,t){_.each(e[1],function(i){-1!==s.settings.status_fontawesome.indexOf(i)&&(o[i]+='<span class="icon_preview '+t+'" title="'+t+" - "+n[i]+'"><i class="'+e[0]+" "+i+'" data-name="'+e[0].substr(3)+'"></i></span>')})}),_.each(n,function(e,n){-1!==s.settings.status_fontawesome.indexOf(n)&&(i+='<a href="#fusion-'+n+'" class="fusion-icon-picker-nav-item">'+e+"</a>",t+='<div id="fusion-'+n+'" class="fusion-icon-set">'+o[n]+"</div>")}),e=fusionAppConfig.customIcons,_.each(e,function(e,n){i+='<a href="#'+n+'" class="fusion-icon-picker-nav-item">'+e.name+"</a>",t+='<div id="'+n+'" class="fusion-icon-set fusion-custom-icon-set">',_.each(e.icons,function(i){a&&fusionIconSearch.push({name:i}),t+='<span class="icon_preview '+i+'" title="'+e.css_prefix+i+'"><i class="'+e.css_prefix+i+'" data-name="'+i+'"></i></span>'}),t+="</div>"}),i+="</div>",t+="</div>",jQuery("body").append(t+i),jQuery(".fusion-icon-picker-save").trigger("click"),void 0!==window["fusion-fontawesome-free-shims"]&&_.each(window["fusion-fontawesome-free-shims"],function(e){null!==e[0]&&null!==e[2]&&jQuery(".fusion-icons-rendered").find("i.fa-"+e[2]).attr("data-alt-name",e[0])}))},reInitIconPicker:function(){jQuery(".fusion-icons-rendered").remove(),this.iconPicker()},checkLegacyAndCustomIcons:function(e){var t;return""!==e&&("fusion-prefix-"===e.substr(0,14)?e=e.replace("fusion-prefix-",""):(e=e.split(" "),t="",void 0===e[1]&&(e[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(t=e[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(i,n){if(n[0]===t)return null!==n[2]&&(e[0]="fa-"+n[2]),null!==n[1]&&(e[1]=n[1]),!1})),e=e[0]+" "+e[1]))),e},contentReset:function(e,t){void 0!==t?void 0!==this.contentChanged[e]&&void 0!==this.contentChanged[e][t]&&delete this.contentChanged[e][t]:void 0!==e?this.contentChanged[e]={}:this.contentChanged={},this.hasContentChanged()||FusionApp.set("hasChange",!1)},confirmationPopup:function(e){if("hide"===e.action)return jQuery("#fusion-builder-confirmation-modal-dark-overlay").hide(),void jQuery("#fusion-builder-confirmation-modal").hide();(e.content||e.title)&&e.actions&&e.actions[0]&&(e.icon||(e.icon='<i class="fas fa-exclamation">'),e.type||(e.type="warning"),jQuery("#fusion-builder-confirmation-modal-dark-overlay").show(),jQuery("#fusion-builder-confirmation-modal").show(),void 0!==e.class&&jQuery("#fusion-builder-confirmation-modal").attr("class",e.class),jQuery("#fusion-builder-confirmation-modal span.icon").html(e.icon).removeClass("type-warning type-error-type-info").addClass("type-"+e.type),e.title?(jQuery("#fusion-builder-confirmation-modal h3.title").show(),jQuery("#fusion-builder-confirmation-modal h3.title").html(e.title)):jQuery("#fusion-builder-confirmation-modal h3.title").hide(),e.content?(jQuery("#fusion-builder-confirmation-modal span.content").show(),jQuery("#fusion-builder-confirmation-modal span.content").html(e.content)):jQuery("#fusion-builder-confirmation-modal span.content").hide(),jQuery("#fusion-builder-confirmation-modal .actions").html(""),_.each(e.actions,function(e){var t="."+e.classes;0<e.classes.indexOf(" ")&&(t="."+e.classes.replace(/ /g,".")),jQuery("#fusion-builder-confirmation-modal .actions").append('<button class="'+e.classes+'">'+e.label+"</button>"),jQuery("#fusion-builder-confirmation-modal .actions "+t).on("click",e.callback)}))},dialogCloseResets:function(e){e.$el.closest(".ui-dialog.fusion-builder-child-element").length||jQuery("body").removeClass("fusion-settings-dialog-default fusion-settings-dialog-large"),this.previewWindow.jQuery("body").removeClass("fusion-dialog-ui-active")},multipleDialogsNotice:function(){this.confirmationPopup({title:fusionBuilderText.multi_dialogs,content:fusionBuilderText.multi_dialogs_notice,actions:[{label:fusionBuilderText.ok,classes:"yes",callback:function(){FusionApp.confirmationPopup({action:"hide"})}}]})}});void 0===FusionApp&&(window.FusionApp=new e)});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.inlineEditor=Backbone.Model.extend({initialize:function(){rangy.init(),this.createExtended(),this.createTypography(),this.createFontColor(),this.createInlineShortcode(),this.createAlign(),this.createAnchor(),this.createRemove(),this.createIndent(),this.createOutdent(),Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0}},createExtended:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionExtended",action:"fusionExtended",aria:fusionBuilderText.extended_options,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-ellipsis"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableDrop",this.dragDisable.bind(this)),this.subscribe("editableDrag",this.dragDisable.bind(this))},handleClick:function(e){var t=this.base.getExtensionByName("toolbar");return e.preventDefault(),e.stopPropagation(),t.toolbar.querySelector(".medium-editor-toolbar-actions").classList.toggle("alternative-active"),this.setToolbarPosition(),!1},dragDisable:function(e){(jQuery(e.target).hasClass(".fusion-inline-element")||jQuery(e.target).find(".fusion-inline-element").length)&&(e.preventDefault(),e.stopPropagation())}});MediumEditor.extensions.fusionExtended=t},createAlign:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionAlign",action:"fusionAlign",aria:fusionBuilderText.align_text,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-align-center"></i>',hasForm:!0,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},checkState:function(e){var t=MediumEditor.selection.getSelectedElements(this.document),i=this.getExistingValue(t);void 0!==i&&t.length&&(i="start"===i?"left":i.replace("-moz-",""),jQuery(this.button).find("i").attr("class","fusiona-align-"+i))},handleClick:function(e){var t=this.base.getExtensionByName("toolbar");return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||(t.hideExtensionForms(),this.showForm()),!1},getExistingValue:function(e){var t,i,n="left";for(e.length||(e=this.base.elements),t=0;t<e.length;t++)i=e[t],n=jQuery(i).css("text-align");return n},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=jQuery(this.getForm());e.find(".medium-editor-button-active").removeClass("medium-editor-button-active"),e.removeClass("visible").addClass("hidden"),setTimeout(function(){e.removeClass("hidden")},400)},showForm:function(){var e,t=MediumEditor.selection.getSelectedElements(this.document),i=this.getExistingValue(t),n=this.getForm();i="start"===i?"left":i,this.base.saveSelection(),this.hideToolbarDefaultActions(),n.classList.add("visible"),n.classList.remove("hidden"),(e=n.querySelector(".fusion-align-"+i))&&e.classList.add("medium-editor-button-active"),this.setToolbarPosition()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},createForm:function(){var e=this.document,t=e.createElement("div"),i=e.createElement("ul"),n=e.createElement("button"),o=e.createElement("button"),s=e.createElement("button"),a=e.createElement("button"),r=e.createElement("button"),l=e.createElement("li"),u=e.createElement("i");return this.base.saveSelection(),t.className="medium-editor-toolbar-form medium-editor-alternate-toolbar",t.id="medium-editor-toolbar-form-align-"+this.getEditorId(),i.className="medium-editor-toolbar-actions",u.className="fusiona-align-left",n.className="fusion-align-left",n.setAttribute("title",fusionBuilderText.align_left),n.setAttribute("aria-label",fusionBuilderText.align_left),n.setAttribute("data-action","justifyLeft"),n.appendChild(u),l.appendChild(n),i.appendChild(l),this.on(n,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-center",o.className="fusion-align-center",o.setAttribute("title",fusionBuilderText.align_center),o.setAttribute("aria-label",fusionBuilderText.align_center),o.setAttribute("data-action","justifyCenter"),o.appendChild(u),l.appendChild(o),i.appendChild(l),this.on(o,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-right",s.className="fusion-align-right",s.setAttribute("title",fusionBuilderText.align_right),s.setAttribute("aria-label",fusionBuilderText.align_right),s.setAttribute("data-action","justifyRight"),s.appendChild(u),l.appendChild(s),i.appendChild(l),this.on(s,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-align-justify",a.className="fusion-align-justify",a.setAttribute("title",fusionBuilderText.align_justify),a.setAttribute("aria-label",fusionBuilderText.align_justify),a.setAttribute("data-action","justifyFull"),a.appendChild(u),l.appendChild(a),i.appendChild(l),this.on(a,"click",this.applyAlignment.bind(this),!0),l=e.createElement("li"),(u=e.createElement("i")).className="fusiona-check",r.setAttribute("title",fusionBuilderText.accept),r.setAttribute("aria-label",fusionBuilderText.accept),r.appendChild(u),l.appendChild(r),i.appendChild(l),this.on(r,"click",this.closeForm.bind(this),!0),t.appendChild(i),t},applyAlignment:function(e){var t=e.currentTarget.getAttribute("data-action"),i=jQuery(e.currentTarget),n=i.find("i").attr("class");i.closest("ul").find(".medium-editor-button-active").removeClass("medium-editor-button-active"),i.addClass("medium-editor-button-active"),jQuery(this.button).find("i").attr("class",n),this.base.restoreSelection(),this.execAction(t,{skipCheck:!0})},closeForm:function(){this.hideForm(),this.base.checkSelection()}});MediumEditor.extensions.fusionAlign=t},createTypography:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionTypography",action:"fusionTypography",aria:fusionBuilderText.typography,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-font-solid"></i>',hasForm:!0,fonts:[],loadPreviews:!1,override:!1,parentCid:!1,searchFonts:[],overrideParams:["font-size","line-height","letter-spacing","tag","font-family"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"span",tagNames:["span","b","strong","a","p","h1","h2","h3","h4","h5","h6"],normalize:!0}),this._handleInputChange=_.debounce(_.bind(this.handleInputChange,this),100)},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||this.showForm(),!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,t=this.getForm(),i=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(i=300),t.classList.add("hidden"),jQuery(t).find(".fusion-options-wrapper").removeClass("visible"),t.classList.remove("visible"),setTimeout(function(){t.classList.remove("hidden")},400),setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},i)},showForm:function(){var e=this,t=this.getForm(),i=t.querySelectorAll(".active"),n=t.querySelector('[href="#settings"]'),o=t.querySelector('[data-id="settings"]');this.base.saveSelection(),this.hideToolbarDefaultActions(),t.classList.add("visible"),t.classList.remove("hidden"),i&&_.each(i,function(e){e.classList.remove("active")}),n&&n.classList.add("active"),o&&o.classList.add("active"),_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){e.insertFamilyChoices(),e.setFontFamilyValues()}):(this.insertFamilyChoices(),this.setFontFamilyValues()),this.setToolbarPosition(),this.setTagValue(),this.setFontStyleValues()},getExistingTag:function(){var e,t=MediumEditor.selection.getSelectedElements(this.document),i=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(i),o="p";for("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.setOverrideParams(this,this.overrideParams),n&&(t=[n]),t.length||(t=this.base.elements),e=0;e<t.length;e++)o=t[e].nodeName.toLowerCase();return o},setTagValue:function(){var e=this.getExistingTag(),t=this.getForm(),i=(t.querySelector(".typography-tags"),t.querySelector('[data-val="'+e+'"]'));i&&i.classList.add("active")},getExistingStyleValues:function(){var e,t,i,n=MediumEditor.selection.getSelectedElements(this.document),o=MediumEditor.selection.getSelectionRange(this.document);for(MediumEditor.selection.getSelectedParentElement(o)&&(n=[MediumEditor.selection.getSelectedParentElement(o)]),n.length||(n=this.base.elements),e=0;e<n.length;e++)if(t=n[e],(i={}).size=window.getComputedStyle(t,null).getPropertyValue("font-size"),i.lineHeight=window.getComputedStyle(t,null).getPropertyValue("line-height"),i.letterSpacing=window.getComputedStyle(t,null).getPropertyValue("letter-spacing"),void 0!==t.style.fontSize&&t.style.fontSize&&-1===t.style.fontSize.indexOf("var(")&&(i.size=t.style.fontSize),void 0!==t.style.lineHeight&&t.style.lineHeight&&-1===t.style.lineHeight.indexOf("var(")&&(i.lineHeight=t.style.lineHeight),void 0!==t.style.letterSpacing&&t.style.letterSpacing&&-1===t.style.letterSpacing.indexOf("var(")&&(i.letterSpacing=t.style.letterSpacing),t.hasAttribute("data-fusion-font"))return i;return i},getExistingFamilyValues:function(){var e,t,i=MediumEditor.selection.getSelectedElements(this.document),n=MediumEditor.selection.getSelectionRange(this.document),o={subset:"latin",subsetLabel:"Default",variant:"regular",variantLabel:"Default",family:""};for(MediumEditor.selection.getSelectedParentElement(n)&&(i=[MediumEditor.selection.getSelectedParentElement(n)]),i.length||(i=this.base.elements),e=0;e<i.length;e++)if(t=i[e],o.family=window.getComputedStyle(t,null).getPropertyValue("font-family"),-1!==o.family.indexOf(",")&&(o.family=o.family.split(",")[0]),void 0!==t.style.fontFamily&&t.style.fontFamily&&(o.family=t.style.fontFamily),t.hasAttribute("data-fusion-google-font")&&(o.family=t.getAttribute("data-fusion-google-font")),o.family=o.family.replace(/"/g,"").replace(/'/g,""),t.hasAttribute("data-fusion-google-subset")&&(o.subset=t.getAttribute("data-fusion-google-subset")),t.hasAttribute("data-fusion-google-variant")&&(o.variant=t.getAttribute("data-fusion-google-variant"),_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)||(variants=this.getVariants(o.family),_.each(variants,function(e){o.variant===e.id&&(o.variantLabel=e.label)}))),t.hasAttribute("data-fusion-font"))return o;return o},setFontFamilyValues:function(e){var t=this.getExistingFamilyValues(),i=(e=this.getForm()).querySelector(".typography-family").querySelector('[data-value="'+t.family+'"]'),n=e.querySelector("#fusion-variant"),o=e.querySelector(".fuson-options-holder.variant"),s=e.querySelector(".fuson-options-holder.subset"),a=e.querySelector("#fusion-subset");i&&i.classList.add("active"),n&&(n.setAttribute("data-value",t.variant),n.innerHTML=t.variantLabel),o&&this.updateVariants(t.family),a&&(a.setAttribute("data-value",t.subset),a.innerHTML=t.subsetLabel),s&&this.updateSubsets(t.family)},setFontStyleValues:function(){var e=this.getExistingStyleValues(),t=this.getForm(),i=t.querySelector("#font_size"),n=t.querySelector("#line_height"),o=t.querySelector("#letter_spacing");i&&(i.setAttribute("value",e.size),i.value=e.size),n&&(n.setAttribute("value",e.lineHeight),n.value=e.lineHeight),o&&(o.setAttribute("value",e.letterSpacing),o.value=e.letterSpacing)},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.hideForm()},visibleY:function(e,t,i){var n=e.getBoundingClientRect(),o=n.top,s=n.height;return!(e.classList.contains("visible")||(n=familyHold.getBoundingClientRect(),0==o<=i||o+s<=t))},getClosest:function(e,t){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),i=t.length;this!==0<=--i&&t.item(i););return-1<i});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},createForm:function(){var e,t,i,n,o,s,a,r,l,u,d,c,p,f,h,g,m,v,b=this,y=this.document,w=y.createElement("div");return y.createElement("select"),y.createElement("a"),y.createElement("a"),w.className="medium-editor-toolbar-form fusion-inline-typography",w.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),(e=y.createElement("div")).className="fusion-typography-nav",(t=y.createElement("a")).setAttribute("href","#settings"),t.innerHTML=fusionBuilderText.typography_settings,t.className="active",e.appendChild(t),(i=y.createElement("a")).setAttribute("href","#family"),i.innerHTML=fusionBuilderText.typography_family,e.appendChild(i),(n=y.createElement("button")).className="fusion-inline-editor-close",n.innerHTML='<i class="fusiona-check"></i>',e.appendChild(n),(o=y.createElement("div")).className="fusion-typography-tabs",settingsTab=y.createElement("div"),settingsTab.setAttribute("data-id","settings"),settingsTab.className="active",o.appendChild(settingsTab),(s=y.createElement("div")).className="typography-tags",s.innerHTML="<span>"+fusionBuilderText.typography_tag+"</span>",a=["p","h1","h2","h3","h4","h5","h6"],_.each(a,function(e){var t=y.createElement("button");1===e.length?t.innerHTML=e:2===e.length&&(t.className="fusiona-"+e),t.setAttribute("data-val",e),b.on(t,"click",function(){var i=s.querySelectorAll(".active"),n=t.classList.contains("active"),o="p"===e?void 0:e.replace("h","");i&&_.each(i,function(e){e.classList.remove("active")}),b.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(b.parentCid,b.override.tag,o)?b.base.checkSelection():b.execAction("append-"+e,{skipCheck:!0}),n&&e!==b.getExistingTag()||t.classList.add("active")}),s.appendChild(t)}),settingsTab.appendChild(s),(r=y.createElement("div")).className="typography-styling",l=[{label:fusionBuilderText.typography_fontsize,id:"font_size",name:"fontSize"},{label:fusionBuilderText.typography_lineheight,id:"line_height",name:"lineHeight"},{label:fusionBuilderText.typography_letterspacing,id:"letter_spacing",name:"letterSpacing"}],_.each(l,function(e){var t=y.createElement("div"),i=y.createElement("label"),n=y.createElement("input"),o=y.createElement("button"),s=y.createElement("button");i.setAttribute("for",e.id),i.innerHTML=e.label,n.setAttribute("type","text"),n.setAttribute("name",e.name),n.setAttribute("id",e.id),n.value="",o.className="fusiona-arrow-up",s.className="fusiona-arrow-down",t.appendChild(i),t.appendChild(n),t.appendChild(o),t.appendChild(s),b.on(n,"change",b._handleInputChange.bind(b)),b.on(n,"blur",b._handleInputChange.bind(b)),b.on(n,"fusion-change",b.handleInputChange.bind(b)),b.on(o,"click",function(){var e,t,i,o=n.value;(o||0===o)&&((e=parseFloat(o,10))||0===e)&&(t=o.replace(e,""),i=e.countDecimals(),increment=0===i?1:1/Math.pow(10,i),e=(e+increment).toFixed(i),n.value=e+t,n.dispatchEvent(new Event("fusion-change")))}),b.on(s,"click",function(){var e,t,i,o=n.value;o&&(e=parseFloat(o,10))&&(t=o.replace(e,""),i=e.countDecimals(),increment=0===i?1:1/Math.pow(10,i),e=(e-increment).toFixed(i),n.value=e+t,n.dispatchEvent(new Event("fusion-change")))}),r.appendChild(t)}),settingsTab.appendChild(r),(u=y.createElement("div")).setAttribute("data-id","family"),o.appendChild(u),familyHold=y.createElement("div"),familyHold.className="typography-family",this.loadPreviews&&this.on(familyHold,"scroll",function(){var e=familyHold.getElementsByTagName("div"),t=familyHold.getBoundingClientRect(),i=t.top,n=t.bottom;_.each(e,function(e){var t=e.getAttribute("data-value");b.visibleY(e,i,n)&&(e.classList.add("visible"),b.getWebFont(t))})}),u.appendChild(familyHold),(d=y.createElement("div")).className="typography-family-options",c=y.createElement("div"),(g=y.createElement("div")).className="fusion-select-wrapper",g.innerHTML='<label for="variant">'+fusionBuilderText.typography_variant+"</label>",(p=y.createElement("div")).className="fusion-select fusion-selected-value",p.id="fusion-variant",p.setAttribute("data-name","variant"),p.setAttribute("data-id","variant"),g.appendChild(p),(v=y.createElement("div")).className="fusion-options-wrapper variant",v.innerHTML='<label for="variant">'+fusionBuilderText.typography_variant+"</label>",(m=y.createElement("div")).className="fuson-options-holder variant",v.appendChild(m),c.appendChild(g),c.appendChild(v),d.appendChild(c),f=y.createElement("div"),familySubsetVisible=y.createElement("div"),familySubsetVisible.className="fusion-select-wrapper",familySubsetVisible.innerHTML='<label for="subset">'+fusionBuilderText.typography_subset+"</label>",(h=y.createElement("div")).className="fusion-select fusion-selected-value",h.id="fusion-subset",h.setAttribute("data-name","subset"),h.setAttribute("data-id","subset"),familySubsetVisible.appendChild(h),familySubsetOptions=y.createElement("div"),familySubsetOptions.className="fusion-options-wrapper subset",familySubsetOptions.innerHTML='<label for="subset">'+fusionBuilderText.typography_subset+"</label>",familySubsetOptionsHolder=y.createElement("div"),familySubsetOptionsHolder.className="fuson-options-holder subset",familySubsetOptions.appendChild(familySubsetOptionsHolder),f.appendChild(familySubsetVisible),f.appendChild(familySubsetOptions),d.appendChild(f),u.appendChild(d),w.appendChild(e),w.appendChild(o),this.on(w,"click",this.handleFormClick.bind(this)),this.on(t,"click",this.handleTabClick.bind(this)),this.on(i,"click",this.handleTabClick.bind(this)),this.on(g,"click",this.handleVariantClick.bind(this)),this.on(familySubsetVisible,"click",this.handleVariantClick.bind(this)),this.on(familySubsetOptionsHolder,"click",this.handleOptionClick.bind(this)),this.on(m,"click",this.handleOptionClick.bind(this)),this.on(n,"click",this.doFormSave.bind(this)),w},handleVariantClick:function(e){var t=this.getForm(),i=e.currentTarget.querySelector(".fusion-selected-value"),n=i.getAttribute("data-value"),o=i.getAttribute("data-id"),s=t.querySelector(".fuson-options-holder."+o),a=s.querySelectorAll(".active"),r=s.querySelector('[data-value="'+n+'"]'),l=t.querySelectorAll(".fusion-options-wrapper"),u=t.querySelector(".fusion-options-wrapper."+o);a&&_.each(a,function(e){e.classList.remove("active")}),r&&r.classList.add("active"),l&&_.each(l,function(e){e.classList.remove("visible")}),u&&u.classList.add("visible")},handleOptionClick:function(e){var t;e.target.classList.contains("fusion-select")&&(t=this.getClosest(e.target,".fusion-options-wrapper"))&&t.classList.remove("visible")},insertFamilyChoices:function(e){var t=this,i=(e=void 0===e?this.getForm().querySelector(".typography-family"):e,this.document),n=i.createElement("div"),o=i.createElement("input"),s=i.createElement("span"),a=[];e.hasChildNodes()||void 0===FusionApp.assets.webfonts||(s.classList.add("fusiona-search"),t.on(s,"click",function(e){var i,n=e.target.parentNode;n.classList.toggle("open"),n.classList.contains("open")?n.querySelector("input").focus():((i=n.querySelector("input")).value="",i.dispatchEvent(new Event("change"))),t.getForm().querySelector(".typography-family").classList.remove("showing-results")}),n.appendChild(s),o.setAttribute("type","search"),o.setAttribute("name","fusion-ifs"),o.setAttribute("id","fusion-ifs"),o.placeholder=fusionBuilderText.search,t.on(o,"keydown",t.handleFontSearch.bind(t)),t.on(o,"input",t.handleFontSearch.bind(t)),t.on(o,"change",t.handleFontSearch.bind(t)),n.classList.add("fusion-ifs-hold"),n.appendChild(o),e.parentNode.appendChild(n),"object"!=typeof FusionApp.assets.webfonts.custom||_.isEmpty(FusionApp.assets.webfonts.custom)||1===FusionApp.assets.webfonts.custom.length&&"object"==typeof FusionApp.assets.webfonts.custom[0]&&""===FusionApp.assets.webfonts.custom[0].family||(option=i.createElement("div"),option.innerHTML=fusionBuilderText.custom_fonts,option.classList.add("fusion-cfh"),e.appendChild(option),_.each(FusionApp.assets.webfonts.custom,function(n,o){n.family&&""!==n.family&&a.push({id:n.family.replace(/&quot;/g,"&#39"),text:n.label}),option=i.createElement("div"),option.innerHTML=n.label,option.setAttribute("data-value",n.family),option.setAttribute("data-id",n.family.replace(/"/g,"").replace(/'/g,"").toLowerCase()),option.setAttribute("data-type","custom-font"),t.on(option,"click",t.handleFontChange.bind(t)),e.appendChild(option)})),_.each(FusionApp.assets.webfonts.google,function(n,o){a.push({id:n.family,text:n.label}),option=i.createElement("div"),option.innerHTML=n.label,option.setAttribute("data-value",n.family),option.setAttribute("data-id",n.family.replace(/"/g,"").replace(/'/g,"").toLowerCase()),t.loadPreviews&&(option.setAttribute("style","font-family:"+n.family),5>o&&(t.getWebFont(n.family),option.classList.add("visible"))),t.on(option,"click",t.handleFontChange.bind(t)),e.appendChild(option)}),this.searchFonts=a)},handleFontSearch:function(e){var t,i,n=this.getForm(),o=e.target.value,s=(jQuery(n).find(".fusion-ifs-hold"),jQuery(n).find(".typography-family"));s.scrollTop(0),3>o.length?s.find("> div").css("display","block"):(s.find("> div").css("display","none"),t={threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["text"]},i=new Fuse(jQuery.extend(!0,this.searchFonts,{}),t).search(o),_.each(i,function(e){s.find('div[data-id="'+e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase()+'"]').css("display","block")}),s.addClass("showing-results"))},handleTabClick:function(e){var t,i=this.getForm(),n=e.currentTarget,o=n.getAttribute("href").replace("#",""),s=i.querySelector(".fusion-typography-tabs"),a=i.querySelector(".fusion-typography-nav"),r=i.querySelector(".typography-family"),l=r.querySelector(".active");_.each(s.children,function(e){o!==e.getAttribute("data-id")?e.classList.contains("active")&&e.classList.remove("active"):e.classList.add("active")}),_.each(a.querySelectorAll(".active"),function(e){e.classList.remove("active")}),n.classList.add("active"),r.firstChild?"family"===o&&l&&(t=0==(t=l.getBoundingClientRect().top+r.scrollTop-r.getBoundingClientRect().top)?0:t-6-l.getBoundingClientRect().height,r.scrollTop=t):this.insertFamilyChoices()},getParamFromTarget:function(e){switch(e){case"letterSpacing":return"letter-spacing";case"lineHeight":return"line-height";case"fontSize":return"font-size";default:return e}},handleInputChange:function(e){var t,i=this.getForm(),n=e.target.value,o=e.target.name,s={},a=document.getElementById("fb-preview"),r=rangy.dom.getIframeWindow(a),l=!1,u=this.getParamFromTarget(o);this.base.restoreSelection(),(t=MediumEditor.selection.getSelectionElement(this.document))&&("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override[u],n)||(this.classApplier.applyToSelection(r),s[o]=n,t.querySelectorAll(".fusion-editing").forEach(function(e){jQuery(e).css(s),e.setAttribute("data-fusion-font",!0),e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),"fontSize"!==o||l||((l=i.querySelector("#line_height")).value=void 0!==e.style.lineHeight&&e.style.lineHeight?e.style.lineHeight:window.getComputedStyle(e,null).getPropertyValue("line-height"))}),this.base.saveSelection(),this.base.trigger("editableInput",{},t)))},handleFontChange:function(e){var t=e.target.getAttribute("data-value"),i=e.target.classList.contains("fusion-select")?this.getFontFamily():t,n=this,o=t,s=t;e.target.classList.contains("fusion-variant-select")?(this.updateSingleVariant(t,e.target.innerHTML),s=this.getFontSubset()):e.target.classList.contains("fusion-subset-select")?(this.updateSingleSubset(t,e.target.innerHTML),o=this.getFontVariant()):(this.updateSingleFamily(),o=this.updateVariants(i),s=this.updateSubsets(i)),e.target.classList.add("active"),i&&(-1!==FusionApp.assets.webfontsStandardArray.indexOf(i)||this.isCustomFont(i)?this.changePreview(i,!1,o,s):this.webFontLoad(i,o,s,!1)?n.changePreview(i,!0,o,s):jQuery(window).one("fusion-font-loaded",function(){n.changePreview(i,!0,o,s)}))},isCustomFont:function(e){var t=!1;return"object"==typeof FusionApp.assets.webfonts.custom&&(_.each(FusionApp.assets.webfonts.custom,function(i,n){e===i.family&&(t=!0)}),t)},getFontFamily:function(){var e=this.getForm().querySelector(".typography-family").querySelector(".active");return!!e&&e.getAttribute("data-value")},getFontVariant:function(){var e=this.getForm().querySelector("#fusion-variant");return!!e&&e.getAttribute("data-value")},getFontSubset:function(){var e=this.getForm().querySelector("#fusion-subset");return!!e&&e.getAttribute("data-value")},updateSingleVariant:function(e,t){var i=this.getForm(),n=i.querySelector("#fusion-variant"),o=i.querySelector(".fuson-options-holder.variant").querySelectorAll(".active");n.setAttribute("data-value",e),n.innerHTML=t,o&&_.each(o,function(e){e.classList.remove("active")})},updateSingleSubset:function(e,t){var i=this.getForm(),n=i.querySelector("#fusion-subset"),o=i.querySelector(".fuson-options-holder.subset").querySelectorAll(".active");n.setAttribute("data-value",e),n.innerHTML=t,o&&_.each(o,function(e){e.classList.remove("active")})},updateSingleFamily:function(e,t){var i=this.getForm().querySelector(".typography-family").querySelectorAll(".active");i&&_.each(i,function(e){e.classList.remove("active")})},updateSubsets:function(e){for(var t=this,i=this.getSubsets(e),n=this.getForm(),o=n.querySelector(".fuson-options-holder.subset"),s=n.querySelector("#fusion-subset"),a=this.document,r=!1,l="latin",u=s.getAttribute("data-value");o.firstChild;)o.removeChild(o.firstChild);return i||(i=[{id:"",label:"Default"}]),_.contains(_.pluck(i,"id"),u)&&(l=u),_.each(i,function(e){var i=a.createElement("div");i.className="fusion-select fusion-subset-select",i.innerHTML=e.label,i.setAttribute("data-value",e.id),l===e.id&&(r=!0,i.classList.add("active"),s.setAttribute("data-value",e.id),s.innerHTML=e.label),t.on(i,"click",t.handleFontChange.bind(t)),o.appendChild(i)}),!r&&o.firstChild&&(o.firstChild.classList.add("active"),l=o.firstChild.getAttribute("data-value"),s.setAttribute("data-value",l),s.innerHTML=o.firstChild.innerHTML),l},updateVariants:function(e){for(var t=this,i=this.getVariants(e),n=this.getForm(),o=n.querySelector(".fuson-options-holder.variant"),s=n.querySelector("#fusion-variant"),a=this.document,r=!1,l="regular",u=s.getAttribute("data-value");o.firstChild;)o.removeChild(o.firstChild);return i||(i=[{id:"regular",label:fusionBuilderText.typography_default}]),_.contains(_.pluck(i,"id"),u)&&(l=u),_.each(i,function(e){var i=a.createElement("div");i.className="fusion-select fusion-variant-select",i.innerHTML=e.label,i.setAttribute("data-value",e.id),l===e.id&&(r=!0,i.classList.add("active"),s.setAttribute("data-value",e.id),s.innerHTML=e.label),t.on(i,"click",t.handleFontChange.bind(t)),o.appendChild(i)}),!r&&o.firstChild&&(o.firstChild.classList.add("active"),l=o.firstChild.getAttribute("data-value"),s.setAttribute("data-value",l),s.innerHTML=o.firstChild.innerHTML),l},changePreview:function(e,t,i,n){var o,s=document.getElementById("fb-preview"),a=rangy.dom.getIframeWindow(s),r="",l="";t&&i&&(r=this.getFontWeightFromVariant(i),l=this.getFontStyleFromVariant(i)),this.base.restoreSelection(),(o=MediumEditor.selection.getSelectionElement(this.document))&&(this.classApplier.applyToSelection(a),o.querySelectorAll(".fusion-editing").forEach(function(o){o.style["font-family"]=e,o.style["font-style"]=l,o.style["font-weight"]=r,o.setAttribute("data-fusion-font",!0),t?(o.setAttribute("data-fusion-google-font",e),""!==i?o.setAttribute("data-fusion-google-variant",i):o.removeAttribute("data-fusion-google-variant"),""!==n?o.setAttribute("data-fusion-google-subset",n):o.removeAttribute("data-fusion-google-subset")):(o.removeAttribute("data-fusion-google-font"),o.removeAttribute("data-fusion-google-variant"),o.removeAttribute("data-fusion-google-subset")),o.classList.remove("fusion-editing"),0===o.classList.length&&o.removeAttribute("class")}),this.base.saveSelection(),this.base.trigger("editableInput",{},o))},handleFormClick:function(e){e.stopPropagation()}});_.extend(t.prototype,FusionPageBuilder.options.fusionTypographyField),MediumEditor.extensions.fusionTypography=t},createFontColor:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionFontColor",action:"fusionFontColor",aria:fusionBuilderText.font_color,contentDefault:"&#xB1;",contentFA:'<i class="fusion-color-preview"></i>',hasForm:!0,override:!1,parentCid:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"span",tagNames:["span","b","strong","a","p","h1","h2","h3","h4","h5","h6"],normalize:!0}),this._triggerUpdate=_.debounce(_.bind(this.triggerUpdate,this),300)},checkState:function(e){var t=MediumEditor.selection.getSelectedElements(this.document),i=this.getExistingValue(t);void 0!==i&&(this.button.querySelector(".fusion-color-preview").style.backgroundColor=i)},handleClick:function(e){var t,i;return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||(t=MediumEditor.selection.getSelectedElements(this.document),i=void 0!==(i=this.getExistingValue(t))?i:"",this.showForm(i)),!1},getExistingValue:function(e){var t,i,n;for("undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.setOverrideParams(this,"color"),e.length||(e=this.base.elements),t=0;t<e.length;t++)if(n=e[t],i=jQuery(n).css("color"),jQuery(n).data("fusion-font"))return i;return i},getForm:function(){return this.form||(this.form=this.createForm()),this.on(this.form,"click",this.handleFormClick.bind(this)),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,t=this.getForm(),i=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(i=300),t.classList.add("hidden"),t.classList.remove("visible"),setTimeout(function(){t.classList.remove("hidden")},400),this.getInput().value="",setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},i)},showForm:function(e){var t=this,i=this.getInput(),n=this.getForm();this.base.saveSelection(),this.hideToolbarDefaultActions(),n.classList.add("visible"),n.classList.remove("hidden"),this.setToolbarPosition(),i.value=e||"",jQuery(i).wpColorPicker({width:250,palettes:!1,hide:!0,change:function(e,n){"none"!==jQuery(i).closest(".fusion-inline-color-picker").find(".iris-picker").css("display")&&t.handleColorChange(n.color.toString())},clear:function(e,i){t.clearFontColor()}}),jQuery(i).iris("color",i.value),jQuery(i).iris("show"),jQuery(i).parent().parent().find(".wp-picker-clear-button").length||(jQuery(i).parent().parent().append('<button class="button button-small wp-picker-clear wp-picker-clear-button"><i class="fusiona-eraser-solid"></i></button>'),jQuery(i).parent().parent().find(".wp-picker-clear-button").on("click",function(){jQuery(i).parent().parent().find("input.wp-picker-clear").trigger("click")}))},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.hideForm()},createForm:function(){var e=this.document,t=e.createElement("div"),i=e.createElement("input"),n=e.createElement("button");return this.on(t,"click",this.handleFormClick.bind(this)),t.className="medium-editor-toolbar-form fusion-inline-color-picker",t.id="medium-editor-toolbar-form-fontcolor-"+this.getEditorId(),i.className="medium-editor-toolbar-input fusion-builder-color-picker-hex",i.setAttribute("data-alpha",!0),t.appendChild(i),n.className="fusion-inline-editor-close",n.innerHTML='<i class="fusiona-check"></i>',t.appendChild(n),this.on(n,"click",this.handleSaveClick.bind(this),!0),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontColor:function(){this.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override,"")||(MediumEditor.selection.getSelectedElements(this.document).forEach(function(e){void 0!==e.style&&void 0!==e.style.color&&(e.style.color="")}),this.base.trigger("editableInput",{},MediumEditor.selection.getSelectionElement(this.document)))},handleColorChange:function(e){var t,i=document.getElementById("fb-preview"),n=rangy.dom.getIframeWindow(i);e="undefined"===e||void 0===e?this.getInput().value:e,this.base.restoreSelection(),"undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.inlineEditorHelpers.updateParentElementParam(this.parentCid,this.override,e,!0)||(t=MediumEditor.selection.getSelectionElement(this.document))&&(this.classApplier.applyToSelection(n),t.querySelectorAll(".fusion-editing").forEach(function(t){t.classList.contains("fusion-editing")&&(jQuery(t).css({color:e}),t.classList.remove("fusion-editing"),0===t.classList.length&&t.removeAttribute("class"))}),this._triggerUpdate(t))},triggerUpdate:function(e){this.base.trigger("editableInput",{},e)},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()}});MediumEditor.extensions.fusionFontColor=t},createInlineShortcode:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionInlineShortcode",action:"fusionInlineShortcode",aria:fusionBuilderText.add_element,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-plus"></i>',hasForm:!0,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.dropCapClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_dropcap"},normalize:!0}),this.popoverClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_popover"},normalize:!0}),this.highlightClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_highlight"},normalize:!0}),this.tooltipClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_tooltip"},normalize:!0}),this.onepageClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_one_page_text_link"},normalize:!0}),this.modalLinkClassApplier=rangy.createClassApplier("fusion-inline-shortcode",{elementTagName:"span",elementAttributes:{"data-inline-shortcode":"true","data-element":"fusion_modal_text_link"},normalize:!0})},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()?this.hideForm():this.showForm(),!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this.getForm();e.classList.add("hidden"),e.classList.remove("visible"),setTimeout(function(){e.classList.remove("hidden")},400),this.setToolbarPosition()},showForm:function(){var e=this.getForm();this.base.saveSelection(),e.classList.add("visible"),e.classList.remove("hidden"),this.setToolbarPosition()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},createForm:function(){var e=this.document,t=e.createElement("div"),i=e.createElement("ul"),n=e.createElement("button"),o=e.createElement("button"),s=e.createElement("button"),a=e.createElement("button"),r=e.createElement("button"),l=e.createElement("button"),u=e.createElement("li"),d=e.createElement("i"),c=!1,p=!1,f=!1,h=!1,g=!1,m=!1;return void 0!==fusionAllElements.fusion_tooltip&&(c=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_tooltip.name)),void 0!==fusionAllElements.fusion_one_page_text_link&&(p=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_one_page_text_link.name)),void 0!==fusionAllElements.fusion_popover&&(f=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_popover.name)),void 0!==fusionAllElements.fusion_highlight&&(h=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_highlight.name)),void 0!==fusionAllElements.fusion_dropcap&&(g=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_dropcap.name)),void 0!==fusionAllElements.fusion_modal_text_link&&(m=fusionBuilderText.add_unknown.replace("%s",fusionAllElements.fusion_modal_text_link.name)),this.base.saveSelection(),t.className="medium-editor-toolbar-form medium-editor-dropdown-toolbar",t.id="medium-editor-toolbar-form-shortcode-"+this.getEditorId(),i.className="fusion-shortcode-form",u.innerHTML="Inline Elements",i.appendChild(u),g&&(u=e.createElement("li"),d.className="fusiona-font",n.className="fusion-dropcap-add",n.setAttribute("data-element","fusion_dropcap"),n.setAttribute("title",g),n.setAttribute("aria-label",g),n.appendChild(d),n.innerHTML+=fusionAllElements.fusion_dropcap.name,u.appendChild(n),i.appendChild(u),this.on(n,"click",this.addShortcodeElement.bind(this),!0)),h&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-H",o.className="fusion-highlight-add",o.setAttribute("data-element","fusion_highlight"),o.setAttribute("title",h),o.setAttribute("aria-label",h),o.appendChild(d),o.innerHTML+=fusionAllElements.fusion_highlight.name,u.appendChild(o),i.appendChild(u),this.on(o,"click",this.addShortcodeElement.bind(this),!0)),f&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-uniF61C",s.className="fusion-popover-add",s.setAttribute("data-element","fusion_popover"),s.setAttribute("title",f),s.setAttribute("aria-label",f),s.appendChild(d),s.innerHTML+=fusionAllElements.fusion_popover.name,u.appendChild(s),i.appendChild(u),this.on(s,"click",this.addShortcodeElement.bind(this),!0)),c&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-exclamation-sign",a.className="fusion-tooltip-add",a.setAttribute("data-element","fusion_tooltip"),a.setAttribute("title",c),a.setAttribute("aria-label",c),a.appendChild(d),a.innerHTML+=fusionAllElements.fusion_tooltip.name,u.appendChild(a),i.appendChild(u),this.on(a,"click",this.addShortcodeElement.bind(this),!0)),p&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-external-link",r.className="fusion-onepage-add",r.setAttribute("data-element","fusion_one_page_text_link"),r.setAttribute("title",p),r.setAttribute("aria-label",p),r.appendChild(d),r.innerHTML+=fusionAllElements.fusion_one_page_text_link.name,u.appendChild(r),i.appendChild(u),this.on(r,"click",this.addShortcodeElement.bind(this),!0)),m&&(u=e.createElement("li"),(d=e.createElement("i")).className="fusiona-external-link",l.className="fusion-modallink-add",l.setAttribute("data-element","fusion_modal_text_link"),l.setAttribute("title",m),l.setAttribute("aria-label",m),l.appendChild(d),l.innerHTML+=fusionAllElements.fusion_modal_text_link.name,u.appendChild(l),i.appendChild(u),this.on(l,"click",this.addShortcodeElement.bind(this),!0)),t.appendChild(i),this.on(t,"click",this.handleFormClick.bind(this)),t},addShortcodeElement:function(e){var t=document.getElementById("fb-preview"),i=rangy.dom.getIframeWindow(t),n=e.currentTarget.getAttribute("data-element");switch(this.base.restoreSelection(),n){case"fusion_dropcap":this.dropCapClassApplier.applyToSelection(i);break;case"fusion_highlight":this.highlightClassApplier.applyToSelection(i);break;case"fusion_popover":this.popoverClassApplier.applyToSelection(i);break;case"fusion_tooltip":this.tooltipClassApplier.applyToSelection(i);break;case"fusion_one_page_text_link":this.onepageClassApplier.applyToSelection(i);break;case"fusion_modal_text_link":this.modalLinkClassApplier.applyToSelection(i)}this.doFormSave(n)},handleFormClick:function(e){e.stopPropagation()},doFormSave:function(e){var t="";void 0!==e&&void 0!==fusionAllElements[e].name&&(t=fusionAllElements[e].name),this.base.trigger("editableInput",{},MediumEditor.selection.getSelectionElement(this.document)),void 0===FusionApp||"off"===FusionApp.preferencesData.open_settings?FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.added+" "+t+" "+fusionBuilderText.element):"undefined"!=typeof FusionPageBuilderApp&&(FusionPageBuilderApp.inlineEditors.shortcodeAdded=!0),this.base.checkSelection(),this.hideForm()}});MediumEditor.extensions.fusionInlineShortcode=t},createAnchor:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionAnchor",action:"createLink",aria:fusionBuilderText.link_options,contentDefault:"<b>#</b>;",contentFA:'<i class="fusiona-link-solid"></i>',hasForm:!0,tagNames:["a"],init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this._handleInputChange=_.debounce(_.bind(this.handleInputChange,this),500)},handleClick:function(e){return e.preventDefault(),e.stopPropagation(),this.isDisplayed()||this.showForm(),!1},getExistingValues:function(){var e={href:"",target:""},t=MediumEditor.selection.getSelectionRange(this.document),i=!1;return"a"===t.startContainer.nodeName.toLowerCase()?i=t.startContainer:"a"===t.endContainer.nodeName.toLowerCase()?i=t.endContainer:MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(t),"a")&&(i=MediumEditor.util.getClosestTag(MediumEditor.selection.getSelectedParentElement(t),"a")),i&&(e.href=i.getAttribute("href"),e.target=i.getAttribute("target")),this.href=e.href,e},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return this.getForm().classList.contains("visible")},hideForm:function(){var e=this,t=this.getForm(),i=50;this.base.getExtensionByName("toolbar").toolbar.classList.contains("medium-toolbar-arrow-over")&&(i=300),t.classList.add("hidden"),t.classList.remove("visible"),setTimeout(function(){t.classList.remove("hidden")},400),this.getHrefInput().value="",this.getTargetInput().value="",this.getTargetInput().checked=!1,setTimeout(function(){e.setToolbarPosition(),e.base.checkSelection()},i)},getHrefInput:function(){return this.getForm().querySelector("#fusion-anchor-href")},getTargetInput:function(){return this.getForm().querySelector(".switch-input")},showForm:function(e){var t=this.getForm();this.base.saveSelection(),this.hideToolbarDefaultActions(),t.classList.add("visible"),t.classList.remove("hidden"),this.setExistingValues(),this.setToolbarPosition()},doFormSave:function(){this.hideForm()},setExistingValues:function(){var e=this.getExistingValues();this.getHrefInput().value=e.href,this.getTargetInput().value=e.target,"_blank"===e.target&&(this.getTargetInput().checked=!0),this.setClearVisibility()},setClearVisibility:function(){var e=this.getForm();this.href&&""!==this.href?e.classList.add("has-link"):e.classList.remove("has-link")},createForm:function(){var e=this,t=this.document,i=t.createElement("div"),n=t.createElement("input"),o=t.createElement("span"),s=t.createElement("button"),a=t.createElement("button"),r=t.createElement("label"),l=t.createElement("div"),u=t.createElement("label"),d=t.createElement("input"),c=t.createElement("span"),p=t.createElement("span"),f=t.createElement("span"),h=t.createElement("span");return i.className="medium-editor-toolbar-form fusion-inline-anchor fusion-link-selector",i.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),n.className="medium-editor-toolbar-input fusion-builder-link-field",n.id="fusion-anchor-href",n.type="text",n.placeholder=fusionBuilderText.select_link,i.appendChild(n),o.className="fusion-inline-anchor-search button-link-selector fusion-builder-link-button fusiona-search",i.appendChild(o),s.className="button button-small wp-picker-clear",s.innerHTML='<i class="fusiona-eraser-solid"></i>',i.appendChild(s),r.className="switch",r.setAttribute("for","fusion-anchor-target-"+this.getEditorId()),l.className="fusion-inline-target",u.innerHTML=fusionBuilderText.open_in_new_tab,l.appendChild(u),d.className="switch-input screen-reader-text",d.name="fusion-anchor-target",d.id="fusion-anchor-target-"+this.getEditorId(),d.type="checkbox",d.value="0",c.className="switch-label",c.setAttribute("data-on",fusionBuilderText.on),c.setAttribute("data-off",fusionBuilderText.off),p.className="switch-handle",f.className="label-helper-calc-on fusion-anchor-target",f.innerHTML=fusionBuilderText.on,h.className="label-helper-calc-off fusion-anchor-target",h.innerHTML=fusionBuilderText.off,r.appendChild(d),r.appendChild(c),r.appendChild(p),r.appendChild(f),r.appendChild(h),l.appendChild(r),i.appendChild(l),a.className="fusion-inline-editor-close",a.innerHTML='<i class="fusiona-check"></i>',i.appendChild(a),this.on(n,"change",this.handleInputChange.bind(this),!0),this.on(n,"blur",this.handleInputChange.bind(this),!0),this.on(n,"keyup",this._handleInputChange.bind(this),!0),this.on(d,"change",this._handleInputChange.bind(this),!0),this.on(a,"click",this.handleSaveClick.bind(this),!0),this.on(i,"click",this.handleFormClick.bind(this)),this.on(s,"click",this.clearLink.bind(this)),setTimeout(function(){e.optionSwitch(jQuery(i)),e.optionLinkSelector(jQuery(i).parent())},300),i},clearLink:function(e){var t=this.getHrefInput();e.preventDefault(),t.value="",t.dispatchEvent(new Event("change"))},getFormOpts:function(){var e=this.getTargetInput(),t=this.getHrefInput(),i={value:t.value.trim(),target:"_self",skipCheck:!0};return this.href=t.value.trim(),e&&e.checked&&(i.target="_blank"),i},handleInputChange:function(e){var t=this.getFormOpts();this.base.restoreSelection(),""===t.value?this.execAction("unlink",t):this.execAction(this.action,t),this.setClearVisibility()},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()}});_.extend(t.prototype,FusionPageBuilder.options.fusionSwitchField),_.extend(t.prototype,FusionPageBuilder.options.fusionLinkSelector),MediumEditor.extensions.fusionAnchor=t},createRemove:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionRemoveFormat",action:"fusionRemoveFormat",aria:fusionBuilderText.remove_format,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-undo"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){var t=MediumEditor.selection.getSelectedElements(this.document),i=MediumEditor.selection.getSelectionRange(this.document),n=MediumEditor.selection.getSelectedParentElement(i);return e.preventDefault(),e.stopPropagation(),!t.length&&n&&(t=[n]),t.forEach(function(e){e.removeAttribute("data-fusion-font"),e.removeAttribute("data-fusion-google-font"),e.removeAttribute("data-fusion-google-variant"),e.removeAttribute("data-fusion-google-subset"),e.style["line-height"]="",e.style["font-size"]="",e.style["font-family"]="",e.style["letter-spacing"]="",""===e.getAttribute("style")&&e.removeAttribute("style"),0===e.classList.length&&e.removeAttribute("class")}),this.execAction("removeFormat",{skipCheck:!0}),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionRemoveFormat=t},createIndent:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionIndent",action:"fusionIndent",aria:fusionBuilderText.indent,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-indent"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"p",tagNames:["blockquote","p","h1","h2","h3","h4","h5","h6"],normalize:!0})},handleClick:function(e){var t,i=MediumEditor.selection.getSelectionElement(this.document),n=document.getElementById("fb-preview"),o=rangy.dom.getIframeWindow(n);return e.preventDefault(),e.stopPropagation(),this.classApplier.applyToSelection(o),i.querySelectorAll(".fusion-editing").forEach(function(e){e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),t=40*Math.round(parseInt(jQuery(e).css("padding-left"))/40)+40,jQuery(e).css({"padding-left":t})}),this.base.saveSelection(),this.base.trigger("editableInput",{},i),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionIndent=t},createOutdent:function(e){var t=MediumEditor.extensions.form.extend({name:"fusionOutdent",action:"fusionOutdent",aria:fusionBuilderText.outdent,contentDefault:"&#xB1;",contentFA:'<i class="fusiona-outdent"></i>',hasForm:!1,init:function(){MediumEditor.extensions.form.prototype.init.apply(this,arguments),this.classApplier=rangy.createClassApplier("fusion-editing",{elementTagName:"p",tagNames:["blockquote","p","h1","h2","h3","h4","h5","h6"],normalize:!0})},handleClick:function(e){var t,i=MediumEditor.selection.getSelectionElement(this.document),n=document.getElementById("fb-preview"),o=rangy.dom.getIframeWindow(n);return e.preventDefault(),e.stopPropagation(),this.classApplier.applyToSelection(o),i.querySelectorAll(".fusion-editing").forEach(function(e){e.classList.remove("fusion-editing"),0===e.classList.length&&e.removeAttribute("class"),t=40*Math.round(parseInt(jQuery(e).css("padding-left"))/40)-40,jQuery(e).css({"padding-left":t})}),this.base.saveSelection(),this.base.trigger("editableInput",{},i),this.base.checkSelection(),!1}});MediumEditor.extensions.fusionOutdent=t}});var FusionDelay,FusionApp;FusionPageBuilder=FusionPageBuilder||{};function FASElement(e,t){var i=this;this.$el=jQuery(e),this.parentScope=t,this.repeaterId=this.$el.data("repeater-id"),this.fieldId=this.$el.data("field-id"),this.ajaxCall=this.$el.data("ajax"),this.maxInput=this.$el.data("max-input"),this.prefix=this.repeaterId+this.fieldId,this.initialValues=[],this.values={},this.searchResults=[],this.ajaxInProcess=!1,this.options=[],this.ajaxParams=[],this.init(),this.search=_.bind(this.search,this),this.select=_.bind(this.select,this),this.removeTag=_.bind(this.removeTag,this),this.addNew=_.bind(this.addNew,this),this.saveNew=_.bind(this.saveNew,this),this.cancelAddNew=_.bind(this.cancelAddNew,this),this.verifyInput=_.bind(this.verifyInput,this),this.hideDropdown=_.bind(this.hideDropdown,this),this.renderOptions=_.bind(this.renderOptions,this),this.$el.on("input keyup paste",".fusion-ajax-select-search input",_.debounce(this.search,300)),this.$el.on("click",".fusion-select-label",_.debounce(this.select,300)),this.$el.on("click",".fusion-option-remove",this.removeTag),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-addnew",this.addNew),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-cancel",this.cancelAddNew),this.$el.closest("li.fusion-builder-option").on("click",".fusion-multiselect-save",this.saveNew),this.$el.closest("li.fusion-builder-option").on("keypress",".fusion-multiselect-input",this.verifyInput),jQuery(document).mouseup(function(e){i.$el.is(e.target)||0!==i.$el.has(e.target).length||i.hideDropdown()})}jQuery,FusionPageBuilder.InlineEditorManager=Backbone.Model.extend({defaults:{editorCount:0,editors:{}},initialize:function(){this.buttons={simple:["bold","italic","underline","strikethrough","fusionRemoveFormat"],full:["fusionTypography","fusionFontColor","bold","italic","underline","fusionAnchor","fusionAlign","strikethrough","quote","unorderedlist","orderedlist","fusionIndent","fusionOutdent","fusionRemoveFormat","fusionExtended"]},this.shortcodeAdded=!1,this._logChangeEvent=_.debounce(_.bind(this.logChangeEvent,this),500)},addEditorInstance:function(e,t,i){var n,o=this,s=o.get("editors"),a=o.get("editorCount"),r=jQuery("#fb-preview")[0],l=t.model.get("params"),u=t.model.get("cid"),d=void 0!==e.data("toolbar")?e.data("toolbar"):"full",c=void 0===fusionAllElements[t.model.get("element_type")]||void 0===fusionAllElements[t.model.get("element_type")].inline_editor_shortcodes||fusionAllElements[t.model.get("element_type")].inline_editor_shortcodes,p=jQuery.extend(!0,{},this.buttons),f=void 0!==p[d]?p[d]:p.full,h=!1;i=i||!1,!c||"full"!==d&&!0!==d||f.push("fusionInlineShortcode"),!1!==d&&(d={buttons:f}),e.attr("data-dynamic-content-overriding")&&(h=!0,d=!1),s[++a]=new MediumEditor(e,{anchorPreview:!1,buttonLabels:"fontawesome",extensions:{fusionTypography:new MediumEditor.extensions.fusionTypography,fusionFontColor:new MediumEditor.extensions.fusionFontColor,fusionExtended:new MediumEditor.extensions.fusionExtended,fusionInlineShortcode:new MediumEditor.extensions.fusionInlineShortcode,fusionAlign:new MediumEditor.extensions.fusionAlign,fusionAnchor:new MediumEditor.extensions.fusionAnchor,fusionRemoveFormat:new MediumEditor.extensions.fusionRemoveFormat,fusionIndent:new MediumEditor.extensions.fusionIndent,fusionOutdent:new MediumEditor.extensions.fusionOutdent,imageDragging:{}},placeholder:{text:"Your Content Goes Here"},contentWindow:r.contentWindow,ownerDocument:r.contentWindow.document,elementsContainer:r.contentWindow.document.body,toolbar:d,disableEditing:h}),s[a].subscribe("blur",function(){jQuery("#fb-preview")[0].contentWindow.jQuery("body").trigger("fusion-live-editor-updated"),"undefined"==typeof FusionPageBuilderApp||FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")}),s[a].subscribe("editableInput",function(e,i){var n=o.getEditor(a).getContent(),s=jQuery(i).data("param"),r=void 0!==jQuery(i).attr("data-encoding")&&jQuery(i).attr("data-encoding"),d=n.indexOf("data-inline-shortcode"),c=l[s];n=n.replace(/&quot;/g,"'").replace(/&nbsp;/g," "),n=FusionPageBuilderApp.htmlToShortcode(n,u),r&&(n=FusionPageBuilderApp.base64Encode(n)),l[s]=n,t.model.unset("added"),t.model.set("params",l),"function"==typeof t.forceUpdateParent&&t.forceUpdateParent(),FusionEvents.trigger("fusion-inline-edited"),-1!==d&&t.render(),o.initialValue||(o.initialValue=c),o._logChangeEvent(s,n,t)}),"undefined"!=typeof FusionPageBuilderApp&&(this.uiHideListener(e),s[a].subscribe("focus",function(){FusionPageBuilderApp.$el.addClass("fusion-builder-no-ui")})),i&&s[a].selectElement(e[0]),(n=t.model.get("inlineEditors")).push(a),t.model.set("inlineEditors",n),this.set({editorCount:a}),this.set({editors:s})},logChangeEvent:function(e,t,i){var n={type:"param",param:e,newValue:t,cid:i.model.get("cid")},o=fusionAllElements[i.model.get("element_type")],s="object"==typeof o.params[e]?o.params[e].heading:e;FusionEvents.trigger("fusion-param-changed-"+i.model.get("cid"),e,t),n.oldValue=this.initialValue,this.initialValue=!1,fusionGlobalManager.handleMultiGlobal({currentModel:i.model,handleType:"save",attributes:i.model.attributes}),FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.edited+" "+o.name+" - "+s,n)},uiHideListener:function(e){e.hover(function(){jQuery(this).attr("data-medium-focused")?FusionPageBuilderApp.$el.addClass("fusion-builder-no-ui"):FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")},function(){FusionPageBuilderApp.$el.hasClass("fusion-dialog-ui-active")||FusionPageBuilderApp.$el.removeClass("fusion-builder-no-ui")})},getEditor:function(e){return this.get("editors")[e]},reInitEditor:function(e,t){var i,n=this.get("editors");void 0!==n[e]&&((i=n[e]).addElements([t]),i.setup(),i.selectElement(t))},destroyEditor:function(e){var t=this.get("editors");void 0!==t[e]&&(t[e].destroy(),delete t[e]),this.set({editors:t})}}),(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionCheckboxButtonSet={optionCheckboxButtonSet:function(e){var t,i,n,o;(t=(e=e||this.$el).find(".fusion-form-checkbox-button-set")).length&&((i=e.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(n=i.find(".button-set-value").val())&&""!==n||i.find("a").addClass("ui-state-active"),"yes"===n&&i.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),t.find("a").on("click",function(e){e.preventDefault(),o=jQuery(this).closest(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),o.find(".button-set-value").val(o.find(".ui-state-active").map(function(e,t){return jQuery(t).data("value")}).get()).trigger("change")}))}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionCodeBlock={optionCodeBlock:function(e){var t,i,n,o,s,a=this;t=(e=e||this.$el).find(".fusion-builder-code-block"),a.codeEditorOption={},t.length&&t.each(function(t){i=jQuery(this).attr("id"),n=e.find("#"+i),o=jQuery(this).data("language"),void 0!==(s=e.find("."+i).val())&&((s=jQuery.parseJSON(s)).lineNumbers=!0,s.lineWrapping=!0),void 0!==o&&"default"!==o&&(s.mode="text/"+o),jQuery(this).closest(" .fusion-builder-option").attr("data-index",t),a.codeEditorOption[t]=wp.CodeMirror.fromTextArea(n[0],s),a.codeEditorOption[t].on("renderLine",function(e,i,n){var o=wp.CodeMirror.countColumn(i.text,null,e.getOption("tabSize"))*a.codeEditorOption[t].defaultCharWidth();n.style.textIndent="-"+o+"px",n.style.paddingLeft=4+o+"px"}),a.codeEditorOption[t].refresh(),setTimeout(function(){a.codeEditorOption[t].refresh(),a.codeEditorOption[t].focus()},100)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColorPalette={optionColorPalette:function(e){var t=this;(e=e||this.$el).find(".fusion-color-palette-options").each(function(){var e=jQuery(this);e.find(".fusion-color-palette-item").on("click",function(i){i.preventDefault(),0<e.find(".fusion-color-palette-item.color-palette-active").length||t.showColorPicker(jQuery(this))}),e.find(".fusion-colorpicker-icon").on("click",function(i){i.preventDefault(),t.hideColorPicker(e.find(".fusion-color-palette-item.color-palette-active"))})})},showColorPicker:function(e){var t=e.closest(".fusion-color-palette-options").find(".fusion-palette-colorpicker-container");e.addClass("color-palette-active"),t.find(".fusion-builder-color-picker-hex").val(e.data("value")).trigger("change"),setTimeout(function(){t.find(".wp-color-result").trigger("click"),t.css("display","block")},10)},hideColorPicker:function(e){var t=e.closest(".fusion-color-palette-options").find(".fusion-palette-colorpicker-container");e.data("value",t.find(".fusion-builder-color-picker-hex").val()),e.children("span").css("background-color",t.find(".fusion-builder-color-picker-hex").val()),e.removeClass("color-palette-active"),t.css("display","none"),this.updateColorPalette(e)},updateColorPalette:function(e){var t=e.closest(".fusion-color-palette-options").find(".fusion-color-palette-item"),i=[],n=e.closest(".fusion-color-palette-options").find(".color-palette-colors"),o=jQuery(".fusion-builder-option.color-alpha, .fusion-builder-option.colorpickeralpha");t.each(function(){i.push(jQuery(this).data("value"))}),setTimeout(function(){n.val(i.join("|")).trigger("change"),0<o.length&&jQuery.each(o,function(){jQuery.each(jQuery(this).find(".iris-palette"),function(e,t){2>e||jQuery(t).data("color",i[e-2]).css("background-color",i[e-2])})})},50)}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionColorPicker={optionColorpicker:function(e){var t,i=this;(t=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-color-picker-hex")).length&&t.each(function(){var e=jQuery(this),t=e.closest(".fusion-builder-option").find(".fusion-builder-default-reset"),n=void 0!==i.parentValues&&void 0!==i.parentValues[e.attr("id")]&&i.parentValues[e.attr("id")];setTimeout(function(){e.data("default")&&e.data("default").length?(e.wpColorPicker({create:function(){jQuery(e).addClass("fusion-color-created"),i.updatePickerIconColor(e.val(),e)},change:function(o,s){i.colorChange(s.color.toString(),e,t,n),i.updatePickerIconColor(s.color.toString(),e)},clear:function(t){i.colorClear(t,e,n)}}),t.on("click","a",function(t){t.preventDefault(),i.colorClear(t,e,n)})):e.wpColorPicker({create:function(){jQuery(e).addClass("fusion-color-created"),i.updatePickerIconColor(e.val(),e)},change:function(t,n){i.colorChanged(n.color.toString(),e),i.updatePickerIconColor(n.color.toString(),e)},clear:function(){e.val("").trigger("fusion-change"),e.closest(".fusion-colorpicker-container").find(".color-picker-placeholder").val("")}}),!0!==e.data("alpha")&&e.wpColorPicker().change(),e.closest(".fusion-colorpicker-container").find(".color-picker-placeholder").on("change",function(){var e=jQuery(this);setTimeout(function(){var t=e.val();t||e.closest(".fusion-colorpicker-container").find(".wp-color-picker").val(t).attr("value",t).trigger("change")},10)}),e.on("blur",function(){jQuery(this).hasClass("iris-error")&&(jQuery(this).removeClass("iris-error"),jQuery(this).val(""))})},10)})},colorChange:function(e,t,i,n){var o=n||t.data("default"),s=t.closest(".fusion-colorpicker-container").find(".color-picker-placeholder");if(""===e)return t.addClass("fusion-using-default"),s.addClass("fusion-color-picker-placeholder-using-default"),t.val(o).change(),void t.val("");e===o&&"TO"!==t.attr("data-location")&&"PO"!==t.attr("data-location")&&"FBE"!==t.attr("data-location")?(setTimeout(function(){t.val("").change()},10),i.addClass("checked"),i.parent().find("> a").html(o)):(t.removeClass("fusion-using-default"),s.removeClass("fusion-color-picker-placeholder-using-default"),i.removeClass("checked"),t.val(e).change()),setTimeout(function(){t.closest(".wp-picker-container").find(".wp-color-result").css({backgroundImage:"",backgroundColor:e})},100)},colorChanged:function(e,t){t.val(e),t.change()},updatePickerIconColor:function(e,t){var i=jQuery.Color(e),n=parseInt(100*i.lightness(),10);.3<i.alpha()&&70>n?t.closest(".fusion-colorpicker-container").find(".fusion-colorpicker-icon").css("color","#fff"):t.closest(".fusion-colorpicker-container").find(".fusion-colorpicker-icon").removeAttr("style")},colorClear:function(e,t,i){var n=i||t.data("default"),o=t.closest(".fusion-colorpicker-container").find(".color-picker-placeholder");o.val(""),t.hasClass("fusion-default-changed")||!t.hasClass("fusion-using-default")?null===n||"TO"===t.closest(".fusion-builder-option").data("type")&&"FBE"===t.closest(".fusion-builder-option").data("type")?null===n||"TO"!==t.closest(".fusion-builder-option").data("type")&&"FBE"!==t.closest(".fusion-builder-option").data("type")||(t.val(n).change(),t.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)):(t.addClass("fusion-using-default"),o.addClass("fusion-color-picker-placeholder-using-default"),t.removeClass("fusion-default-changed"),t.val(n).change(),t.val(""),t.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)):t.closest(".wp-picker-container").find(".wp-color-result").css("background-color",n)}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDateTimePicker={optionDateTimePicker:function(e){var t,i;t=(e=e||this.$el).find(".fusion-datetime-datepicker"),i=e.find(".fusion-datetime-timepicker"),t.length&&jQuery(t).fusiondatetimepicker({format:"yyyy-MM-dd",pickTime:!1}),i.length&&jQuery(i).fusiondatetimepicker({format:"hh:mm:ss",pickDate:!1}),jQuery(t).on("updateDateTime",function(){var e,t;e=jQuery(this).closest(".fusion-datetime-container").find(".fusion-time-picker").val(),t=jQuery(this).find(".fusion-date-picker").val()+" "+e,jQuery(this).closest(".option-field").find(".fusion-date-time-picker").val(t).trigger("change")}),jQuery(i).on("updateDateTime",function(){var e;e=jQuery(this).closest(".fusion-datetime-container").find(".fusion-date-picker").val()+" "+jQuery(this).find(".fusion-time-picker").val(),jQuery(this).closest(".option-field").find(".fusion-date-time-picker").val(e).trigger("change")})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDimensionField={optionDimension:function(e){var t;(t=(e=e||this.$el).find(".single-builder-dimension")).length&&t.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).closest(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).closest(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(1) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(2) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(3) input").val():"0")+" "+(jQuery(this).closest(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).closest(".single-builder-dimension").find("div:nth-child(4) input").val():"0")).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionEditor={optionEditor:function(e){var t,i,n,o,s=!1,a=this.model,r="";n=(e=e||this.$el).find(".fusion-editor-field"),void 0!==a.get("allow_generator")&&!0===a.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0,s=!0),n.length&&n.each(function(){var e=jQuery(this);if(t=e.closest(".fusion-builder-option"),r=e.html(),void 0!==a.get("multi")&&"multi_element_parent"===a.get("multi"))return t.hide(),void e.attr("id","fusion_builder_content_main");void 0!==a.get("multi")&&"multi_element_child"===a.get("multi")&&"fusion_pricing_column"!==a.get("element_type")&&e.attr("id","child_element_content"),e.addClass("fusion-init"),"generated_element"===a.get("type")?("multi_element_child"===a.get("multi")?e.attr("id","generator_multi_child_content"):e.attr("id","generator_element_content"),i=e.attr("id"),setTimeout(function(){e.wp_editor(r,i),jQuery("#"+i).data("placeholder")&&window.tinyMCE.get(i).on("focus",function(){o=window.tinyMCE.get(i).getContent(),(o=jQuery("<div/>").html(o).text())===jQuery("#"+i).data("placeholder")&&window.tinyMCE.get(i).setContent("")}),window.tinyMCE.get(i).on("keyup change",function(){var e=window.tinyMCE.get(i);o=e.getContent(),jQuery("#"+i).val(o).trigger("change")})},100)):(i=e.attr("id"),setTimeout(function(){e.wp_editor(r,i,s),jQuery("#"+i).data("placeholder")&&window.tinyMCE.get(i).on("focus",function(){o=window.tinyMCE.get(i).getContent(),(o=jQuery("<div/>").html(o).text())===jQuery("#"+i).data("placeholder")&&window.tinyMCE.get(i).setContent("")}),window.tinyMCE.get(i)&&window.tinyMCE.get(i).on("keyup change",function(){var e=window.tinyMCE.get(i);o=e.getContent(),jQuery("#"+i).val(o).trigger("change")})},100))})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionExport={optionExport:function(e){var t,i,n,o,s,a=this;e=void 0!==e&&e.length?e:this.$el,(t=e.find(".fusion-builder-option.export")).length&&(i=t.find("#fusion-export-mode"),n=t.find("#fusion-export-file"),o=t.find("#fusion-export-copy"),s=t.find("#fusion-page-options-save"),i.on("change",function(e){e.preventDefault(),t.find(".fusion-export-options > div").hide(),t.find('.fusion-export-options > div[data-id="'+jQuery(e.target).val()+'"]').show()}),o.on("click",function(e){e.preventDefault(),jQuery(e.target).prev("textarea")[0].select(),document.execCommand("copy")}),n.on("click",function(e){e.preventDefault(),a.exportOptions(e)}),s.on("click",function(e){e&&e.preventDefault(),""!==jQuery("#fusion-new-page-options-name").val()&&(t.addClass("partial-refresh-active"),a.ajaxPOSave(t))}))},updateExportCode:function(){var e=this.$el.find(".fusion-builder-option.export #export-code-value"),t="TO"===e.attr("data-context")?JSON.stringify(FusionApp.settings):JSON.stringify(this.getFusionMeta());e.val(t)},exportOptions:function(e){var t,i,n,o=jQuery(e.target).attr("data-context"),s=new Date,a=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate(),r="fusion-theme-options-"+a;"TO"===o||"FBE"===o?((n=FusionApp.settings).fusionredux_import_export="",n["fusionredux-backup"]=1):(n=this.getFusionMeta(),r="avada-page-options-"+a),t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n)),(i=document.createElement("a")).setAttribute("href",t),i.setAttribute("download",r+".json"),i.click(),i.remove()},ajaxPOSave:function(e){var t={action:"fusion_page_options_save",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),post_id:FusionApp.data.postDetails.post_id,custom_fields:this.getFusionMeta(),options_title:jQuery("#fusion-new-page-options-name").val()};jQuery.get({url:fusionAppConfig.ajaxurl,data:t,dataType:"json",success:function(t){jQuery(".fusion-select-options").append('<label class="fusion-select-label" data-value="'+t.saved_po_dataset_id+'">'+t.saved_po_dataset_title+"</label>"),jQuery("#fusion-new-page-options-name").val(""),e.removeClass("partial-refresh-active"),FusionApp.data.savedPageOptions[t.saved_po_dataset_id]={id:t.saved_po_dataset_id,title:t.saved_po_dataset_title,data:t.saved_po_data}},error:function(){e.removeClass("partial-refresh-active")}})},getFusionMeta:function(){return{_fusion:FusionApp.data.postMeta._fusion}},setFusionMeta:function(e){jQuery.each(e,function(e,t){FusionApp.data.postMeta[e]=t})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionDelay=function(){var e=0;return function(t,i){clearTimeout(e),e=setTimeout(t,i)}}(),FusionPageBuilder.options.fusionIconPicker={optionIconpicker:function(e){var t;(t=(e=e||this.$el).find(".fusion-iconpicker")).length&&t.each(function(){var e,t=jQuery(this).find(".fusion-iconpicker-input"),i=t.val(),n=jQuery(this).find(".icon_select_container"),o=n.parent(),s=jQuery(this).find(".fusion-icon-search"),a=jQuery(".fusion-icons-rendered").html(),r=jQuery(".fusion-icon-picker-nav-rendered").html(),l="",u=-1!==i.indexOf("fusion-prefix-");n.append(a).before('<div class="fusion-icon-picker-nav-wrapper"><a href="#" class="fusion-icon-picker-nav-left fusiona-arrow-left"></a><div class="fusion-icon-picker-nav">'+r+'</div><a href="#" class="fusion-icon-picker-nav-right fusiona-arrow-right"></a></div>'),""!==i&&-1===i.indexOf(" ")&&(i=FusionApp.checkLegacyAndCustomIcons(i),u||setTimeout(function(){t.attr("value",i).trigger("change")},1e3)),o.find(".fusion-icon-picker-nav > .fusion-icon-picker-nav-item").on("click",function(e){e.preventDefault(),jQuery(".fusion-icon-picker-nav-active").removeClass("fusion-icon-picker-nav-active"),jQuery(this).addClass("fusion-icon-picker-nav-active"),n.find(".fusion-icon-set").css("display","none"),n.find(jQuery(this).attr("href")).css("display","grid")}),o.find(".fusion-icon-picker-nav-wrapper > .fusion-icon-picker-nav-right").on("click",function(e){e.preventDefault(),o.find(".fusion-icon-picker-nav").animate({scrollLeft:"+=100"},250)}),o.find(".fusion-icon-picker-nav-wrapper > .fusion-icon-picker-nav-left").on("click",function(e){e.preventDefault(),o.find(".fusion-icon-picker-nav").animate({scrollLeft:"-=100"},250)}),i&&""!==i&&(2===(e=i.split(" ")).length?n.find("."+e[0]+"."+e[1]).parent().addClass("selected-element"):1===e.length&&n.find("."+e).parent().addClass("selected-element"),l=n.find(".selected-element").closest(".fusion-icon-set").prepend(n.find(".selected-element")).attr("id"),o.find('.fusion-icon-picker-nav a[href="#'+l+'"]').trigger("click")),n.find(".icon_preview").on("click",function(e){var t=jQuery(this).find("i"),i="fas",n=jQuery(this).closest(".fusion-iconpicker"),o="fa-"+t.attr("data-name"),s="";t.hasClass("fas")||t.hasClass("fab")||t.hasClass("far")||t.hasClass("fal")?t.hasClass("fab")?i="fab":t.hasClass("far")?i="far":t.hasClass("fal")&&(i="fal"):s="fusion-prefix-"+t.attr("class"),""===s&&(s=o+" "+i),jQuery(this).hasClass("selected-element")?(jQuery(this).removeClass("selected-element"),n.find("input.fusion-iconpicker-input").attr("value","").trigger("change"),n.find(".fusion-iconpicker-icon > span").attr("class","")):(n.find(".selected-element").removeClass("selected-element"),jQuery(e.currentTarget).addClass("selected-element"),n.find("input.fusion-iconpicker-input").attr("value",s).trigger("change"),n.find(".fusion-iconpicker-icon > span").attr("class",s))}),s.on("change paste keyup",function(){var e=jQuery(this);FusionDelay(function(){var t;if(e.val()&&""!==e.val()){if(3>(i=e.val().toLowerCase()).length)return;n.find(".icon_preview").css("display","none"),t=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(i),_.each(t,function(e){n.find(".icon_preview."+e.name).css("display","inline-flex")}),_.each(n.find(".fusion-icon-set"),function(e){var t=!1;e.classList.add("no-search-results"),e.querySelectorAll(".icon_preview").forEach(function(i){"none"!==i.style.display&&e.classList.contains("no-search-results")&&(t=!0)}),t||e.querySelector(".no-search-results-notice")?t&&e.classList.remove("no-search-results"):jQuery(e).append('<div class="no-search-results-notice">'+fusionBuilderText.no_results_in.replace("%s",jQuery('a[href="#'+e.id+'"]').html())+"</div>")})}else n.find(".icon_preview").css("display","inline-flex"),_.each(n.find(".fusion-icon-set"),function(e){e.classList.remove("no-search-results")})},100)})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionImportUpload={optionImport:function(e){var t,i,n,o,s,a,r,l,u,d=this;e=void 0!==e&&e.length?e:this.$el,(t=e.find(".fusion-builder-option.import")).length&&(i=t.find("#fusion-import-mode"),n=t.find("#import-code-value"),o=t.find("#fusion-demo-import"),s=t.find("#fusion-page-options-import"),a=t.find(".fusion-import-file-input"),l=t.find(".fusion-builder-import-button"),u=t.find(".fusion-builder-delete-button"),r=l.attr("data-context"),i.on("change",function(e){e.preventDefault(),t.find(".fusion-import-options > div").hide(),t.find('.fusion-import-options > div[data-id="'+jQuery(e.target).val()+'"]').show(),u.hide(),"saved-page-options"===jQuery(e.target).val()&&u.show()}),l.on("click",function(e){var l=i.val();e&&e.preventDefault(),"paste"===l?(t.addClass("partial-refresh-active"),d.importCode(n.val(),r,t)):"demo"===l?(t.addClass("partial-refresh-active"),d.ajaxUrlImport(o.val(),t)):"saved-page-options"===l?(t.addClass("partial-refresh-active"),d.ajaxPOImport(s.val(),t)):a.trigger("click")}),u.on("click",function(e){e&&e.preventDefault(),""!==s.val()&&(t.addClass("partial-refresh-active"),d.ajaxPODelete(s.val(),t))}),a.on("change",function(e){d.prepareUpload(e,r,d)}))},colorSchemeImport:function(e,t){var i,n=!!t.length&&t.attr("data-option-id");"object"==typeof this.options[n]&&"object"==typeof this.options[n].choices[e.attr("data-value")]&&(t.addClass("partial-refresh-active"),i=jQuery.extend(!0,{},FusionApp.settings,this.options[n].choices[e.attr("data-value")].settings),this.importCode(i,"TO",t,!0,this.options[n].choices[e.attr("data-value")].settings))},importCode:function(e,t,i,n,o){var s=e;t=void 0===t?"TO":t,n=void 0!==n&&n,o=void 0!==o&&o,e&&""!==e?(n||(s=JSON.parse(s)),"TO"===t?(FusionApp.settings=s,FusionApp.storedToCSS={},FusionApp.contentChange("global","theme-option"),FusionEvents.trigger("fusion-to-changed"),FusionApp.sidebarView.clearInactiveTabs("to"),this.updateValues(o)):(FusionPageBuilder.options.fusionExport.setFusionMeta(s),FusionApp.storedPoCSS={},FusionApp.contentChange("page","page-option"),FusionEvents.trigger("fusion-po-changed"),FusionApp.sidebarView.clearInactiveTabs("po")),i.removeClass("partial-refresh-active"),FusionApp.fullRefresh()):i.removeClass("partial-refresh-active")},ajaxUrlImport:function(e,t){var i=this;jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,dataType:"JSON",data:{action:"fusion_panel_import",fusion_load_nonce:fusionAppConfig.fusion_load_nonce,toUrl:e},success:function(e){i.importCode(e,"TO",t)},error:function(){t.removeClass("partial-refresh-active")}})},ajaxPOImport:function(e,t){var i=this,n={action:"fusion_page_options_import_saved",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),post_id:FusionApp.data.postDetails.post_id,saved_po_dataset_id:e};jQuery.get({url:fusionAppConfig.ajaxurl,data:n,dataType:"json",success:function(e){i.importCode(JSON.stringify(e.custom_fields),"PO",t)},error:function(){t.removeClass("partial-refresh-active")}})},ajaxPODelete:function(e,t){var i={action:"fusion_page_options_delete",fusion_po_nonce:jQuery("#fusion-page-options-nonce").val(),saved_po_dataset_id:e};jQuery.get({url:fusionAppConfig.ajaxurl,data:i,success:function(){t.find('.fusion-select-label[data-value="'+e+'"]').closest(".fusion-select-label").remove(),t.find(".fusion-select-preview").html(""),t.removeClass("partial-refresh-active"),jQuery.each(FusionApp.data.savedPageOptions,function(t,i){if(e===i.id)return delete FusionApp.data.savedPageOptions[t],!1})},error:function(){t.removeClass("partial-refresh-active")}})},updateValues:function(e){var t=this,i=void 0===e?FusionApp.settings:e;_.each(i,function(e,i){t.updateValue(i,e)})},updateValue:function(e,t){"primary_color"===e&&this.$el.find('input[name="primary_color"]').length&&(this.$el.find('input[name="primary_color"]').val(t),this.$el.find('[data-option-id="primary_color"] .wp-color-result').css({backgroundColor:t})),FusionApp.createMapObjects(),this.updateSettingsToParams(e,t,!0),this.updateSettingsToExtras(e,t,!0),this.updateSettingsToPo(e,t)},prepareUpload:function(e,t,i){var n=e.target.files,o=new FormData,s=jQuery(e.target).closest(".fusion-builder-option.import"),a=!1;if(s.addClass("partial-refresh-active"),o.append("action","fusion_panel_import"),o.append("fusion_load_nonce",fusionAppConfig.fusion_load_nonce),jQuery.each(n,function(e,t){"json"!==t.name.substr(t.name.lastIndexOf(".")+1)?a=!0:o.append("po_file_upload",t)}),a)return FusionApp.confirmationPopup({title:fusionBuilderText.import_failed,content:fusionBuilderText.import_failed_description,actions:[{label:fusionBuilderText.ok,classes:"yes",callback:function(){FusionApp.confirmationPopup({action:"hide"})}}]}),void s.removeClass("partial-refresh-active");jQuery.ajax({url:fusionAppConfig.ajaxurl,type:"POST",data:o,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(e){i.importCode(e,t,s)}})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionLinkSelectorObject={optionLinkSelectorObject:function(e){(e=e||this.$el).find(".fusion-link-selector-object").each(function(){var e,t,i,n,o,s,a,r,l,u=jQuery(this),d=jQuery(this).find(".fusion-builder-link-button"),c=jQuery(this).find(".button-link-type-toggle"),p=jQuery("#wp-link-submit"),f=jQuery(".wp-link-text-field"),h=jQuery(".link-target"),g=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),m=window.wpLinkL10n,v=jQuery(this).find(".fusion-builder-link-field").attr("id");jQuery(c).on("click",function(){u.find(".fusion-builder-link-field").removeAttr("readonly"),u.find(".fusion-builder-object-field").val("custom"),u.find(".fusion-builder-menu-item-type").text("custom"),u.find(".fusion-builder-object-id-field").val(0),u.find(".fusion-builder-link-field").removeAttr("readonly"),jQuery(this).hide()}),jQuery(d).on("click",function(u){g.insertBefore(p),s=jQuery(u.target).closest(" .fusion-link-selector-object"),e=s.find(".fusion-builder-link-field"),n=s.find(".fusion-builder-object-field"),o=s.find(".fusion-builder-object-id-field"),i=e.val(),p.hide(),f.hide(),h.hide(),g.show(),(t=!window.wpLink&&jQuery.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:m.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(u,d){u.preventDefault(),u.stopImmediatePropagation(),u.stopPropagation(),i=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),a="custom",r=0,jQuery('span[data-permalink="'+i+'"]').length&&(a=jQuery('span[data-permalink="'+i+'"]').data("object"),r=jQuery('span[data-permalink="'+i+'"]').data("id"),e.attr("readonly",!0),s.find(".button-link-type-toggle").show(),l=jQuery('span[data-permalink="'+i+'"]').closest("li").find(".item-title").text(),jQuery('[data-save-id="title"] input').val(l).trigger("change")),e.val(i).trigger("change"),n.val(a).trigger("change"),o.val(r).trigger("change"),s.find(".fusion-builder-menu-item-type").text(a),p.show(),f.show(),h.show(),d.remove(),jQuery("#wp-link-cancel").unbind("click"),t.close(),window.wpLink.textarea=""},t.open(v),jQuery("#link-options, #wplink-link-existing-content").hide(),jQuery("#wp-link-wrap").addClass("fusion-object-link-selector"),jQuery("#wp-link-url").val(i),jQuery("#search-panel li.selected").removeClass("selected"),jQuery('span[data-permalink="'+i+'"]').length&&jQuery('span[data-permalink="'+i+'"]').closest("li").addClass("selected"),jQuery(document).on("click","#fusion-link-submit",function(e){t.fusionUpdateLink(e,jQuery(this))})}),jQuery(document).on("click","#search-panel li",function(){jQuery("#search-panel li.selected").removeClass("selected"),jQuery(this).addClass("selected")}),jQuery(document).on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){p.show(),f.show(),h.show(),g.remove()})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionLinkSelector={optionLinkSelector:function(e){var t;(t=(e=e||this.$el).find(".fusion-link-selector")).length&&t.each(function(){var e,t,i,n,o=jQuery(this).find(".fusion-builder-link-button"),s=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),r=jQuery(".link-target"),l=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),u=window.wpLinkL10n,d=jQuery(this).find(".fusion-builder-link-field"),c=d.attr("id");jQuery(o).on("click",function(o){"fusion-link-submit"!==s.prev().attr("id")&&l.insertBefore(s),n=jQuery(o.target).closest(" .fusion-link-selector"),e=n.find(".fusion-builder-link-field"),i=e.val(),s.hide(),a.hide(),r.hide(),l.show(),"fusion-anchor-href"===c&&jQuery("body").append(d.clone(!0).css({display:"none"})),(t=!window.wpLink&&jQuery.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:u.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(n,o){n.preventDefault(),n.stopImmediatePropagation(),n.stopPropagation(),i=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),e.val(i).trigger("change"),-1!==c.indexOf("fusion-anchor-href")&&e.length&&e[0].dispatchEvent(new Event("change")),s.show(),a.show(),r.show(),o.remove(),jQuery("#wp-link-cancel").unbind("click"),t.close(),window.wpLink.textarea=""},t.open(c),jQuery("#wp-link-wrap").addClass("fusion-object-link-selector"),jQuery("#wp-link-url").val(i),jQuery("#search-panel li.selected").removeClass("selected"),jQuery('span[data-permalink="'+i+'"]').length&&jQuery('span[data-permalink="'+i+'"]').closest("li").addClass("selected"),jQuery(document).on("click","#fusion-link-submit",function(e){t.fusionUpdateLink(e,jQuery(this)),-1!==c.indexOf("fusion-anchor-href")&&jQuery("#"+c).length&&jQuery("#"+c).remove()})}),jQuery(document).on("click","#search-panel li",function(){jQuery("#search-panel li.selected").removeClass("selected"),jQuery(this).addClass("selected")}),jQuery(document).on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){s.show(),a.show(),r.show(),l.remove(),-1!==c.indexOf("fusion-anchor-href")&&jQuery("#"+c).length&&jQuery("#"+c).remove()})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionOptionUpload={removeImage:function(e){var t,i;e&&e.preventDefault(),t=jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-builder-upload-field"),i=jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-builder-upload-button"),t.hasClass("fusion-image-as-object")?t.val(JSON.stringify({id:"",url:"",width:"",height:"",thumbnail:""})).trigger("change"):t.val("").trigger("change"),i.closest(".fusion-upload-area").removeClass("fusion-uploaded-image"),jQuery(e.target).closest(".fusion-builder-module-settings").find("#image_id").length&&jQuery(e.target).closest(".fusion-builder-module-settings").find("#image_id").val("").trigger("change"),jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-url-only-input").length&&jQuery(e.currentTarget).closest(".fusion-builder-option-container").find(".fusion-url-only-input").val("")},optionUpload:function(e){var t,i=this;(t=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-upload-button:not(.fusion-builder-upload-button-multiple-upload):not(.fusion-builder-upload-button-upload-images)")).length&&(t.click(function(e){var t,n=jQuery(this),o={title:n.data("title"),multiple:!1,frame:"post",className:"media-frame mode-select fusion-builder-media-dialog wp-admin "+n.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0};return e&&e.preventDefault(),n.data("type")&&(o.library={type:n.data("type")}),t=wp.media(o),wp.media.frames.file_frame=wp.media(o),n.hasClass("fusion-builder-attachment-upload")&&(wp.media.model.settings.post.id=FusionPageBuilderApp.postID),t.on("open",function(){var e,i=t.state().get("selection"),o=t.state().get("library"),s=n.parents(".fusion-builder-option.upload").data("option-id"),a=n.closest(".fusion-builder-module-settings").find("#image_id").val(),r="";r=void 0!==(r=n.parents(".fusion-builder-module-settings").find("#"+s+"_id").val())?r:a,jQuery(".fusion-builder-media-dialog").addClass("hide-menu"),r||(n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-image-as-object")?(e=n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val())&&"string"==typeof e&&(e=jQuery.parseJSON(e))&&"object"==typeof e&&void 0!==e.id&&(r=e.id):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-builder-upload-field-id")&&(r=n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val())),r&&(-1!==r.indexOf("|")&&(r=r.split("|")[0]),o.comparator=function(e,t){var i=!!this.mirroring.get(e.cid),n=!!this.mirroring.get(t.cid);return!i&&n?-1:i&&!n?1:0},jQuery.isNumeric(r)&&wp.media.attachment(r).fetch({success:function(e){o.add(e?[e]:[]),i.add(e?[e]:[])}}))}),t.on("select insert",function(){var e,o,s,a,r,l,u,d=t.state(),c=n.parents(".fusion-builder-option").data("option-id");void 0===d.get("selection")?e=jQuery(t.$el).find("#embed-url-field").val():d.get("selection").map(function(t){var i=t.toJSON(),n=d.display(t).toJSON();return o=i.id,s=n.size,i.sizes&&i.sizes[n.size]&&i.sizes[n.size].url?(e=i.sizes[n.size].url,a=i.sizes[n.size].height,r=i.sizes[n.size].width):i.url&&(e=i.url,a=i.height,r=i.width),t}),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-image-as-object")?(l={id:o,url:e,width:r,height:a,thumbnail:""},n.closest(".fusion-upload-area").find(".fusion-url-only-input").length&&n.closest(".fusion-upload-area").find(".fusion-url-only-input").val(e),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(JSON.stringify(l)).trigger("change")):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").hasClass("fusion-builder-upload-field-id")?(n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").data("url",e),n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(o).trigger("change")):n.closest(".fusion-upload-area").find(".fusion-builder-upload-field").val(e).trigger("change"),u=n.closest(".fusion-builder-option").next().find("#"+c+"_id"),"element_content"===c&&(u=n.closest(".fusion-builder-option").next().find("#image_id")),u.length&&u.val(o+"|"+s).trigger("change"),i.fusionBuilderImagePreview(n)}),t.open(),!1}),t.closest(".fusion-upload-area").find(".fusion-builder-upload-field").on("input",function(){i.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),t.closest(".fusion-upload-area").find(".fusion-builder-upload-field").each(function(){i.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}))},optionMultiUpload:function(e){var t,i=this;(t=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-upload-button.fusion-builder-upload-button-multiple-upload, .fusion-builder-upload-button.fusion-builder-upload-button-upload-images")).length&&(t.click(function(e){var t,i,n,o,s=!1,a=!1,r="",l="",u="",d=[];return e&&e.preventDefault(),"fusion-multiple-upload"===(t=jQuery(this)).data("id")&&(s=!0),"fusion-multiple-images"===t.data("id")&&(a=!0,n=jQuery(t.next(".fusion-multiple-image-container"))[0],o=jQuery(t).prev(".fusion-multi-image-input")),i=wp.media({library:{type:t.data("type")},title:t.data("title"),multiple:"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog wp-admin "+t.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=i,a&&"fusion_gallery"===t.data("element")&&(l=o.val().split(","),d=[],u="",jQuery.each(l,function(e,t){""!==t&&"NaN"!==t&&((u=wp.media.attachment(t)).fetch(),d.push(u))}),wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",i.options.syncSelection=!0,i.options.state=d.length?"gallery-edit":"gallery"),i.on("open",function(){var e=i.state().get("selection"),n=i.state().get("library");a?("fusion_gallery"===t.data("element")&&"gallery-edit"===i.options.state||jQuery(".fusion-builder-media-dialog").addClass("hide-menu"),e.add(d),n.add(d)):jQuery(".fusion-builder-media-dialog").addClass("hide-menu")}),a&&"fusion_gallery"===t.data("element")&&i.on("update",function(e){var t,i="";t=e.map(function(e){var t=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?i=e.attributes.sizes.thumbnail.url:e.attributes.url&&(i=e.attributes.url),a&&(r+='<div class="fusion-multi-image" data-image-id="'+t+'">',r+='<img src="'+i+'"/>',r+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',r+="</div>"),e.id}),o.val(t),jQuery(n).html(r),jQuery(n).trigger("change"),o.trigger("change")}),i.on("select insert",function(){var e,l,u,d,c,p,f=i.state();void 0===f.get("selection")?e=jQuery(i.$el).find("#embed-url-field").val():(u=f.get("selection").map(function(e){return e.id}),a&&o.val(u),s&&(d=t.closest(".fusion-builder-main-settings").find(".fusion-builder-sortable-options, .fusion-builder-sortable-children").find("li:first-child")).length&&(!(c=FusionPageBuilderViewManager.getView(d.data("cid")))||void 0!==c.model.attributes.params.image&&""!==c.model.attributes.params.image||d.find(".fusion-builder-multi-setting-remove").trigger("click")),f.get("selection").map(function(i){var n,o,u,d,c,p,h=i.toJSON(),g=f.display(i).toJSON();return l=h.id,h.sizes&&h.sizes[g.size]&&h.sizes[g.size].url?e=h.sizes[g.size].url:h.url&&(e=h.url),a&&(r+='<div class="fusion-multi-image" data-image-id="'+l+'">',r+='<img src="'+e+'"/>',r+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',r+="</div>"),s&&(n=t.closest(".fusion-builder-module-settings").data("element"),o=t.closest(".fusion-builder-option").data("option-id"),u=fusionAllElements[n].element_child,d=fusionAllElements[n].params[o].child_params,c=void 0===fusionAllElements[n].params[o].create_children||fusionAllElements[n].params[o].create_children,p={},_.each(d,function(e,t){p[t]=fusionAllElements[u].params[t].value}),_.each(d,function(e,t){fusionAllElements[u].params[t].value=i.attributes[e]}),c&&(t.closest(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionEvents.trigger("fusion-multi-child-update-preview")),_.each(p,function(e,t){fusionAllElements[u].params[t].value=e})),i}),t.trigger("change"),s&&void 0!==(p=t.closest(".fusion-builder-module-settings").data("element-cid"))&&(FusionEvents.trigger("fusion-view-update-"+p),FusionEvents.trigger("fusion-child-changed"))),jQuery(n).html(r)}),i.open(),!1}),t.closest(".fusion-upload-area").find(".fusion-builder-upload-field").on("input",function(){i.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),t.closest(".fusion-upload-area").find(".fusion-builder-upload-field").each(function(){i.fusionBuilderImagePreview(jQuery(this).closest(".fusion-upload-area").find(".fusion-builder-upload-button"))}),jQuery(e).on("click",".fusion-multi-image-remove",function(){var e,t,i,n=jQuery(this).closest(".fusion-multiple-upload-images").find(".fusion-multi-image-input");t=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(i=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(t))&&e.splice(i,1),e=e.join(","),n.val(e).trigger("change"),jQuery(this).parent(".fusion-multi-image").remove()}))},fusionBuilderImagePreview:function(e){var t,i,n,o,s,a=e.closest(".fusion-upload-area"),r=a.find(".fusion-builder-upload-field"),l=r.siblings(".fusion-builder-upload-preview"),u=e.siblings(".upload-image-remove");if(r.length&&(null===(s=r.hasClass("fusion-image-as-object")?jQuery.parseJSON(r.val()):r.val().trim())&&(s=""),o=r.hasClass("fusion-image-as-object")&&s&&void 0!==s.url?s.url:s,"file"!==a.data("mode"))){if(o&&r.hasClass("fusion-builder-upload-field-id")){if(void 0===r.data("url"))return void(n=wp.media.attachment(o)).fetch().then(function(){o=void 0!==n.attributes.sizes.medium?n.attributes.sizes.medium.url:n.attributes.sizes.full.url,t='<img src="'+o+'" />',l.find("img").replaceWith(t),a.addClass("fusion-uploaded-image")});o=r.data("url")}if(0<=o.indexOf("<img")?t=o:(i=o.slice(2+(o.lastIndexOf(".")-1>>>0)),t='<img src="'+o+'" />',_.isEmpty(i)||jQuery.inArray(i.toLowerCase(),["gif","jpg","jpeg","png","tiff"])||(t='<img src="'+includesURL+'/images/media/default.png" class="icon" draggable="false" alt="">')),"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===o)return l.length&&(l.find("img").attr("src",""),u.remove()),void(e.closest(".fusion-builder-module-settings").find("#image_id").length&&e.closest(".fusion-builder-module-settings").find("#image_id").val("").trigger("change"));l.length||(e.after('<div class="fusion-uploaded-area fusion-builder-upload-preview"><img src="" alt=""><ul class="fusion-uploded-image-options"><li><a class="upload-image-remove" href="JavaScript:void(0);">'+fusionBuilderText.remove+'</a></li><li><a class="fusion-builder-upload-button fusion-upload-btn" href="JavaScript:void(0);" data-type="image">'+fusionBuilderText.edit+"</a></li></ul></div>"),l=r.siblings(".fusion-builder-upload-preview")),l.find("img").replaceWith(t),l.closest(".fusion-upload-area").addClass("fusion-uploaded-image")}}}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionMultiSelect={optionMultiSelect:function(e){var t;(t=(e=e||this.$el).find(".fusion-form-multiple-select:not(.fusion-select-inited)")).length&&t.each(function(){var e=jQuery(this),t=e.find(".fusion-select-preview-wrap"),i=e.find(".fusion-select-search input"),n=e.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew"),o=e.closest("li.fusion-builder-option").find(".fusion-multiselect-save"),s=e.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel"),a=e.closest("li.fusion-builder-option").find(".fusion-multiselect-input");e.addClass("fusion-select-inited"),t.on("click",function(t){var n=e.hasClass("fusion-open");t.currentTarget===this&&(t.preventDefault(),n?(e.removeClass("fusion-open"),i.length&&i.val("").blur()):(e.addClass("fusion-open"),i.length&&i.focus()))}),e.on("click",".fusion-select-label",function(i){0===e.find('.fusion-select-preview .fusion-preview-selected-value[data-value="'+jQuery(this).attr("for")+'"]').length?e.find(".fusion-select-preview").append('<span class="fusion-preview-selected-value" data-value="'+jQuery(this).attr("for")+'">'+jQuery(this).html()+'<span class="fusion-option-remove">x</span></span>'):e.find('.fusion-select-preview .fusion-preview-selected-value[data-value="'+jQuery(this).attr("for")+'"]').remove(),0===e.find(".fusion-select-preview .fusion-preview-selected-value").length?t.addClass("fusion-select-show-placeholder"):t.removeClass("fusion-select-show-placeholder"),"click"===i.type&&void 0!==i.isTrigger&&i.isTrigger&&t.trigger("click")}),n.on("click",function(){jQuery(this).closest("li.fusion-builder-option").find(".fusion-form-multiple-select.fusion-select-inited").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").show(),jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").focus(),jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").off("change keyup")}),s.on("click",function(){jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").hide(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-form-multiple-select.fusion-select-inited").show(),jQuery(this).closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").show()}),a.on("keypress",function(e){13===e.which&&o.trigger("click")}),o.on("click",function(){var i=[],n={action:"fusion_multiselect_addnew",fusion_load_nonce:fusionAppConfig.fusion_load_nonce},o=jQuery(this),s=jQuery(this).closest("li.fusion-builder-option").find(".fusion-select-options"),a=jQuery(this).closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val();if(""!==a&&0!==a.trim().length){if(a=a.split(","),n.taxonomy=o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").data("id"),jQuery.each(a,function(e,t){var a=!1;t=t.trim(),jQuery.each(s.find(":checkbox"),function(){var e=jQuery(this).data("label").toString(),i=jQuery(this).is(":checked");e=e.trim(),t.toLowerCase()===e.toLowerCase()&&(a=!0,i||o.closest("li.fusion-builder-option").find('.fusion-select-label[for="'+n.taxonomy+"-"+jQuery(this).val()+'"]').trigger("click"))}),a||i.push(t)}),""===i||0===i.length)return o.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""),void o.closest("li.fusion-builder-option").find(".fusion-form-multiple-select").removeClass("fusion-open");n.values=i,o.closest("li.fusion-builder-option").addClass("partial-refresh-active"),jQuery.post(fusionAppConfig.ajaxurl,n,function(i){"object"==typeof(i=jQuery.parseJSON(i))&&(jQuery.each(i,function(e,t){s.append('<input type="checkbox" id="'+n.taxonomy+"-"+t+'" name="'+n.taxonomy+'[]" value="'+t+'" data-label="'+e+'" class="fusion-select-option fusion-multi-select-option">'),s.append('<label for="'+n.taxonomy+"-"+t+'" class="fusion-select-label">'+e+"</label>"),o.closest("li.fusion-builder-option").find('.fusion-select-label[for="'+n.taxonomy+"-"+t+'"]').trigger("click"),o.closest("li.fusion-builder-option").find(".fusion-form-multiple-select").removeClass("fusion-open")}),0===e.find(".fusion-select-preview .fusion-preview-selected-value").length?t.addClass("fusion-select-show-placeholder"):t.removeClass("fusion-select-show-placeholder"),o.closest("li.fusion-builder-option").removeClass("partial-refresh-active"),o.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),o.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""))})}}),t.find(".fusion-select-preview").on("click",".fusion-option-remove",function(t){t.preventDefault(),e.find('.fusion-select-label[for="'+jQuery(this).parent().data("value")+'"]').trigger("click")}),i.on("keyup change paste",function(t){var i=jQuery(this).val(),n=e.find(".fusion-select-option");"keyup"!==t.type||13!==t.keyCode||1!==e.find(".fusion-select-label:visible").length?_.each(n,function(e){-1===jQuery(e).data("label").toLowerCase().indexOf(i.toLowerCase())?jQuery(e).siblings('.fusion-select-label[for="'+jQuery(e).attr("id")+'"]').css("display","none"):jQuery(e).siblings('.fusion-select-label[for="'+jQuery(e).attr("id")+'"]').css("display","block")}):e.find(".fusion-select-label:visible").trigger("click")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.radioButtonSet={optionRadioButtonSet:function(e){var t,i,n,o,s,a=this;(t=(e=e||this.$el).find(".fusion-form-radio-button-set")).length&&t.each(function(){i=jQuery(this),"color_scheme"!==(o=i.closest(".fusion-builder-option").attr("data-option-id"))&&"scheme_type"!==o?i.find("a").on("click",function(e){e.preventDefault(),n=jQuery(this).closest(".fusion-form-radio-button-set"),s=n.closest(".fusion-builder-option.subgroup").parent(),n.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),n.find(".button-set-value").val(n.find(".ui-state-active").data("value")).trigger("change"),jQuery(this).blur(),n.closest(".fusion-builder-option.subgroup").length&&(s.find(".fusion-subgroup-content").removeClass("active"),s.find(".fusion-subgroup-"+n.find(".ui-state-active").data("value")).addClass("active"))}):i.find("a").on("click",function(e){e.preventDefault(),"function"==typeof a.colorSchemeImport&&a.colorSchemeImport(jQuery(e.currentTarget),jQuery(e.currentTarget).closest(".fusion-builder-option"))})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRangeField={optionRange:function(e){var t,i=this;(t=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-slider-container")).length&&("object"!=typeof this.$rangeSlider&&(this.$rangeSlider={}),Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},t.each(function(){var e=jQuery(this).data("id"),t=jQuery(this).prev(".fusion-slider-input"),n=jQuery(this).data("min"),o=jQuery(this).data("max"),s=jQuery(this).data("step"),a=jQuery(this).data("direction"),r=t.val(),l=s.countDecimals(),u=1===jQuery(this).closest(".fusion-builder-option").find(".fusion-with-default").length,d=!!jQuery(this).closest(".fusion-builder-option").find(".fusion-panel-options .fusion-range-default").length&&jQuery(this).closest(".fusion-builder-option").find(".fusion-panel-options .fusion-range-default"),c=!!u&&jQuery(this).closest(".fusion-builder-option").find(".fusion-hidden-value"),p=u?jQuery(this).closest(".fusion-builder-option").find(".fusion-range-default").data("default"):jQuery(this).data("value");i.$rangeSlider[e]=jQuery(this)[0],void 0!==i.parentValues&&void 0!==i.parentValues[e]&&d&&(jQuery(this).closest(".fusion-builder-option").find(".fusion-range-default").data("default",i.parentValues[e]),p=i.parentValues[e],c&&""!==c.val()||(r=p)),i.createSlider(e,t,n,o,s,r,l,u,d,c,p,a)}))},createSlider:function(e,t,i,n,o,s,a,r,l,u,d,c){var p=this,f=noUiSlider.create(p.$rangeSlider[e],{start:[s],step:o,direction:c,range:{min:i,max:n},format:wNumb({decimals:a}),default:d}),h=!1;t.closest(".fusion-builder-option").attr("data-index",e),l&&""===u.val()&&l.parent().addClass("checked"),l&&l.on("click",function(t){t.preventDefault(),p.$rangeSlider[e].noUiSlider.set(d),u.val("").trigger("fusion-change"),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,t){r&&h&&(l&&l.parent().removeClass("checked"),u.val(e[t]).trigger("fusion-change")),l&&d==Object.values(e)[0]&&l.parent().addClass("checked"),!0===h&&jQuery(this.target).closest(".fusion-slider-container").prev().val(e[t]).trigger("change"),h=!0}),t.on("blur",function(){this.value!==p.$rangeSlider[e].noUiSlider.get()&&p.$rangeSlider[e].noUiSlider.set(this.value)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRawField={optionRaw:function(e){var t,i=this;(t=(e=void 0!==e&&e.length?e:this.$el).find(".fusion-builder-option.raw")).length&&t.each(function(){"function"==typeof i[jQuery(this).data("option-id")]&&i[jQuery(this).data("option-id")](jQuery(this))})},visibility_large:function(e){var t=e.find("span");t.html(FusionApp.settings.visibility_medium),e.prev().find("#slidervisibility_medium").on("change",function(){t.html(jQuery(this).val())})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionRepeaterField={optionRepeater:function(e){var t=this.$el.find(".fusion-builder-option.repeater"),i=this;this.context=e,this.repeaterRowId=void 0===this.repeaterRowId?0:this.repeaterRowId,t.length&&t.each(function(){i.initRepeater(jQuery(this),e)})},initRepeater:function(e){var t,i,n,o,s,a,r=this,l=e.data("option-id"),u=e.find(".repeater-rows"),d=e.find(".fusion-repeater-value"),c=!1;switch(this.context){case"TO":case"FBE":t=this.options[l],i=t.fields,s=FusionApp.settings[l],_.isEmpty(s)||(s=r.reduxDataCorrect(s),c=!0);break;case"PO":if(t=this.options[l],i=t.fields,s=FusionApp.data.postMeta._fusion[l],!_.isEmpty(s)){if("string"==typeof s){s=JSON.parse(s);try{s=JSON.parse(s)}catch(e){}}c=!0}break;default:t=fusionAllElements[this.model.get("element_type")].params[l],i=void 0!==t?t.fields:{},n=jQuery.extend(!0,{},this.model.attributes),"function"==typeof this.filterAttributes&&(n=this.filterAttributes(n)),o=n.params,"string"==typeof(s=void 0!==o[l]?o[l]:"")&&""!==s&&(s=r.getRepeaterValue(!1,s),c=!0)}"object"==typeof s&&c?_.each(s,function(e,n){""!==(a=void 0!==s[n][t.bind_title]&&s[n][t.bind_title]?s[n][t.bind_title]:"")&&"object"==typeof t.fields[t.bind_title]&&"select"===t.fields[t.bind_title].type&&"object"==typeof t.fields[t.bind_title].choices&&(a=t.fields[t.bind_title].choices[a]),""===a&&void 0!==t.row_title&&(a=t.row_title),r.createRepeaterRow(i,s[n],u,a)}):(""===(a="object"==typeof s&&void 0!==s[t.bind_title]&&s[t.bind_title]?s[t.bind_title]:"")&&void 0!==t.row_title&&(a=t.row_title),r.createRepeaterRow(i,{},u,a)),e.on("click",".repeater-row-add",function(e){var n=void 0!==t.row_title&&t.row_title;e.preventDefault(),r.createRepeaterRow(i,{},u,n)}),e.on("click",".repeater-row-remove.fusiona-trash-o",function(e){var t=jQuery(this).closest(".repeater-row").index();e.preventDefault(),r.removeRepeaterRowData(d,t),jQuery(this).closest(".repeater-row").remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-pen")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-pen")}),e.on("change",".repeater-row [name="+t.bind_title+"]",function(){var e=jQuery(this).hasClass("fusion-select-option")||jQuery(this).hasClass("fusion-select-option-value")?jQuery(this).closest(".fusion-builder-option").find(".fusion-select-label[for="+jQuery(this).attr("id")+'], .fusion-select-label[data-value="'+jQuery(this).val()+'"]').html():jQuery(this).val();jQuery(this).closest(".repeater-row").find("> .repeater-title > h3").html(e)}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove.fusiona-trash-o",start:function(e,t){jQuery(this).attr("data-previndex",t.item.index())},update:function(e,t){var i=t.item.index(),n=parseInt(jQuery(this).attr("data-previndex"),10);jQuery(this).removeAttr("data-previndex"),r.orderRepeaterData(d,n,i)}})},createRepeaterRow:function(e,t,i,n){var o,s,a=this,r="",l={},u=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),d={};r+='<div class="repeater-row">',r+='<div class="repeater-title">',r+='<span class="repeater-toggle-icon fusiona-pen"></span>',r+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",r+='<span class="repeater-row-remove fusiona-trash-o"></span>',r+="</div>",r+='<ul class="repeater-fields">',this.repeaterRowId++,_.each(e,function(e){s="builder"===a.context?e.param_name:e.id,o=t[s],d[s]=e,l={field:e,value:o,context:a.context,rowId:a.repeaterRowId},r+=jQuery(u(l)).html()}),r+="</ul>",r+="</div>",i.append(r),_.isEmpty(t)&&this.addRepeaterRowData(i,e),"function"==typeof this.initOptions&&this.initOptions(i.children("div:last-child")),"TO"!==this.context&&"FBE"!==this.context&&"PO"!==this.context&&void 0!==this.model&&void 0!==this.model.get?new FusionPageBuilder.Dependencies(fusionAllElements[this.model.get("element_type")].params,this,i.children("div:last-child"),d,this.$el):new FusionPageBuilder.Dependencies({},this,i.children("div:last-child"),d,this.$el)},getRepeaterValue:function(e,t){if("string"==typeof(t=void 0===t?e.val():t)&&""!==t)switch(this.context){case"TO":case"FBE":try{t=JSON.parse(t),_.isEmpty(t)||(t=this.reduxDataCorrect(t))}catch(e){}break;case"PO":try{"function"!=typeof(t=JSON.parse(t)).splice&&(t=Object.values(t))}catch(e){}break;default:try{t=FusionPageBuilderApp.base64Decode(t),t=_.unescape(t),t=JSON.parse(t)}catch(e){}}return(""===t||_.isEmpty(t))&&(t=[]),t},addRepeaterRowData:function(e,t){var i,n,o=this,s=e.find(".repeater-row").last().index(),a=e.closest(".repeater").find(".fusion-repeater-value"),r=this.getRepeaterValue(a),l={};"builder"!==this.context&&"PO"!==this.context&&(l.fusionredux_repeater_data={title:""}),_.each(t,function(e){n="builder"===o.context?e.param_name:e.id,i=void 0===e.default||"builder"===o.context||"select"!==e.type&&"radio-buttonset"!==e.type?"":e.default,l[n]=i}),r[s]=l,this.updateRepeaterValues(a,r)},removeRepeaterRowData:function(e,t){var i=this.getRepeaterValue(e);void 0!==i[t]&&(i.splice(t,1),this.updateRepeaterValues(e,i))},orderRepeaterData:function(e,t,i){var n=this.getRepeaterValue(e),o=n[t];void 0!==o&&(n.splice(t,1),n.splice(i,0,o),this.updateRepeaterValues(e,n))},setRepeaterValue:function(e,t,i,n){var o=this.getRepeaterValue(e);void 0!==o[i]&&(o[i][t]=n,this.updateRepeaterValues(e,o))},updateRepeaterValues:function(e,t){if(""!==t&&!_.isEmpty(t))switch(this.context){case"TO":case"FBE":t=this.reduxDataReverse(t),t=JSON.stringify(t);break;case"PO":t=JSON.stringify(t);break;default:t=JSON.stringify(t),t=FusionPageBuilderApp.base64Encode(t)}e.val(t).trigger("change")},reduxDataCorrect:function(e){var t=[];return _.each(e,function(e,i){_.each(e,function(e,n){void 0===t[n]&&(t[n]={}),t[n][i]=e})}),t},reduxDataReverse:function(e){var t={};return _.each(e,function(e){_.each(e,function(e,i){void 0===t[i]&&(t[i]=[]),t[i].push(e)})}),t}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSelectField={optionSelect:function(e){var t;(t=(e=e||this.$el).find(".fusion-select-field:not(.fusion-select-inited):not(.fusion-form-multiple-select):not(.fusion-ajax-select):not(.fusion-skip-init)")).length&&t.each(function(){var e=jQuery(this),t=e.find(".fusion-select-dropdown"),i=e.find(".fusion-select-preview-wrap"),n=e.find(".fusion-select-search input"),o=i.find(".fusion-select-preview");e.addClass("fusion-select-inited"),i.on("click",function(t){var i=e.hasClass("fusion-open");t.preventDefault(),i?(e.removeClass("fusion-open"),n.length&&n.val("").blur(),e.find(".fusion-select-label").css("display","block")):(e.addClass("fusion-open"),n.length&&n.focus())}),e.on("click",".fusion-select-label",function(){o.html(jQuery(this).html()),i.trigger("click"),t.find(".fusion-select-label").removeClass("fusion-option-selected"),jQuery(this).addClass("fusion-option-selected"),e.find(".fusion-select-option-value").val(jQuery(this).data("value")).trigger("change",[{userClicked:!0}])}),e.find(".fusion-select-option-value").on("change",function(n,o){void 0!==o&&void 0!==o.userClicked&&!0!==o.userClicked||(i.find(".fusion-select-preview").html(e.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').html()),t.find(".fusion-select-label").removeClass("fusion-option-selected"),t.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').addClass("fusion-option-selected"))}),n.on("keyup change paste",function(){var t=jQuery(this).val(),i=e.find(".fusion-select-label");"keyup"!==event.type||13!==event.keyCode||1!==e.find(".fusion-select-label:visible").length?_.each(i,function(e){-1===jQuery(e).html().toLowerCase().indexOf(t.toLowerCase())?jQuery(e).css("display","none"):jQuery(e).css("display","block")}):e.find(".fusion-select-label:visible").trigger("click")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FASElement.prototype.removeTag=function(e){var t=jQuery(e.target).parent().data("value");jQuery(e.target).parent().remove(),this.$el.find('.fusion-select-label[for="'+t+'"]').trigger("click"),this.$el.hasClass("fusion-ajax-single-select")&&(this.$el.find("input[type=search]").focus(),this.$el.find("input[type=search]").val(""))},FASElement.prototype.addNew=function(){this.$el.closest("li.fusion-builder-option").find(".fusion-ajax-select.fusion-select-inited").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").show(),this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").focus(),this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").off("change keyup")},FASElement.prototype.verifyInput=function(e){13===e.which&&this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-save").trigger("click")},FASElement.prototype.saveNew=function(){var e=[],t={action:"fusion_multiselect_addnew",fusion_load_nonce:fusionAppConfig.fusion_load_nonce},i=this.$el,n=this,o=this.$el.closest("li.fusion-builder-option").find(".fusion-select-tags"),s=this.$el.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val();if(""!==s&&0!==s.trim().length){if(s=s.split(","),t.taxonomy=i.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").data("id"),jQuery.each(s,function(t,i){var n=!1;i=i.trim(),jQuery.each(o.find(".fusion-select-tag"),function(){var e=jQuery(this).data("text").toString();e=e.trim(),i.toLowerCase()===e.toLowerCase()&&(n=!0)}),n||e.push(i)}),""===e||0===e.length)return i.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),void i.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val("");t.values=e,i.closest("li.fusion-builder-option").addClass("partial-refresh-active"),jQuery.post(fusionAppConfig.ajaxurl,t,function(e){"object"==typeof(e=jQuery.parseJSON(e))&&("string"==typeof FusionApp.data.postDetails[t.taxonomy]&&(FusionApp.data.postDetails[t.taxonomy]=FusionApp.data.postDetails[t.taxonomy].split(",")),jQuery.each(e,function(e,i){n.options.push({id:i,text:e,checked:!0}),FusionApp.data.postDetails[t.taxonomy].push(i)}),n.renderOptions(),i.closest("li.fusion-builder-option").removeClass("partial-refresh-active"),i.closest("li.fusion-builder-option").find(".fusion-multiselect-cancel").trigger("click"),i.closest("li.fusion-builder-option").find("input.fusion-multiselect-input").val(""),FusionApp.contentChange("page","page-setting"))})}},FASElement.prototype.cancelAddNew=function(){this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew-section").hide(),this.$el.closest("li.fusion-builder-option").find(".fusion-ajax-select.fusion-select-inited").show(),this.$el.closest("li.fusion-builder-option").find(".fusion-multiselect-addnew").show()},FASElement.prototype.showNotice=function(e){this.$el.find(".fusion-ajax-select-notice").html(e).show()},FASElement.prototype.hideNotice=function(){this.$el.find(".fusion-ajax-select-notice").hide()},FASElement.prototype.showDropdown=function(){this.$el.addClass("fusion-open")},FASElement.prototype.hideDropdown=function(){this.$el.removeClass("fusion-open")},FASElement.prototype.toggleEmptySelection=function(){this.$el.hasClass("fusion-ajax-single-select")&&1>this.$el.find(".fusion-select-tag").length?this.$el.addClass("fusion-ajax-empty-select"):this.$el.removeClass("fusion-ajax-empty-select")},FASElement.prototype.setLoader=function(e){var t=this.$el.find(".fusion-ajax-select-search input");this.ajaxInProcess=e,t.attr("disabled",this.ajaxInProcess),this.ajaxInProcess||t.focus()},FASElement.prototype.search=function(e){var t,i,n;if(t=this,i=e.target.value,n=2>t.maxInput?"item":"items",e.preventDefault(),t.$el.find(".fusion-select-options").hide(),this.options=_.filter(this.options,{checked:!0}),this.showDropdown(),t.maxInput<=t.options.length)this.showNotice("You can only select "+t.maxInput+" "+n);else if(3<=i.length){if(!0===this.ajaxInProcess)return;this.showNotice('<div class="fusion-select-loader"></div>'),this.setLoader(!0),jQuery.post(fusionAppConfig.ajaxurl,{action:this.ajaxCall,search:i.toLowerCase(),params:this.ajaxParams,fusion_load_nonce:fusionAppConfig.fusion_load_nonce},function(e){var i;if(e=jQuery.parseJSON(e),!(i=_.filter(e.results||[],function(e){return!_.find(t.options,function(t){return t.id==e.id})})).length)return t.setLoader(!1),t.showNotice("No search results");t.options=t.options.concat(i),t.hideNotice(),t.renderOptions(),t.$el.find(".fusion-select-options").show(),t.setLoader(!1)})}else 0===i.length?this.hideDropdown():this.showNotice("Please enter 3 or more characters")},FASElement.prototype.select=function(e){var t,i,n,o;e.preventDefault(),t=jQuery("#"+jQuery(e.target).attr("for")),o=jQuery(e.target).closest(".fusion-ajax-select"),i=t.is(":checked"),n=t.val(),_.each(this.options,function(e){return e.id==n&&(e.checked=i),e}),o.hasClass("fusion-ajax-single-select")&&this.hideDropdown(),this.renderOptions()},FASElement.prototype.toggleLoading=function(){var e="fusion-ajax-select-loading";this.$el.hasClass(e)?this.$el.removeClass(e):this.$el.addClass(e)},FASElement.prototype.getLabels=function(){return jQuery.ajax({type:"POST",url:fusionAppConfig.ajaxurl,data:{action:this.ajaxCall,labels:this.initialValues,params:this.ajaxParams,fusion_load_nonce:fusionAppConfig.fusion_load_nonce}})},FASElement.prototype.renderOptions=function(){var e,t,i,n,o;e=this,t=this.$el.find(".fusion-select-options"),i=this.$el.find(".fusion-select-tags"),(n=t.clone()).empty(),i.empty(),_.filter(this.options,function(e){return!e.checked}).length||this.hideDropdown(),_.each(this.options,function(t){var o=e.prefix+"-"+t.id,s=t.checked?"checked":"",a=jQuery('<input type="checkbox" id="'+o+'" name="'+e.fieldId+'[]" value="'+t.id+'" data-label="'+t.text+'" class="fusion-select-option" '+s+'><label for="'+o+'" class="fusion-select-label">'+t.text+"</label>");n.append(a),s&&(a.hide(),i.append('<span class="fusion-select-tag" data-value="'+o+'" data-text="'+t.text+'">'+t.text+'<span class="fusion-option-remove">x</span></span>'))}),o=FusionPageBuilderApp._diffdom.diff(t[0],n[0]),FusionPageBuilderApp._diffdom.apply(t[0],o),e.toggleEmptySelection()},FASElement.prototype.init=function(){var e,t,i;e=this,t=this.$el.find(".initial-values").val(),i=this.$el.find(".params").val(),this.initialValues=t?JSON.parse(_.unescape(t)):[],this.ajaxParams=i?JSON.parse(_.unescape(i)):[],e.$el.addClass("fusion-select-inited"),this.initialValues.length&&(this.toggleLoading(),this.getLabels().success(function(t){t=JSON.parse(t),e.options=t.labels||[],_.each(e.options,function(e){e.checked=!0}),e.renderOptions(),e.toggleLoading()})),e.toggleEmptySelection()},FusionPageBuilder.options.fusionAjaxSelect={optionAjaxSelect:function(e){var t;t=this,e.find(".fusion-ajax-select:not(.fusion-select-inited):not(.fusion-form-multiple-select):not(.fusion-skip-init)").each(function(){new FASElement(this,t)})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSortableText={optionSortableText:function(e){(e=e||this.$el).find(".fusion-sortable-text-options").each(function(){var e=jQuery(this);e.sortable({handle:".fusion-sortable-move"}),e.on("sortupdate",function(e){var t=jQuery(e.target),i="";t.children(".fusion-sortable-option").each(function(){i+=jQuery(this).find("input").val()+"|"}),i=i.slice(0,-1),t.siblings(".sort-order").val(i).trigger("change")}),e.on("click",".fusion-sortable-remove",function(t){t.preventDefault(),jQuery(t.target).closest(".fusion-sortable-option").remove(),e.trigger("sortupdate")}),e.on("change keyup","input",function(){e.trigger("sortupdate")}),e.prev(".fusion-builder-add-sortable-child").on("click",function(t){var i=e.next(".fusion-placeholder-example").clone(!0);t.preventDefault(),i.removeClass("fusion-placeholder-example").removeAttr("style").appendTo(e),setTimeout(function(){e.find(".fusion-sortable-option:last-child input").focus()},100),e.trigger("sortupdate")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSortable={optionSortable:function(e){(e=e||this.$el).find(".fusion-sortable-options").each(function(){""===jQuery(this).siblings(".sort-order").val()&&jQuery(this).closest(".pyre_metabox_field").find(".fusion-builder-default-reset").addClass("checked"),jQuery(this).sortable(),jQuery(this).on("sortupdate",function(e){var t=jQuery(e.target),i="";t.children(".fusion-sortable-option").each(function(){i+=jQuery(this).data("value")+","}),i=i.slice(0,-1),t.siblings(".sort-order").val(i).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionSwitchField={optionSwitch:function(e){var t;e=void 0!==e&&e.length?e:this.$el,t=jQuery(e.find('.fusion-builder-option.switch input[type="checkbox"]')),_.each(t,function(e){jQuery(e).on("click",function(){var e=jQuery(this).is(":checked")?"1":"0";jQuery(this).attr("value",e),jQuery(this).trigger("change")})})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionTextFieldPlaceholder={textFieldPlaceholder:function(e){var t;(t=(e=e||this.$el).find("[data-placeholder]")).length&&t.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")})}},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionTypographyField={optionTypography:function(e){var t=this;(e=void 0!==e&&e.length?e:this.$el).find(".wrapper .font-family").length&&(_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){t.initAfterWebfontsLoaded(e)}):this.initAfterWebfontsLoaded(e))},initAfterWebfontsLoaded:function(e){this.renderFontSelector(e)},renderFontSelector:function(e){var t,i=this,n=FusionApp.assets.webfonts,o=[],s=[],a=[],r=e.find(".font-family .fusion-select-field"),l=[];_.isUndefined(n.standard)||_.each(n.standard,function(e){o.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(n.google)||_.each(n.google,function(e){s.push({id:e.family,text:e.label})}),_.isUndefined(n.custom)||_.each(n.custom,function(e){e.family&&""!==e.family&&a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),a[0]&&l.push({text:"Custom Fonts",children:a}),l.push({text:"Standard Fonts",children:o}),l.push({text:"Google Fonts",children:s}),_.each(jQuery(r),function(e){var n=i.getTypographyVal(e,"font-family").replace(/'/g,'"'),o=jQuery(e).closest(".fusion-builder-option").attr("data-option-id");t=jQuery(e).fusionSelect({fieldId:o,fieldName:"font-family",fieldValue:n,data:l}),setTimeout(function(){i.renderBackupFontSelector(o,n),i.renderVariantSelector(o,n),i.renderSubsetSelector(o,n)},70),t.find(".fusion-select-option-value").on("change",function(){i.renderBackupFontSelector(o,jQuery(this).val()),i.renderVariantSelector(o,jQuery(this).val()),i.renderSubsetSelector(o,jQuery(this).val()),i.webFontLoad(jQuery(this).val(),i.getTypographyVal(o,"variant"),i.getTypographyVal(o,"subsets"),e)})})},renderBackupFontSelector:function(e,t){var i=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .font-backup'),n=[];if(_.isUndefined(FusionApp.assets.webfonts.standard)||_.each(FusionApp.assets.webfonts.standard,function(e){n.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),i.find(".fusion-select-field").fusionSelect({fieldId:e,fieldName:"font-backup",data:[{text:"Standard Fonts",children:n}]}),!1===this.isGoogleFont(t))return i.hide(),void this.setTypographyVal(e,"font-backup","");i.show()},renderVariantSelector:function(e,t){var i=this,n=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .variant select'),o=i.getVariants(t),s=[],a=i.getTypographyVal(e,"variant");if(!1===o&&jQuery(n).closest(".variant").hide(),jQuery(n).closest(".fusion-builder-option").hasClass("font_family")&&""===t)return"EO"==this.type&&(this.model.get("params")["fusion_font_variant_"+e]="",jQuery(n).val("")),void jQuery(n).closest(".fusion-variant-wrapper").hide();jQuery(n).closest(".variant").show(),jQuery(n).closest(".fusion-variant-wrapper").show(),jQuery(n).show(),_.each(o,function(e){e.id&&"italic"===e.id&&(e.id="400italic"),s.push({id:e.id,text:e.label})}),a=i.getValidVariant(t,a),jQuery(n).empty(),_.each(s,function(e){var t=e.id===a?"selected":"";jQuery(n).append('<option value="'+e.id+'" '+t+">"+e.text+"</option>")}),i.isCustomFont(t)&&(i.setTypographyVal(e,"variant","400"),i.setTypographyVal(e,"font-weight","400")),jQuery(n).on("fusion.typo-variant-loaded change",function(){i.getFontWeightFromVariant(jQuery(this).val()),i.getFontStyleFromVariant(jQuery(this).val()),i.webFontLoad(i.getTypographyVal(e,"font-family"),jQuery(this).val(),i.getTypographyVal(e,"subsets"),n)}),jQuery(n).val(a).trigger("fusion.typo-variant-loaded")},getFontWeightFromVariant:function(e){return _.isString(e)&&_.isObject(e.match(/\d/g))?e.match(/\d/g).join(""):"400"},getFontStyleFromVariant:function(e){return!_.isUndefined(e)&&_.isString(e)&&-1!==e.indexOf("italic")?"italic":""},renderSubsetSelector:function(e,t){var i=this,n=i.getSubsets(t),o=jQuery('.fusion-builder-option[data-option-id="'+e+'"] .subsets select'),s=[],a=i.getTypographyVal(e,"subsets");if(!1===n)return jQuery(o).closest(".subsets").hide(),void i.setTypographyVal(e,"subsets","");jQuery(o).closest(".subsets").show(),_.each(n,function(e){_.isObject(a)&&-1===_.indexOf(a,e.id)&&(a=_.reject(a,function(t){return t===e.id})),s.push({id:e.id,text:e.label})}),jQuery(o).empty(),_.each(s,function(e){var t=e.id===a?"selected":"";jQuery(o).append('<option value="'+e.id+'" '+t+">"+e.text+"</option>")}),jQuery(o).on("fusion.typo-subset-loaded change",function(){i.setTypographyVal(e,"subsets",jQuery(this).val()),i.webFontLoad(i.getTypographyVal(e,"font-family"),i.getTypographyVal(e,"variant"),jQuery(this).val(),o)}),jQuery(o).val(a).trigger("fusion.typo-subset-loaded")},getVariants:function(e){var t=!1;return this.isCustomFont(e)?[{id:"400",label:"Normal 400"}]:(_.each(FusionApp.assets.webfonts.standard,function(i){if(e&&i.family===e)return t=i.variants,i.variants}),_.each(FusionApp.assets.webfonts.google,function(i){if(i.family===e)return t=i.variants,i.variants}),t)},getSubsets:function(e){var t=!1,i=FusionApp.assets.webfonts;return _.each(i.google,function(i){i.family===e&&(t=i.subsets)}),t},getTypographyVal:function(e,t){var i,n,o,s={};return"EO"==this.type?(n="string"!=typeof e?jQuery(e).closest(".fusion-builder-option"):jQuery('.fusion-builder-option[data-option-id="'+e+'"]'),t=t.replace("-","_"),o=n.find(".input-"+t).attr("name"),void 0!==(s=this.model.get("params")[o])&&""!==s||(s=n.find(".input-"+t).attr("data-default")),s):(i=_.isUndefined(FusionApp.settings[e])?jQuery(e).closest(".fusion-builder-option").attr("data-option-id"):e,_.isUndefined(FusionApp.settings[i])||(s=FusionApp.settings[i]),s=this.removeEmpty(s),s=_.defaults(s,{"font-family":"","font-backup":"",variant:"400","font-style":"","font-weight":"400",subsets:"latin","font-size":"","line-height":"","letter-spacing":"","word-spacing":"","text-align":"","text-transform":"",color:"","margin-top":"","margin-bottom":""}),"variant"!==t||_.isUndefined(s[t])?_.isUndefined(t)||!t||_.isUndefined(s[t])?s:s[t]:"italic"===s["font-style"]?s["font-weight"]+s["font-style"]:s["font-weight"])},removeEmpty:function(e){var t=this;return Object.keys(e).forEach(function(i){e[i]&&"object"==typeof e[i]?t.removeEmpty(e[i]):null!==e[i]&&""!==e[i]||delete e[i]}),e},setTypographyVal:function(e,t,i){"EO"!=this.type&&(_.isUndefined(FusionApp.settings[e])&&(FusionApp.settings[e]={}),FusionApp.settings[e][t]=i)},webFontLoad:function(e,t,i,n){var o,s,a=this.isGoogleFont(e);if(t=this.getValidVariant(e,t),!_.isUndefined(e)&&""!==e&&e&&(void 0===n||!n||this.checkFontChanged(e,t,i,n))&&!1!==a)return t=_.isUndefined(t)||!t?":regular":":"+t,e=e.replace(/"/g,"&quot"),""!==i&&i?_.isString(i)?i=":"+i:_.isArray(i)?i=":"+i.join(","):_.isObject(i)&&(i=":"+_.values(i).join(",")):i="",s=e,s+=t||"",o=(s+=i||"").replace(/:/g,"").replace(/"/g,"").replace(/'/g,"").replace(/ /g,"").replace(/,/,""),!!jQuery("#fb-preview").contents().find("#"+o).length||(jQuery("#fb-preview").contents().find("head").append('<script id="'+o+'">WebFont.load({google:{families:["'+s+'"]},context:FusionApp.previewWindow,active: function(){ jQuery( window ).trigger( "fusion-font-loaded"); },});<\/script>'),!1)},isGoogleFont:function(e){var t=!1;return _.each(FusionApp.assets.webfonts.google,function(i){i.family===e&&(t=!0)}),t},isCustomFont:function(e){var t=!1;return _.each(FusionApp.assets.webfonts.custom,function(i){i.family===e&&(t=!0)}),t},getValidVariant:function(e,t){var i=this.getVariants(e),n=!1,o=!1,s=_.isUndefined(i[0])||_.isUndefined(i[0].id)?"":i[0].id;return this.isCustomFont(e)?"400":(_.each(i,function(e){t===e.id&&(n=!0),"regular"!==e.id&&"400"!==e.id&&400!==e.id||(o=!0)}),n?t:o?"400":s)},checkFontChanged:function(e,t,i,n){var o=jQuery(n).closest(".fusion-builder-option").attr("data-option-id"),s=FusionApp.settings[o];return"EO"==this.type||(t="regular"===t?"400":t,s["font-family"]!==e||(s.variant!==t&&s["font-weight"]!==t||void 0!==i&&s.subset!==i))}},jQuery.fn.fusionSelect=function(e){var t="",i=jQuery(this),n=i.find(".fusion-select-option-value"),o=i.find(".fusion-select-dropdown"),s=i.find(".fusion-select-preview-wrap"),a=i.find(".fusion-select-search input");return i.hasClass("fusion-select-inited")?i:(i.addClass("fusion-select-inited"),i.closest(".fusion-builder-option").hasClass("font_family")&&(t+='<label class="fusion-select-label'+(""===n.val()?" fusion-option-selected":"")+'" data-value="" data-id="">'+fusionBuilderText.typography_default+"</label>"),_.each(e.data,function(i){t+="string"==typeof i.text&&"font-family"===e.fieldName?'<div class="fusion-select-optiongroup">'+i.text+"</div>":"",_.each(i.children,function(e){var i=e.id===n.val()?" fusion-option-selected":"",o="string"==typeof e.id?e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase():"";t+='<label class="fusion-select-label'+i+'" data-value="'+e.id+'" data-id="'+o+'">'+e.text+"</label>"})}),i.find(".fusion-select-options").html(t),s.on("click",function(e){var t=i.hasClass("fusion-open");e.preventDefault(),t?(i.removeClass("fusion-open"),a.length&&a.val("").blur(),i.find(".fusion-select-label").css("display","block")):(i.addClass("fusion-open"),a.length&&a.focus())}),i.on("click",".fusion-select-label",function(){s.find(".fusion-select-preview").html(jQuery(this).html()),s.trigger("click"),o.find(".fusion-select-label").removeClass("fusion-option-selected"),jQuery(this).addClass("fusion-option-selected"),i.find(".fusion-select-option-value").val(jQuery(this).data("value")).trigger("change",[{userClicked:!0}])}),i.find(".fusion-select-option-value").on("change",function(e,t){void 0!==t&&void 0!==t.userClicked&&!0!==t.userClicked||(s.find(".fusion-select-preview").html(i.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').html()),o.find(".fusion-select-label").removeClass("fusion-option-selected"),o.find('.fusion-select-label[data-value="'+jQuery(this).val()+'"]').addClass("fusion-option-selected"))}),"font-family"===e.fieldName?a.on("keyup change paste",function(){var t,n,o=jQuery(this).val(),s="object"==typeof e.data[0]?jQuery.extend(!0,e.data[0].children,{}):{},a="object"==typeof e.data[1]?jQuery.extend(!0,e.data[1].children,{}):{},r="object"==typeof e.data[2]?jQuery.extend(!0,e.data[2].children,{}):{};3>o.length?i.find(".fusion-select-label").css("display","block"):"keyup"!==event.type||13!==event.keyCode||1!==i.find(".fusion-select-label:visible").length?(i.find(".fusion-select-label").css("display","none"),t={threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["text"]},n=new Fuse(jQuery.extend(!0,a,s,r,{}),t).search(o),_.each(n,function(e){i.find('.fusion-select-label[data-id="'+e.id.replace(/"/g,"").replace(/'/g,"").toLowerCase()+'"]').css("display","block")})):i.find(".fusion-select-label:visible").trigger("click")}):a.on("keyup change paste",function(){var e=jQuery(this).val(),t=i.find(".fusion-select-label");"keyup"!==event.type||13!==event.keyCode||1!==i.find(".fusion-select-label:visible").length?_.each(t,function(t){-1===jQuery(t).html().toLowerCase().indexOf(e.toLowerCase())?jQuery(t).css("display","none"):jQuery(t).css("display","block")}):i.find(".fusion-select-label:visible").trigger("click")}),i)},(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionFontFamilyField={optionFontFamily:function(e){var t=this;(e=void 0!==e&&e.length?e:this.$el).find(".wrapper .font-family").length&&(_.isUndefined(FusionApp.assets)||_.isUndefined(FusionApp.assets.webfonts)?jQuery.when(FusionApp.assets.getWebFonts()).done(function(){t.initAfterWebfontsLoaded(e)}):this.initAfterWebfontsLoaded(e))}};var fusionTriggerResize=_.debounce(fusionResize,300),fusionTriggerScroll=_.debounce(fusionScroll,300),fusionTriggerLoad=_.debounce(fusionLoad,300),fusionSanitize={getSettings:function(){var e={};return void 0!==FusionApp&&(void 0!==FusionApp.settings&&(e=jQuery.extend(e,FusionApp.settings)),void 0!==FusionApp.data&&void 0!==FusionApp.data.postMeta&&(e=jQuery.extend(e,FusionApp.data.postMeta))),_.each(e,function(t,i){"object"==typeof t&&_.each(t,function(t,n){e[i+"["+n+"]"]=t})}),e},getOption:function(e,t){var i=this,n="",o="";return void 0!==this.getSettings()[e]?n=i.getSettings()[e]:_.each(fusionOptionNetworkNames,function(t,o){e===o&&t.theme&&(n=i.getSettings()[t.theme])}),t=t||e,o=this.getPageOption(t),_.each(fusionOptionNetworkNames,function(t,n){e===n&&(t.post&&(o=i.getPageOption(t.post)),!o&&t.term&&(o=i.getPageOption(t.term)),!o&&t.archive&&(o=i.getPageOption(t.archive)))}),e&&t&&"default"!==o&&!_.isEmpty(o)?o:-1===n.indexOf("/")?n.toLowerCase():n},getPageOption:function(e){if(e){if(!(_.isUndefined(FusionApp)||_.isUndefined(FusionApp.data.postMeta)||_.isUndefined(FusionApp.data.postMeta._fusion)||_.isUndefined(FusionApp.data.postMeta._fusion[e])))return FusionApp.data.postMeta._fusion[e];if(!_.isUndefined(FusionApp)&&!_.isUndefined(FusionApp.data.postMeta)&&!_.isUndefined(FusionApp.data.postMeta[e]))return FusionApp.data.postMeta[e]}return""},color_alpha_set:function(e,t){var i=jQuery.Color(e),n=Math.abs(t);return 1<n&&(n/=100),i.alpha(n).toRgbaString()},conditional_return_value:function(e,t){var i=this,n=[],o=[],s=!0,a="",r="$";return t.value_pattern&&(r=t.value_pattern[0],a=t.value_pattern[1]),_.each(t.conditions,function(e,t){var s="";if(void 0!==e[0])switch(void 0!==(s=i.getSettings()[e[0]])&&void 0!==s||(s="",-1!==e[0].indexOf("[")&&(s=i.getSettings()[e[0].split("[")[0]],e[0].split("[")[1]&&void 0!==s[e[0].split("[")[1].replace("]","")]&&(s=s[e[0].split("[")[1].replace("]","")]))),e[1]){case"===":n[t]=s===e[2];break;case">":n[t]=parseFloat(i.units_to_px(s))>parseFloat(e[2]);break;case">=":n[t]=parseFloat(i.units_to_px(s))>=parseFloat(e[2]);break;case"<":n[t]=parseFloat(i.units_to_px(s))<parseFloat(e[2]);break;case"<=":n[t]=parseFloat(i.units_to_px(s))<=parseFloat(e[2]);break;case"!==":n[t]=s!==e[2];break;case"in":o=[],_.each(e[2],function(e,t){o[t]=s!==e}),n[t]=!0,_.each(o,function(e){e||(n[t]=!1)});break;case"true":n[t]=!0===s||"true"===s||1===s||"1"===s||"yes"===s}}),_.each(n,function(e){e||(s=!1)}),!1===s?a.replace(/\$/g,e):r.replace(/\$/g,e)},units_to_px:function(e,t,i){var n=parseFloat(e),o=e.replace(/\d+([,.]\d+)?/g,"");return i=i||1600,"em"===o||"rem"===o?(t=t||16,parseInt(n*t,10)+"px"):"%"===o?parseInt(n*i/100,10)+"px":parseInt(e,10)+"px"},maybe_append_px:function(e){return isNaN(e)?e:e+"px"},return_color_if_opaque:function(e,t){return"transparent"===e?t.transparent:1===jQuery.Color(e).alpha()?t.opaque:t.transparent},get_readable_color:function(e,t){var i=jQuery.Color(e),n=parseFloat(t.threshold);return"object"!=typeof t&&(t={}),void 0===t.threshold&&(t.threshold=.547),void 0===t.light&&(t.light="#333"),void 0===t.dark&&(t.dark="#fff"),1<n&&(n/=100),i.lightness()<n?t.dark:t.light},lightness_adjust:function(e,t){var i=jQuery.Color(e),n=Math.abs(t),o=0>n;return 1<n&&(n/=100),o?i.lightness("-="+n).toRgbaString():i.lightness("+="+n).toRgbaString()},string_replace:function(e,t){return!_.isObject(t)||_.isUndefined(t[0])||_.isUndefined(t[1])?e:e.replace(new RegExp(t[0],"g"),t[1])},return_string_if_transparent:function(e,t){return"transparent"===e?"$"===t.transparent?e:t.transparent:0===jQuery.Color(e).alpha()?"$"===t.transparent?e:t.transparent:"$"===t.opaque?e:t.opaque},get_non_transparent_color:function(e){var t=jQuery.Color(e);return 0===t.alpha()?t.alpha(1).toHexString():e},header_border_color_condition_5:function(e,t){return t=t||"","v6"!==this.getSettings().header_layout&&"left"===this.getSettings().header_position&&this.getSettings().header_border_color&&0===jQuery.Color(this.getSettings().header_border_color).alpha()?e:t},fallback_to_zero:function(e){return e&&""!==e?e:0},fallback_to_value:function(e,t){return"object"==typeof t&&void 0!==t[0]&&void 0!==t[1]?e&&""!==e?t[0].replace(/\$/g,e):t[1].replace(/\$/g,e):e&&""!==e?e:t},fallback_to_value_if_empty:function(e,t){return"object"==typeof t&&void 0!==t[0]&&void 0!==t[1]?""===e?t[1].replace(/\$/g,e):t[0].replace(/\$/g,e):""===e?t:e},site_width_100_percent:function(e,t){return t[0]||(t[0]="$"),t[1]||(t[1]=""),this.getSettings().site_width&&"100%"===this.getSettings().site_width?t[0].replace(/\$/g,e):t[1].replace(/\$/g,e)},hundred_percent_negative_margin:function(){var e=this.getOption("hundredp_padding","hundredp_padding"),t=parseFloat(e),i="";return i="-"+e,"%"===("string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e)&&(i="-"+(i=t/(100-2*t)*100)+"%"),i},change_slider_position:function(e,t){var i=window.frames[0].jQuery(t.element);void 0!==document.getElementById("fb-preview").contentWindow.avadaFusionSliderVars&&(document.getElementById("fb-preview").contentWindow.avadaFusionSliderVars.slider_position=e.toLowerCase()),"above"===e.toLowerCase()?i.detach().insertBefore(".avada-hook-before-header-wrapper"):"below"===e.toLowerCase()&&i.detach().insertAfter(".avada-hook-after-header-wrapper")},change_header_position:function(e){var t=window.frames[0].jQuery("body");e=e.toLowerCase(),t.removeClass("side-header side-header-left side-header-right fusion-top-header fusion-header-layout-v1 fusion-header-layout-v2 fusion-header-layout-v3 fusion-header-layout-v4 fusion-header-layout-v5 fusion-header-layout-v6 fusion-header-layout-v7"),"left"===e||"right"===e?t.addClass("side-header side-header-"+e):"top"===e&&t.addClass("fusion-top-header fusion-header-layout-"+this.getOption("header_layout"))},toggle_class:function(e,t){var i=window.frames[0].jQuery(t.element);if(t.className)if(jQuery.isArray(t.className))jQuery.each(t.condition,function(n,o){if(e===o)return i.removeClass(t.className.join(" ")),i.addClass(t.className[n]),!1});else switch(t.condition[1]){case"===":e===t.condition[0]?i.addClass(t.className):i.removeClass(t.className);break;case"==":e==t.condition[0]?i.addClass(t.className):i.removeClass(t.className);break;case"!==":e!==t.condition[0]?i.addClass(t.className):i.removeClass(t.className);break;case"!=":e!=t.condition[0]?i.addClass(t.className):i.removeClass(t.className);break;case">=":parseFloat(e)>=parseFloat(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"<=":parseFloat(e)<=parseFloat(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case">":parseFloat(e)>parseFloat(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"<":parseFloat(e)<parseFloat(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"contains":-1!==e.indexOf(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"does-not-contain":-1===e.indexOf(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"opaque":1===jQuery.Color(e).alpha()?i.addClass(t.className):i.removeClass(t.className);break;case"not-opaque":1>jQuery.Color(e).alpha()?i.addClass(t.className):i.removeClass(t.className);break;case"header-not-opaque":1>jQuery.Color(e).alpha()&&void 0!==FusionApp&&"off"!==FusionApp.preferencesData.transparent_header?i.addClass(t.className):i.removeClass(t.className);break;case"full-transparent":"transparent"===e||0===jQuery.Color(e).alpha()?i.addClass(t.className):i.removeClass(t.className);break;case"not-full-transparent":"transparent"!==e&&0<jQuery.Color(e).alpha()?i.addClass(t.className):i.removeClass(t.className);break;case"true":1===e||"1"===e||!0===e||"true"===e||"yes"===e?i.addClass(t.className):i.removeClass(t.className);break;case"false":1===e||"1"===e||!0===e||"true"===e||"yes"===e?i.removeClass(t.className):i.addClass(t.className);break;case"has-image":"object"==typeof e&&"string"==typeof e.url&&""!==e.url||"string"==typeof e&&0<=e.indexOf("http")?i.addClass(t.className):i.removeClass(t.className);break;case"equal-to-option":e===this.getOption(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"not-equal-to-option":e!==this.getOption(t.condition[0])?i.addClass(t.className):i.removeClass(t.className);break;case"is-zero-or-empty":e&&0!==parseInt(e,10)?i.removeClass(t.className):i.addClass(t.className)}},convert_font_size_to_px:function(e,t){var i,n,o="string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e,s=parseFloat(e),a="object"==typeof t&&void 0!==t.addUnits&&t.addUnits;return"object"==typeof t&&void 0!==t.setting&&(t=this.getOption(t.setting)),i="string"==typeof t?t.replace(/\d+([,.]\d+)?/g,""):t,n=parseFloat(t),s?"px"===o?a?s+"px":s:("em"===i||"rem"===i?n*=15:"%"===i?n=15*n/100:"px"!==i&&(n=15),"em"===o||"rem"===o?s*=n:"%"===o?s=n*s/100:"px"!==o&&(s=n),a?s+"px":s):e},font_weight_no_regular:function(e){return"regular"===e?"400":e}};function fusionReturnStringIfTransparent(e,t){return"transparent"===e?"$"===t.transparent?e:t.transparent:0===jQuery.Color(e).alpha()?"$"===t.transparent?e:t.transparent:"$"===t.opaque?e:t.opaque}function fusionReturnColorAlphaInt(e){return"transparent"===e?1:1===jQuery.Color(e).alpha()?0:1}function fusionGlobalScriptSet(e,t){if(_.isUndefined(t.choice)||_.isUndefined(e[t.choice])||(e=e[t.choice]),_.isUndefined(t.callback)||_.isUndefined(window[t.callback])||!_.isFunction(window[t.callback])||(e=window[t.callback](e)),_.isUndefined(window.frames[0]))return e;if(t.condition&&t.condition[0]&&t.condition[1]&&t.condition[2]&&t.condition[3]&&t.condition[4])switch(t.condition[1]){case"===":e=fusionSanitize.getOption(t.condition[0])===t.condition[2]?t.condition[2].replace(/\$/g,e):t.condition[3].replace(/\$/g,e)}return _.isUndefined(window.frames[0][t.globalVar])&&(window.frames[0][t.globalVar]={}),_.isUndefined(t.id)?window.frames[0][t.globalVar]=e:window.frames[0][t.globalVar][t.id]=e,_.isUndefined(t.trigger)||_.each(t.trigger,function(e){fusionTriggerEvent(e),"function"==typeof window[e]?window[e]():"function"==typeof window.frames[0][e]&&window.frames[0][e]()}),_.isUndefined(t.runAfter)||_.each(t.runAfter,function(e){_.isFunction(e)&&window.frames[0][e]()}),e}function fusionTriggerEvent(e){"resize"===e?fusionTriggerResize():"scroll"===e?fusionTriggerScroll():"load"===e?fusionTriggerLoad():window.frames[0].dispatchEvent(new Event(e))}function fusionResize(){window.frames[0].dispatchEvent(new Event("resize"))}function fusionScroll(){window.frames[0].dispatchEvent(new Event("scroll"))}function fusionLoad(){window.frames[0].dispatchEvent(new Event("load"))}function fusionGetMediaQuery(e,t,i){var n,o=[],s="";return t||(t="only screen"),n=[t],_.each(e,function(e){"string"!=typeof e[0]?(n=[t],_.each(e,function(e){e[1]&&-1!==e[1].indexOf("px")&&-1===e[1].indexOf("dppx")&&(e[1]=parseInt(e[1],10)+"px"),n.push("("+e[0]+": "+e[1]+")")}),o.push(n.join(" and "))):(e[1]&&-1!==e.indexOf("px")&&-1===e.indexOf("dppx")&&(e[1]=parseInt(e[1],10)+"px"),n.push("("+e[0]+": "+e[1]+")"))}),_.isEmpty(o)||(s=o.join(", ")),s||(s=n.join(" and ")),i?"@media "+s:s}function fusionReturnMediaQuery(e){var t,i,n,o,s,a,r,l,u=360,d=0,c=fusionSanitize.getSettings();switch("top"!==c.header_position&&(d=parseInt(c.side_header_width,10)),640<(t=parseInt(c.grid_main_break_point,10))&&(u=t-640),r=(a=(s=(o=(n=(i=t+d)-(l=parseInt(u/5,10)))-l)-l)-l)-l,e){case"fusion-max-1c":return fusionGetMediaQuery([["max-width",r+"px"]]);case"fusion-max-2c":return fusionGetMediaQuery([["max-width",a+"px"]]);case"fusion-min-2c-max-3c":return fusionGetMediaQuery([["min-width",a+"px"],["max-width",s+"px"]]);case"fusion-min-3c-max-4c":return fusionGetMediaQuery([["min-width",s+"px"],["max-width",o+"px"]]);case"fusion-min-4c-max-5c":return fusionGetMediaQuery([["min-width",o+"px"],["max-width",n+"px"]]);case"fusion-min-5c-max-6c":return fusionGetMediaQuery([["min-width",n+"px"],["max-width",i+"px"]]);case"fusion-min-shbp":return fusionGetMediaQuery([["min-width",parseInt(c.side_header_break_point,10)+1+"px"]]);case"fusion-max-shbp":return fusionGetMediaQuery([["max-width",parseInt(c.side_header_break_point,10)+"px"]]);case"fusion-max-sh-shbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.side_header_break_point,10),10)+"px"]]);case"fusion-max-sh-cbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.content_break_point,10),10)+"px"]]);case"fusion-max-sh-sbp":return fusionGetMediaQuery([["max-width",parseInt(d+parseInt(c.sidebar_break_point,10),10)+"px"]]);case"fusion-max-shbp-retina":return fusionGetMediaQuery([[["max-width",parseInt(c.side_header_break_point,10)+"px"],["-webkit-min-device-pixel-ratio","1.5"]],[["max-width",parseInt(c.side_header_break_point,10)+"px"],["min-resolution","144dpi"]],[["max-width",parseInt(c.side_header_break_point,10)+"px"],["min-resolution","1.5dppx"]]]);case"fusion-max-sh-640":return fusionGetMediaQuery([["max-width",parseInt(d+640,10)+"px"]]);case"fusion-max-shbp-18":return fusionGetMediaQuery([["max-width",parseInt(parseInt(c.side_header_break_point,10)-18,10)+"px"]]);case"fusion-max-shbp-32":return fusionGetMediaQuery([["max-width",parseInt(parseInt(c.side_header_break_point,10)-32,10)+"px"]]);case"fusion-min-sh-cbp":return fusionGetMediaQuery([["min-width",parseInt(d+parseInt(c.content_break_point,10),10)+"px"]]);case"fusion-max-sh-965-woo":return fusionGetMediaQuery([["max-width",parseInt(d+965,10)+"px"]]);case"fusion-max-sh-900-woo":return fusionGetMediaQuery([["max-width",parseInt(d+900,10)+"px"]]);case"fusion-max-cbp":return fusionGetMediaQuery([["max-width",parseInt(c.content_break_point,10)+"px"]]);case"fusion-max-main":return fusionGetMediaQuery([["max-width",t+"px"]]);case"fusion-min-cbp-max-main":return fusionGetMediaQuery([["max-width",t+"px"],["min-width",parseInt(c.content_break_point,10)+"px"]]);case"fusion-min-768-max-1024":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"]]);case"fusion-min-768-max-1024-p":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"],["orientation","portrait"]]);case"fusion-min-768-max-1024-l":return fusionGetMediaQuery([["min-device-width","768px"],["max-device-width","1024px"],["orientation","landscape"]]);case"fusion-max-640":return fusionGetMediaQuery([["max-device-width","640px"]]);case"fusion-max-768":case"fusion-max-782":return fusionGetMediaQuery([["max-width","782px"]])}}function fusionGetPercentPaddingHorizontal(e,t){return fusionSanitize.getOption("hundredp_padding","hundredp_padding")||t}function fusionGetPercentPaddingHorizontalNegativeMargin(){var e=fusionGetPercentPaddingHorizontal(),t=parseFloat(e),i="";return i="-"+e,"%"===("string"==typeof e?e.replace(/\d+([,.]\d+)?/g,""):e)&&(i="-"+(i=t/(100-2*t)*100)+"%"),i}function fusionGetPercentPaddingHorizontalNegativeMarginIfSiteWidthPercent(e,t){return fusionSanitize.getSettings().site_width&&fusionSanitize.getSettings().site_width.indexOf("%")?fusionGetPercentPaddingHorizontalNegativeMargin():t}function fusionRecalcAllMediaQueries(){var e,t,i,n,o=["","avada-","fb-"],s=["","-bbpress","-gravity","-ec","-woo","-sliders","-eslider","-not-responsive","-cf7"];for(e in window.allFusionMediaIDs||(window.allFusionMediaIDs={},["max-sh-640","max-1c","max-2c","min-2c-max-3c","min-3c-max-4c","min-4c-max-5c","min-5c-max-6c","max-shbp","max-shbp-18","max-shbp-32","max-sh-shbp","min-768-max-1024-p","min-768-max-1024-l","max-sh-cbp","min-sh-cbp","max-sh-sbp","max-640","min-shbp"].forEach(function(e){o.forEach(function(t){s.forEach(function(i){window.allFusionMediaIDs[t+e+i+"-css"]=e})})})),window.allFusionMediaIDs)(t=window.frames[0].document.getElementById(e))&&(i=t.getAttribute("media"),(n=fusionReturnMediaQuery("fusion-"+window.allFusionMediaIDs[e]))!==i&&t.setAttribute("media",n))}function fusionRecalcVisibilityMediaQueries(){var e=fusionGetMediaQuery([["max-width",parseInt(fusionSanitize.getOption("visibility_small"),10)+"px"]])+"{body:not(.fusion-builder-ui-wireframe) .fusion-no-small-visibility{display:none !important;}}",t=fusionGetMediaQuery([["min-width",parseInt(fusionSanitize.getOption("visibility_small"),10)+"px"],["max-width",parseInt(fusionSanitize.getOption("visibility_medium"),10)+"px"]])+"{body:not(.fusion-builder-ui-wireframe) .fusion-no-medium-visibility{display:none !important;}}",i=fusionGetMediaQuery([["min-width",parseInt(fusionSanitize.getOption("visibility_medium"),10)+"px"]])+"{body:not(.fusion-builder-ui-wireframe) .fusion-no-large-visibility{display:none !important;}}";jQuery("#fb-preview").contents().find("head").find("#css-fb-visibility").length&&jQuery("#fb-preview").contents().find("head").find("#css-fb-visibility").remove(),jQuery("#fb-preview").contents().find("head").append('<style type="text/css" id="css-fb-visibility">'+e+t+i+"</style>")}FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.modalDialogMore=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-app-dialog-more-options").html()),attributes:{class:"fusion-builder-dialog-more-options"},elementView:"",events:{"click .fusion-panel-shortcut":"openElementSection","click .fusion-reset-default":"resetElementOptionsDefault","click .resize-icon-default":"resizePopupEvent","click .resize-icon-large":"resizePopupEvent","click .fusion-help-article":"helpArticle","click .dialog-more-remove-item":"removeElement"},initialize:function(){},render:function(e){var t,i,n,o="",s="",a=localStorage.getItem("resizePopupClass"),r="",l=FusionApp.data.fusionElementsOptions;return this.elementView=e.view,o=this.elementView.model.get("element_type"),this.elementView.model.get("params"),i=void 0!==(t=fusionAllElements[o]).help_url?t.help_url:"",void 0!==(n=l[o.replace("fusion_builder_","").replace("fusion_","")+"_shortcode_section"])&&(s=n.id),this.$el.html(this.template({helpURL:i,elementOption:s})),null!==a&&(r="left"===(a=(a=a.split("-"))[a.length-1])||"right"===a?"resize-icon-push-"+a:"resize-icon-"+a,this.$el.find("."+r).addClass("active")),this.$el.find(".fusion-builder-dialog-more-options").click(function(e){jQuery(".fusion-utility-menu-wrap").hasClass("active")||e.stopPropagation()}),jQuery(document).click(function(e){jQuery(e.target).closest(".fusion-builder-dialog-more-options").length||"dont-save no"===e.target.className||jQuery(".fusion-utility-menu-wrap").removeClass("active")}),jQuery("#fb-preview")[0].contentWindow.jQuery("body").click(function(){jQuery(".fusion-utility-menu-wrap").removeClass("active")}),this},openElementSection:function(e){var t=jQuery(e.currentTarget).data("fusion-option");e&&e.preventDefault(),FusionApp.sidebarView&&(FusionApp.sidebarView.togglePanelState("to",!0),FusionApp.sidebarView.switchActiveContext("#fusion-builder-sections-to","FBE"),FusionApp.sidebarView.$el.find("a#"+t).trigger("click"))},resetElementOptionsDefault:function(){var e=this;FusionApp.confirmationPopup({title:fusionBuilderText.reset_element_options,content:fusionBuilderText.reset_element_options_confirmation,actions:[{label:fusionBuilderText.cancel,classes:"no cancel",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.reset,classes:"save yes",callback:function(){var t=FusionPageBuilderViewManager.getView(e.elementView.model.get("cid")),i=e.elementView.model.get("element_type"),n=fusionAllElements[i],o=void 0!==n.params.element_content?n.params.element_content.value:"",s=jQuery.extend({},t.model.get("params")),a={};"fusion_builder_column"!==i&&"fusion_builder_column_inner"!==i||(a.type=s.type),""!==o&&(a.element_content=o),e.elementView.model.set("params",a),t.model.set("params",a),"function"==typeof t.destroyResizable&&t.destroyResizable(),"function"==typeof t.columnSpacing&&t.columnSpacing(),"function"==typeof t.paddingDrag&&t.paddingDrag(),"function"==typeof t.marginDrag&&t.marginDrag(),FusionApp.confirmationPopup({action:"hide"}),FusionApp.dialogCloseResets(e.elementView),t.reRender(),e.elementView.reRender(),FusionEvents.trigger("fusion-history-save-step",fusionBuilderText.reset+" "+n.name+" "+fusionBuilderText.element)}}]})},resizePopup:function(e){var t=jQuery(".ui-dialog:visible"),i=t.find(".fusion_builder_module_settings.ui-dialog-content"),n={};return"fusion-settings-dialog-default"===e?(n={resizable:!0,draggable:!0,width:FusionApp.dialog.dialogData.width,height:FusionApp.dialog.dialogData.height,position:FusionApp.dialog.dialogData.position}).position.of=window:"fusion-settings-dialog-large"===e&&(n={resizable:!1,draggable:!1,width:"85%",height:.85*jQuery(window).height()-t.find(".ui-dialog-titlebar").height(),position:{my:"center",at:"center",of:window}}),jQuery.each(n,function(e,t){i.dialog("option",e,t)}),n},resizePopupEvent:function(e){var t=jQuery(e.currentTarget),i=t.data("resize-key");this.updatePopupClass(i),this.resizePopup(i),t.siblings(".resize-icon").removeClass("active"),t.addClass("active"),t.closest(".fusion-utility-menu-wrap").removeClass("active")},helpArticle:function(e){jQuery(e.currentTarget).closest(".fusion-utility-menu-wrap").removeClass("active")},updatePopupClass:function(e){jQuery("body").removeClass("fusion-settings-dialog-default fusion-settings-dialog-large"),jQuery("body").addClass(e),localStorage.setItem("resizePopupClass",e)},removeElement:function(e){var t=this,i=FusionPageBuilderViewManager.getView(t.elementView.model.get("cid"));FusionApp.confirmationPopup({title:fusionBuilderText.delete_element,content:fusionBuilderText.remove_element_options_confirmation,actions:[{label:fusionBuilderText.cancel,classes:"no cancel",callback:function(){FusionApp.confirmationPopup({action:"hide"})}},{label:fusionBuilderText.delete,classes:"dont-save",callback:function(){FusionApp.confirmationPopup({action:"hide"}),FusionApp.dialogCloseResets(t.elementView),"fusion_builder_column"===i.model.attributes.type||"fusion_builder_column_inner"===i.model.attributes.type?i.removeColumn(e):"fusion_builder_container"===i.model.attributes.type?i.removeContainer(e):i.removeElement(e)}}]})}})});