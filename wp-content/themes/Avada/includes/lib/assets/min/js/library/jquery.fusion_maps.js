!function(e,s,t,o){"use strict";var n="fusion_maps",i={addresses:{},address_pin:!0,animations:!0,delay:10,infobox_background_color:!1,infobox_styling:"default",infobox_text_color:!1,map_style:"default",map_type:"roadmap",marker_icon:!1,overlay_color:!1,overlay_color_hsl:{},pan_control:!0,show_address:!0,scale_control:!0,scrollwheel:!0,zoom:9,zoom_control:!0};function a(s,t){this.element=s,this.settings=e.extend({},i,t),this._defaults=i,this._name=n,this.geocoder=new google.maps.Geocoder,this.next_address=0,this.infowindow=new google.maps.InfoWindow,this.markers=[],this.query_sent=!1,this.last_cache_index="none",this.bounds=new google.maps.LatLngBounds,this.init()}e.extend(a.prototype,{init:function(){var e,s,t,o={zoom:this.settings.zoom,mapTypeId:this.settings.map_type,scrollwheel:this.settings.scrollwheel,scaleControl:this.settings.scale_control,panControl:this.settings.pan_control,zoomControl:this.settings.zoom_control},n=this;this.settings.scrollwheel||(o.gestureHandling="cooperative",delete o.scrollwheel),this.settings.address_pin||(this.settings.addresses=[this.settings.addresses[0]]),jQuery.each(this.settings.addresses,function(e){!1===this.cache&&(n.last_cache_index=e)}),this.settings.addresses[0].coordinates&&(e=new google.maps.LatLng(this.settings.addresses[0].latitude,this.settings.addresses[0].longitude),o.center=e),this.map=new google.maps.Map(this.element,o),this.settings.overlay_color&&"custom"===this.settings.map_style&&(s=[{stylers:[{hue:this.settings.overlay_color},{lightness:2*this.settings.overlay_color_hsl.lum-100},{saturation:2*this.settings.overlay_color_hsl.sat-100}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"labels"}],this.map.setOptions({styles:s})),t=google.maps.event.addListener(this.map,"bounds_changed",function(){var e=new google.maps.LatLng(n.settings.addresses[0].latitude,n.settings.addresses[0].longitude);n.map.setZoom(n.settings.zoom),n.map.setCenter(e),google.maps.event.removeListener(t)}),this.next_geocode_request()},geocode_address:function(e,s){var t,o,n,i,a,d=this,r=!0;"object"==typeof e&&!1===e.cache?(r=!1,o=!0===e.coordinates?{latLng:t=new google.maps.LatLng(e.latitude,e.longitude)}:{address:e.address},this.geocoder.geocode(o,function(o,n){var i,a,l,g;n===google.maps.GeocoderStatus.OK?(!0===e.coordinates?(l=t,i=jQuery.trim(e.latitude),a=jQuery.trim(e.longitude)):(i=(l=o[0].geometry.location).lat(),a=l.lng()),d.settings.addresses[s].latitude=i,d.settings.addresses[s].longitude=a,!0===e.coordinates&&""===e.infobox_content&&(e.geocoded_address=o[0].formatted_address),1!==d.next_address&&"1"!==d.next_address&&!0!==d.next_address||e.coordinates||d.map.setCenter(l),d.settings.address_pin&&d.create_marker(e,i,a,s),0!==d.next_address&&"0"!==d.next_address&&!1!==d.next_address||d.map.setCenter(l)):n===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&(d.next_address--,d.settings.delay++),!1===r&&!1===d.query_sent&&d.last_cache_index===s&&"undefined"!=typeof fusionMapNonce&&(g={action:"fusion_cache_map",addresses:d.settings.addresses,security:fusionMapNonce},jQuery.post(fusionMapsVars.admin_ajax,g),d.query_sent=!0),d.next_geocode_request()})):"object"==typeof e&&!0===e.cache&&(n=jQuery.trim(e.latitude),i=jQuery.trim(e.longitude),a=new google.maps.LatLng(n,i),!0===e.coordinates&&""===e.infobox_content&&(e.geocoded_address=e.geocoded_address),d.settings.address_pin&&d.create_marker(e,n,i,s),0!==d.next_address&&"0"!==d.next_address&&!1!==d.next_address||d.map.setCenter(a),d.next_geocode_request())},create_marker:function(e,s,t,o){var n,i,a={position:new google.maps.LatLng(s,t),map:this.map};this.bounds.extend(a.position),e.infobox_content?n=e.infobox_content:(n=e.address,!0===e.coordinates&&e.geocoded_address&&(n=e.geocoded_address)),this.settings.animations&&(a.animation=google.maps.Animation.DROP),"custom"===this.settings.map_style&&"theme"===this.settings.marker_icon?a.icon=new google.maps.MarkerImage(e.marker,null,null,null,new google.maps.Size(37,55)):"custom"===this.settings.map_style&&e.marker&&(a.icon=e.marker),i=new google.maps.Marker(a),this.markers.push(i),this.create_infowindow(n,i),o+1>=this.settings.addresses.length&&this.map.setCenter(this.bounds.getCenter()),this.map.setZoom(this.settings.zoom)},create_infowindow:function(e,s){var o,n,i,a=this;"custom"===this.settings.infobox_styling&&"custom"===this.settings.map_style?(i={content:n=t.createElement("div"),disableAutoPan:!0,maxWidth:150,pixelOffset:new google.maps.Size(-125,10),zIndex:null,boxStyle:{background:"none",opacity:1,width:"250px"},closeBoxMargin:"2px 2px 2px 2px",closeBoxURL:"//www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(1,1)},n.className="fusion-info-box",n.style.cssText="background-color:"+this.settings.infobox_background_color+";color:"+this.settings.infobox_text_color+";",n.innerHTML=e,o=new InfoBox(i),this.settings.show_address&&o.open(this.map,s),google.maps.event.addListener(s,"click",function(){var e=o.getMap();null===e||void 0===e?o.open(a.map,this):o.close(a.map,this)})):(o=new google.maps.InfoWindow({disableAutoPan:!0,content:e}),this.settings.show_address&&(o.show=!0,o.open(this.map,s)),google.maps.event.addListener(s,"click",function(){var e=o.getMap();null===e||void 0===e?o.open(a.map,this):o.close(a.map,this)}))},next_geocode_request:function(){var e=this;e.next_address<e.settings.addresses.length&&setTimeout(function(){e.geocode_address(e.settings.addresses[e.next_address],e.next_address),e.next_address++},e.settings.delay)}}),e.fn[n]=function(s){return this.each(function(){e.data(this,"plugin_"+n)||e.data(this,"plugin_"+n,new a(this,s))}),this}}(jQuery,window,document);