!function(i){"use strict";fusionredux.field_objects=fusionredux.field_objects||{},fusionredux.field_objects.sorter=fusionredux.field_objects.sorter||{};var e="";i(document).ready(function(){}),fusionredux.field_objects.sorter.init=function(t){t||(t=i(document).find(".fusionredux-group-tab:visible").find(".fusionredux-container-sorter:visible")),i(t).each(function(){var t=i(this),s=t;t.hasClass("fusionredux-field-container")||(s=t.parents(".fusionredux-field-container:first")),s.is(":hidden")||s.hasClass("fusionredux-field-init")&&(s.removeClass("fusionredux-field-init"),t.find(".fusionredux-sorter").each(function(){var s=i(this).attr("id");t.find("#"+s).find("ul").sortable({items:"li",placeholder:"placeholder",connectWith:".sortlist_"+s,opacity:.8,scroll:!1,out:function(t,s){s.helper&&(e=s.offset.top>0?"down":"up",fusionredux.field_objects.sorter.scrolling(i(this).parents(".fusionredux-field-container:first")))},over:function(i,t){e=""},deactivate:function(i,t){e=""},stop:function(e,t){var s=fusionredux.sorter[i(this).attr("data-id")],r=i(this).find("h3").text();s.limits&&r&&s.limits[r]&&(i(this).children("li").length>=s.limits[r]?(i(this).addClass("filled"),i(this).children("li").length>s.limits[r]&&i(t.sender).sortable("cancel")):i(this).removeClass("filled"))},update:function(e,t){var s=fusionredux.sorter[i(this).attr("data-id")],r=i(this).find("h3").text();s.limits&&r&&s.limits[r]&&(i(this).children("li").length>=s.limits[r]?(i(this).addClass("filled"),i(this).children("li").length>s.limits[r]&&i(t.sender).sortable("cancel")):i(this).removeClass("filled")),i(this).find(".position").each(function(){var e=i(this).parent().attr("data-id"),t=i(this).parent().parent().attr("data-group-id");fusionredux_change(i(this));var s=i(this).parent().parent().parent().attr("id");i(this).prop("name",fusionredux.args.opt_name+"["+s+"]["+t+"]["+e+"]")})}}),t.find(".fusionredux-sorter").disableSelection()}))})},fusionredux.field_objects.sorter.scrolling=function(i){if(void 0!==i){var t=i.find(".fusionredux-sorter");"up"==e?(t.scrollTop(t.scrollTop()-20),setTimeout(fusionredux.field_objects.sorter.scrolling,50)):"down"==e&&(t.scrollTop(t.scrollTop()+20),setTimeout(fusionredux.field_objects.sorter.scrolling,50))}}}(jQuery);