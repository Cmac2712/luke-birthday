var FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(i){var t,n={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(e){return(t=t||_.template(i,null,n))(e)}}),function(e){"undefined"!=typeof module&&module.exports?module.exports=e():"function"==typeof define?define(e):this.fusionBuilderStickyHeader=e()}(function(){return function(o,e){var a,i,n,s=document.getElementById("fusion_builder_container"),l=e||0,r=m(o),u=document.getElementById("fusion_builder_main_container"),d={position:"fixed",top:l+"px",left:r.left+"px",width:r.width+"px","border-top":"22px solid #ffffff","z-index":999},c={};function f(){var e,i,t,n=jQuery("#fusion_builder_controls").height();if(a=m(u),e="fixed"===jQuery("#fusion_builder_controls").css("position")?a.height+r.height-n:a.height,jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),p().top>r.top-l-22&&p().top+l+22+r.height<a.top+e){for(t in i=s.left+"px",d.left=i,d.width=jQuery("#fusion_builder_container").outerWidth()+"px",d)o.style[t]=d[t];jQuery(".fusion-builder-update-buttons").stop().animate({bottom:0},100)}else{for(t in c)o.style[t]=c[t];p().top+l+22+r.height<a.top&&jQuery(".fusion-builder-update-buttons").stop().animate({bottom:"-50px"},100)}}function m(e){var i,t,n=e.getBoundingClientRect(),o=p();return t=n.top+o.top,jQuery(e).parents("#fusion_builder_layout").hasClass("closed")&&(t=(i=jQuery(e).parents("#fusion_builder_layout").find(".ui-sortable-handle")[0].getBoundingClientRect()).top+i.height+o.top),{left:n.left+o.left,top:t,width:n.width,height:n.height}}function p(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}}["position","top","left","z-index","border-top"].forEach(function(e){c[e]=o.style[e],c.width="100%"}),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),window.onscroll&&(i=window.onscroll),window.onresize&&(n=window.onresize),window.onscroll=function(e){f(),i&&i(e)},window.onresize=function(e){var i=jQuery("#fusion_builder_container").outerWidth()+"px",t=u.top;r=m(o),void 0!==a&&a.top!==t&&(o.style.position="absolute",r=m(o)),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),p().top>r.top-l?o.style.width=i:o.style.width=c.width,f(),n&&n(e)}}});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){FusionPageBuilder.Element=Backbone.Model.extend({defaults:{type:"element"}})});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){var e,n=[],o=[],a=[],t=0,s=[],l=jQuery("#content").text();e=_.sortBy(fusionAllElements,function(e){return e.name.toLowerCase()}),_.each(e,function(e){var i,t=o;void 0===e.hide_from_builder&&(i={title:e.name,label:e.shortcode},void 0!==e.component&&e.component&&(t=a),void 0===e.generator_only&&n.push(i),t.push(Object.assign({},i,{generator_only:void 0!==e.generator_only||e.generator_only,templates:void 0!==e.templates&&e.templates,components_per_template:void 0!==e.components_per_template&&e.components_per_template})))}),a.forEach(function(e){var i=new RegExp("\\["+e.label,"g");s[e.label]=(l.match(i)||[]).length,"string"!=typeof fusionBuilderConfig.template_category||"object"==typeof e.templates&&!e.templates.includes(fusionBuilderConfig.template_category)||t++}),FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{modules:n,generator_elements:o,components:a,componentsCounter:t,usedComponents:s,elementCount:0,views:{}},getView:function(e){return this.get("views")[e]},getChildViews:function(t){var e=this.get("views"),n={};return _.each(e,function(e,i){t===e.model.attributes.parent&&(n[i]=e)}),n},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,i){var t=this.get("views");t[e]=i,this.set({views:t})},removeView:function(t){var e=this.get("views"),n={};_.each(e,function(e,i){i!=t&&(n[i]=e)}),this.set({views:n})},removeViews:function(){this.set({views:{}})},countElementsByType:function(i){var e=this.get("views"),t=0;return _.each(e,function(e){e.model.attributes.type===i&&t++}),t}}),window.FusionPageBuilderViewManager=new FusionPageBuilder.ViewManager});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.DynamicValues=Backbone.Model.extend({defaults:{values:{},options:{},optionTypes:{},orderedParams:!1},getOrderedParams:function(){var o=this.get("orderedParams"),e=this.getOptions();return o||(o={},_.each(e,function(e,i){var t,n;"object"==typeof e&&(n=t=e.group,"string"!=typeof e.group&&(t="other",n=fusionBuilderText.other),t=t.replace(/\s+/g,"_").toLowerCase(),"object"!=typeof o[t]&&(o[t]={label:"",params:{}}),o[t].label=n,o[t].params[i]=e)})),o},addData:function(e,i,t){this.set("values",e),this.set("options",i),this.set("optionTypes",t)},supportsType:function(e){var i=_.values(this.getOptionTypes());return-1!==_.indexOf(i,e)},getOptionTypes:function(){var e=this.get("optionTypes");return jQuery.extend(!0,{},e)},getOptions:function(){var e=this.get("options");return jQuery.extend(!0,{},e)},getOption:function(e){var i=this.getOptions();return void 0!==i[e]&&i[e]},getAll:function(){var e=this.get("values");return jQuery.extend(!0,{},e)}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.DynamicParams=Backbone.Model.extend({defaults:{params:{},elementView:!1,backup:{}},initialize:function(){},setData:function(e){"object"==typeof e&&this.set("params",e)},getAll:function(){var e=this.get("params");return jQuery.extend(!0,{},e)},createBackup:function(){this.set("backup",this.getAll())},restoreBackup:function(){this.set("params",this.get("backup")),this.set("backup",{})},hasDynamicParam:function(e){return void 0!==this.getAll()[e]},addParam:function(e,t){var i=this.getAll(),n=FusionPageBuilderApp.dynamicValues.getOptions();"object"!=typeof t&&(t={data:t}),_.each(n[t.data].fields,function(e,i){void 0===t[i]&&(void 0!==e.default?t[i]=e.default:void 0!==e.value&&(t[i]=e.value))}),i[e]=t,this.set("params",i),FusionPageBuilderEvents.trigger("fusion-dynamic-data-added",e)},updateParam:function(e,i,t){var n=this.getAll();"object"==typeof n[e]&&(n[e][i]=t,this.set("params",n))},removeParam:function(e){var i=this.getAll();this.get("elementView");delete i[e],this.set("params",i),FusionPageBuilderEvents.trigger("fusion-dynamic-data-removed",e)}});FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Collection=Backbone.Collection.extend({model:FusionPageBuilder.Element}),window.FusionPageBuilderElements=new FusionPageBuilder.Collection});FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.ElementView=window.wp.Backbone.View.extend({className:"fusion_module_block fusion_builder_column_element",template:FusionPageBuilder.template(c("#fusion-builder-block-module-template").html()),events:{"click .fusion-builder-settings":"showSettings","click .fusion-builder-clone-module":"cloneElement","click .fusion-builder-remove":"removeElement","click .fusion-builder-save-module-dialog":"saveElementDialog"},initialize:function(){this.elementIsCloning=!1,this.initDynamicParams()},initDynamicParams:function(){var e="object"==typeof this.model.get("params")?this.model.get("params"):{},i=e.dynamic_params;if("string"==typeof e.dynamic_params&&""!==e.dynamic_params)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(i))===i&&(i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)),this.model.set("dynamic_params",i)}catch(e){}},render:function(){return this.$el.html(this.template(this.model.attributes)),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},saveElementDialog:function(e){e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),c("#fusion-builder-layouts-elements-trigger").click(),c("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(e){var i=this.getElementContent(),t=c("#fusion_builder_main_container"),n=c("#fusion-builder-save-element-input").val(),o=c("#fusion_save_global").is(":checked"),a=c("#fusion-builder-layouts-elements .fusion-page-layouts"),s=c("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),l=this.model,r=!1,u=null,d={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<t.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(u=this.model.attributes.params.fusion_global,delete(d=this.model.get("params")).fusion_global,this.model.set("params",d),i=this.getElementContent(),d.fusion_global=u,this.model.set("params",d)),c.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),n.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),!(r=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==r&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==n?c.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:n,fusion_save_global:o,fusion_layout_content:i,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,a.prepend(e.responseText),c(".fusion-save-element-fields").remove(),s.hide(),o&&(l.attributes.params.fusion_global=c(e.responseText).attr("data-layout_id"),c('div.fusion_builder_column_element[data-cid="'+l.get("cid")+'"]').addClass("fusion-global-element"),c('div.fusion_builder_column_element[data-cid="'+l.get("cid")+'"]').attr("fusion-global-layout",c(e.responseText).attr("data-layout_id")),c('div.fusion_builder_column_element[data-cid="'+l.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+l.get("cid")+'"><span>'+fusionBuilderText.global_element+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,l.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getElementContent:function(){return FusionPageBuilderApp.generateElementShortcode(this.$el,!1)},removeElement:function(e){var i;e&&e.preventDefault(),i=this.model.get("parent"),void 0!==fusionAllElements[this.model.get("element_type")].component&&!0===fusionAllElements[this.model.get("element_type")].component&&FusionPageBuilderViewManager.defaults.usedComponents[this.model.get("element_type")]--,FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,i)},cloneElement:function(e,i){var t;e&&e.preventDefault(),-1===this.$el.children(".fusion-builder-module-controls-container").attr("class").indexOf("fusion_tb_")&&!0!==this.elementIsCloning&&(this.elementIsCloning=!0,(t=c.extend(!0,{},this.model.attributes)).created="manually",t.cid=FusionPageBuilderViewManager.generateCid(),t.targetElement=this.$el,"undefined"!==t.from&&delete t.from,i&&(t.parent=i),FusionPageBuilderApp.collection.add(t),i||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.elementIsCloning=!1,e&&FusionPageBuilderEvents.trigger("fusion-element-cloned"),t.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t.parent))},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),c("body").append(i.render().el)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ElementPreviewView=window.wp.Backbone.View.extend({className:"fusion_module_block_preview ",dynamicParams:{},contentPreviewElements:["fusion_text","fusion_title","fusion_alert","fusion_button","fusion_imageframe","fusion_sharing"],globalIconPlaceholder:"#fusion_dynamic_data_icon#",initialize:function(){this.dynamicParams=this.options.dynamicParams,jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).length?this.template=FusionPageBuilder.template(jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).html()):this.template=FusionPageBuilder.template(jQuery("#fusion-builder-block-module-default-preview-template").html())},render:function(){var e=this.template(this.getTemplateAttributes());return this.$el.html(this.updatePreview(e)),this},getTemplateAttributes:function(){var e=jQuery.extend(!0,{},this.model.attributes),i=this.getDynamicData(),t="";return-1!==this.contentPreviewElements.indexOf(this.model.attributes.element_type)&&(_.isEmpty(i)||void 0===i.element_content||(t="","undefined"!=typeof FusionApp&&void 0!==FusionApp.data.dynamicOptions[i.element_content.data]?t=FusionApp.data.dynamicOptions[i.element_content.data].label:void 0!==fusionDynamicData.dynamicOptions[i.element_content.data]&&(t=fusionDynamicData.dynamicOptions[i.element_content.data].label),e.params.element_content=this.globalIconPlaceholder+t)),e},updatePreview:function(e){var i,t=this.getDynamicData(),n=[],o=!1,a='<span class="fusiona-dynamic-data"></span>',s="",l="";return void 0!==this.model.attributes.multi&&"multi_element_parent"===this.model.attributes.multi&&void 0!==this.model.attributes.params.element_content&&-1!==this.model.attributes.params.element_content.indexOf("dynamic_params")&&(o=!0),-1!==this.contentPreviewElements.indexOf(this.model.attributes.element_type)||_.isEmpty(t)&&!o||(i=jQuery("<div />",{html:e}),o&&(i.find("ul").remove(),void 0!==fusionAllElements[this.model.attributes.element_type]&&void 0!==fusionAllElements[fusionAllElements[this.model.attributes.element_type].element_child]&&(l=fusionAllElements[fusionAllElements[this.model.attributes.element_type].element_child].name,n.push(l))),_.each(t,function(e){s="","undefined"!=typeof FusionApp&&void 0!==FusionApp.data.dynamicOptions[e.data]?s=FusionApp.data.dynamicOptions[e.data].label:void 0!==fusionDynamicData.dynamicOptions[e.data]&&(s=fusionDynamicData.dynamicOptions[e.data].label),n.push(s)}),i.append('<div class="fusion-builder-dynamic-data-preview fusion-builder-dynamic-data-preview-inline">'+a+n.join(", ")+"</div>"),e=i.html()),e.replace(this.globalIconPlaceholder,a)},getDynamicData:function(){var e={};return void 0!==this.dynamicParams?e=this.dynamicParams.getAll():void 0!==this.model.attributes.dynamic_params&&(e=this.model.attributes.dynamic_params),e}})});FusionPageBuilder=FusionPageBuilder||{};!function(u){u(document).ready(function(){FusionPageBuilder.ElementLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(u("#fusion-builder-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element:not(.fusion-builder-element-generator,.fusion-builder-disabled-element)":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),FusionPageBuilderApp.showSavedElements("elements",this.$el.find("#custom-elements")),"true"===FusionPageBuilderApp.innerColumn&&this.$el.addClass("fusion-add-to-nested"),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomModule:function(t){var e,i,n;t&&t.preventDefault(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,e=u(t.currentTarget).closest("li").data("layout_id"),i=u(t.currentTarget).find(".fusion_module_title").text(),n=u(t.currentTarget).closest("li").hasClass("fusion-global"),u(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),u(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),u.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:n,fusion_layout_id:e},success:function(e){var i=JSON.parse(e);FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,u(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),u(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentColumnId)},complete:function(){fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_element+i,FusionPageBuilderEvents.trigger("fusion-element-added")}}))},addModule:function(e){var i,t,n,o,a,s,l;e&&e.preventDefault(),(i=u(e.currentTarget).find(".fusion_module_label").text())in fusionAllElements?(t=fusionAllElements[i].params,o=fusionAllElements[i].multi,a=fusionAllElements[i].shortcode,s=fusionAllElements[i].name,l=fusionAllElements[i].allow_generator,n=fusionAllElements[i].params,t={},_.each(n,function(e){t[e.param_name]=_.isObject(e.value)?e.default:e.value})):l=a=o=t="",e&&(window.fusionHistoryState=fusionBuilderText.added+" "+s+" "+fusionBuilderText.element),this.collection.add([{type:"element",added:"manually",cid:FusionPageBuilderViewManager.generateCid(),element_type:a,params:t,parent:this.attributes["data-parent_cid"],view:this.options.view,allow_generator:l,multi:o}]),void 0!==fusionAllElements[i].component&&!0===fusionAllElements[i].component&&FusionPageBuilderViewManager.defaults.usedComponents[a]++,this.remove(),FusionPageBuilderEvents.trigger("fusion-element-added")},addNestedColumns:function(e,i){var n,o,t,a,s,l,r;e&&e.preventDefault(),n=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_row_inner",element_type:"fusion_builder_row_inner",cid:n,parent:this.model.get("cid"),view:this,appendAfter:i}]),FusionPageBuilderApp.activeModal="column",o=this,t=(u(e.target).is("li")?u(e.target):u(e.target).closest("li")).data("layout").split(","),_.size(t),a=this.options.view,s=fusionAllElements.fusion_builder_column_inner.params,l={},_.each(s,function(e){r=_.isObject(e.value)?e.default:e.value,l[e.param_name]=r}),_.each(t,function(e,i){var t={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:n,layout:e,view:a,params:l};o.collection.add([t])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.GeneratorElementsView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(c("#fusion-builder-generator-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addElement","click .fusion-builder-column-layouts .generator-column":"addColumns","click .fusion-builder-column-layouts .generator-section":"addContainer"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addElement:function(e){var i,t,n,o,a,s,l,r;e&&e.preventDefault(),(i=c(e.currentTarget)).find(".fusion_module_title").text(),a=(t=i.find(".fusion_module_label").text())in fusionAllElements?(o=fusionAllElements[t].multi,fusionAllElements[t].shortcode):o=n="",l=c.extend(!0,{},fusionAllElements[t].params),n={},_.each(l,function(e){var i;i=_.isObject(e.value)?e.default:e.value,n[e.param_name]=i}),r={type:"generated_element",added:"manually",element_type:a,params:n,view:this.options.view,multi:o,cid:FusionPageBuilderViewManager.generateCid()},"undefined"!==n.element_content&&"undefined"!=typeof tinyMCE&&"undefined"!==tinyMCE.activeEditor&&void 0===o&&window.tinyMCE.activeEditor&&(s=window.tinyMCE.activeEditor.selection.getContent())&&(r.params.element_content=s,window.tinyMCE.activeEditor.selection.setContent(""),s="",delete r.added),this.collection.add(r),this.remove()},addColumns:function(e){var n,i,o,t,a,s,l,r="[fusion_builder_row_inner]",u="fusion_builder_column_inner",d="[/fusion_builder_row_inner]";!FusionPageBuilderApp.builderActive&&jQuery(e.target).parents("#builder-regular-columns").length&&(u="fusion_builder_column",d=r=""),e&&e.preventDefault(),FusionPageBuilderApp.activeModal="column",n=this,i=(c(e.target).is("li")?c(e.target):c(e.target).closest("li")).data("layout").split(","),_.size(i),o=this.options.view,t=fusionAllElements[u].params,a={},_.each(t,function(e){s=_.isObject(e.value)?e.default:e.value,a[e.param_name]=s}),_.each(i,function(e,i){var t;a.type=e,t={type:"generated_element",added:"manually",element_type:u,layout:e,view:o,params:a},l=n.collection.add(t),r+=FusionPageBuilderApp.generateElementShortcode(l,!1,!0)}),r+=d,fusionBuilderInsertIntoEditor(r,FusionPageBuilderApp.shortcodeGeneratorEditorID),FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID="",this.remove()},addContainer:function(e){var i,t,n;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="container",FusionPageBuilderViewManager.generateCid(),i=fusionAllElements.fusion_builder_container.params,t={},_.each(i,function(e){n=_.isObject(e.value)?e.default:e.value,t[e.param_name]=n}),this.collection.add([{type:"generated_element",added:"manually",element_type:"fusion_builder_container",params:t,view:this}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.ContainerView=window.wp.Backbone.View.extend({className:"fusion_builder_container",template:FusionPageBuilder.template(c("#fusion-builder-container-template").html()),events:{"click .fusion-builder-clone-container":"cloneContainer","click .fusion-builder-remove":"removeContainer","click .fusion-builder-section-add":"addContainer","click .fusion-builder-toggle":"toggleContainer","click .fusion-builder-settings-container":"showSettings","paste .fusion-builder-section-name":"renameContainer","keydown .fusion-builder-section-name":"renameContainer","click .fusion-builder-save-element":"saveElementDialog"},initialize:function(){this.typingTimer,this.doneTypingInterval=800},render:function(){return this.$el.html(this.template(this.model.toJSON())),void 0!==this.model.attributes.params.admin_toggled&&"yes"===this.model.attributes.params.admin_toggled&&(this.$el.addClass("fusion-builder-section-folded"),this.$el.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-container",this.model.attributes.params.fusion_global,this.model.get("cid")),this.updateStatusIcons(),this},updateStatusIcons:function(){var e=this.$el.find(".fusion-builder-container-utility-toolbar"),i="";e.find(".fusion-builder-publish-tooltip").remove(),"draft"===this.model.attributes.params.status?(i='<div class="fusion-builder-publish-tooltip fusion-container-draft" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_draft+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i)):"published_until"!==this.model.attributes.params.status&&"publish_after"!==this.model.attributes.params.status||(i='<div class="fusion-builder-publish-tooltip fusion-container-scheduled" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_scheduled+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i))},saveElement:function(e){var i=this.getContainerContent(),t=c("#fusion_builder_main_container"),o=c("#fusion-builder-save-element-input").val(),n=c("#fusion_save_global").is(":checked"),a=c("#fusion-builder-layouts-sections .fusion-page-layouts"),s=c("#fusion-builder-layouts-sections .fusion-empty-library-message"),l=this.model,r=!1,u=null,d={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<t.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(u=this.model.attributes.params.fusion_global,delete(d=this.model.get("params")).fusion_global,this.model.set("params",d),i=this.getContainerContent(),d.fusion_global=u,this.model.set("params",d)),c.each(jQuery("ul.fusion-page-layouts.fusion-layout-sections li"),function(e,i){var t,n=jQuery(this).find("h4.fusion-page-layout-title");if(n.length&&(t=(t=n.html().split("<div ")[0]).replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===t.toLowerCase().trim()))return alert(fusionBuilderText.duplicate_element_name_error),!(r=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==r&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?c.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:n,fusion_layout_content:i,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"sections"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,a.prepend(e.responseText),c(".fusion-save-element-fields").remove(),s.hide(),n&&(l.attributes.params.fusion_global=c(e.responseText).attr("data-layout_id"),c('div[data-cid="'+l.get("cid")+'"]').closest(".fusion_builder_container").addClass("fusion-global-container"),c('div[data-cid="'+l.get("cid")+'"]').attr("fusion-global-layout",c(e.responseText).attr("data-layout_id")),c('div[data-cid="'+l.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").length?c('div[data-cid="'+l.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+l.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"):c('div[data-cid="'+l.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+l.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0)}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getContainerContent:function(e,i,t){var n="",o=this.$el.find(".fusion-builder-section-content");return n+=FusionPageBuilderApp.generateElementShortcode(this.$el,!0),o.find(".fusion_builder_row").each(function(){var e=c(this);n+="[fusion_builder_row]",e.find(".fusion-builder-column-outer").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);n+=t.getColumnContent(e)}),n+="[/fusion_builder_row]"}),n+="[/fusion_builder_container]"},saveElementDialog:function(e){var i;i=void 0!==this.model.get("admin_label")&&""!==this.model.get("admin_label")?this.model.get("admin_label"):"",e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),c("#fusion-builder-layouts-sections-trigger").click(),c("#fusion-builder-layouts-sections .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="'+i+'" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_section+"</a></div></div>")},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),c("body").append(i.render().el),this.hideHundredPercentOption()},hideHundredPercentOption:function(){var e=jQuery("#page_template"),i=jQuery("#pyre_blog_width_100").val(),t=jQuery("#pyre_portfolio_width_100").val(),n=jQuery('.fusion_builder_container li[data-option-id="hundred_percent"]');jQuery("body").hasClass("fusion-tb-section-edit")?"no"===jQuery("#pyre_fusion_tb_section_width_100").val()&&n.hide():void 0!==i?("no"===i||"default"===i&&""===FusionPageBuilderApp.fullWidth)&&n.hide():void 0!==t?("no"===t||"default"===t&&""===FusionPageBuilderApp.fullWidth)&&n.hide():"100-width.php"!==e.val()&&n.hide()},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),FusionPageBuilderApp.activeModal=""},addRow:function(){var e=FusionPageBuilderViewManager.generateCid();this.collection.add([{type:"fusion_builder_row",element_type:"fusion_builder_row",added:"manually",cid:e,parent:this.model.get("cid"),view:this}])},cloneContainer:function(e){var o;e&&e.preventDefault(),(o=c.extend(!0,{},this.model.attributes)).cid=FusionPageBuilderViewManager.generateCid(),o.created="manually",o.view=this,FusionPageBuilderApp.collection.add(o),this.$el.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),n=c.extend(!0,{},t.attributes);n.created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=o.cid,FusionPageBuilderApp.collection.add(n),e.find(".fusion-builder-column-outer").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),s=c.extend(!0,{},t.attributes);s.created="manually",s.cid=FusionPageBuilderViewManager.generateCid(),s.parent=n.cid,s.from="fusion_builder_container",s.cloned=!0,FusionPageBuilderApp.collection.add(s),e.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var e,i,t,n,o,a;c(this).hasClass("fusion_module_block")?(e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(n=c.extend(!0,{},t.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=s.cid,n.from="fusion_builder_container",FusionPageBuilderApp.collection.add(n)):c(this).hasClass("fusion_builder_row_inner")&&(o=c(this).data("cid"),void 0!==(a=FusionPageBuilderViewManager.getView(o))&&a.cloneNestedRow("",s.cid))})})}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_section,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeContainer:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")&&e.removeRow()}),1<FusionPageBuilderViewManager.countElementsByType("fusion_builder_container")||(FusionPageBuilderApp.blankPage=!0),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),!0!==FusionPageBuilderApp.blankPage?e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_section,FusionPageBuilderEvents.trigger("fusion-element-removed")):FusionPageBuilderApp.clearBuilderLayout(!0)},toggleContainer:function(e){var i=c(e.currentTarget);e&&e.preventDefault(),this.$el.toggleClass("fusion-builder-section-folded"),i.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down"),this.$el.hasClass("fusion-builder-section-folded")?this.model.attributes.params.admin_toggled="yes":this.model.attributes.params.admin_toggled="no",FusionPageBuilderEvents.trigger("fusion-element-edited")},renameContainer:function(e){var i,t;if(13==(e.keyCode||e.which))return e.preventDefault(),this.$el.find(".fusion-builder-section-name").blur(),!1;i=this.model,t=this.$el.find(".fusion-builder-section-name"),clearTimeout(this.typingTimer),this.typingTimer=setTimeout(function(){i.attributes.params.admin_label=t.val().replace(/[[\]]+/g,""),FusionPageBuilderEvents.trigger("fusion-element-edited")},this.doneTypingInterval)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BlankPageView=window.wp.Backbone.View.extend({className:"fusion_builder_blank_page",template:FusionPageBuilder.template(e("#fusion-builder-blank-page-template").html()),events:{"click .fusion-builder-new-section-add":"addContainer","click .fusion-builder-video-button":"openVideoModal"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.find("#video-dialog").dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,height:420,width:590}),this},openVideoModal:function(e){e.preventDefault(),jQuery("#video-dialog").dialog("open"),jQuery("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),this.remove()},removeBlankPageHelper:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove()}}),jQuery("body").on("click",".ui-dialog-titlebar-close",function(){var e=jQuery(this).closest(".ui-dialog");e.find("#video-dialog").length&&(e.find("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),e.hide())})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.RowView=window.wp.Backbone.View.extend({className:"fusion_builder_row",template:FusionPageBuilder.template(a("#fusion-builder-row-template").html()),events:{"click .fusion-builder-insert-column":"displayColumnsOptions"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),"manually"!==this.model.get("created")&&this.$el.find(".fusion-builder-insert-column").trigger("click"),this},sortableColumns:function(){var o=this;o.$el.find(".fusion-builder-row-container").sortable({helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",items:".fusion-builder-column-outer",connectWith:".fusion-builder-row-container",tolerance:"pointer",update:function(e,i){var t=i.item.data("cid"),n=o.collection.find(function(e){return e.get("cid")===t});n.get("parent")===o.model.attributes.cid&&a(i.item).closest(e.target).length||n.set("parent",o.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},displayColumnsOptions:function(e){var i;e&&e.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),i=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"column_library"},view:this}),a("body").append(i.render().el)},removeRow:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(c){c(document).ready(function(){FusionPageBuilder.InnerRowView=window.wp.Backbone.View.extend({className:"fusion_builder_row_inner fusion_builder_column_element",template:FusionPageBuilder.template(c("#fusion-builder-row-inner-template").html()),events:{"click .fusion-builder-remove-inner-row":"removeRow","click .fusion-builder-save-inner-row-dialog-button":"saveElementDialog","click .fusion-builder-clone-inner-row":"cloneNestedRow","click .fusion-builder-inner-row-overlay":"showInnerRowDialog","click .fusion-builder-inner-row-close":"hideInnerRowDialog","click .fusion-builder-inner-row-close-icon":"hideInnerRowDialog","click .fusion-builder-modal-save":"saveInnerRowSettings","click .fusion-builder-insert-inner-column":"displayInnerColumn"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.listenTo(FusionPageBuilderEvents,"fusion-close-inner-modal",this.hideInnerRowDialog)},showInnerRowDialog:function(e){var i=this.$el;e&&e.preventDefault(),FusionPageBuilderApp.allContent=fusionBuilderGetContent("content",!0),FusionPageBuilderApp.pauseBuilder=!0,i.find(".fusion-builder-row-content").show(),c("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideInnerRowDialog:function(e){var i=this.$el,t="";e&&e.preventDefault(),FusionPageBuilderApp.pauseBuilder&&(FusionPageBuilderApp.pauseBuilder=!1,FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(FusionPageBuilderApp.allContent)),i.find(".fusion-builder-row-content").hide(),c("body").removeClass("fusion_builder_inner_row_no_scroll"),c(".fusion_builder_modal_inner_row_overlay").remove(),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?t+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":t+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(t.slice(0,t.length-3))},saveInnerRowSettings:function(){var e,i,t="";FusionPageBuilderApp.pauseBuilder=!1,i=this.$el,(e=FusionPageBuilderElements.find(function(e){return e.get("cid")===i.data("cid")})).set({chnaged:{changed:!0}}),FusionPageBuilderEvents.trigger("fusion-element-edited"),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?t+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":t+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(t.slice(0,t.length-3)),this.$el.find(".fusion-builder-row-content").hide(),c("body").removeClass("fusion_builder_inner_row_no_scroll"),c(".fusion_builder_modal_inner_row_overlay").remove(),e.set({chnaged:{}}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.edited_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-edited")},displayInnerColumn:function(e){var i;e&&e.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),i=new FusionPageBuilder.NestedColumnLibraryView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"nested_column_library"},view:this}),c(this.$el).find(".fusion-builder-row-content").append(i.render().el)},render:function(){var e=this.$el,i="";return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),setTimeout(function(){e.find(".fusion-builder-column-inner").each(function(){i+=jQuery(this).data("column-size").replace("_","/")+" + "}),e.find("> h4").after("<p>"+i.slice(0,i.length-3)+"</p>")},100),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},cloneNestedRow:function(e,i){var n;e&&e.preventDefault(),(n=c.extend(!0,{},this.model.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),e&&(n.appendAfter=this.$el),i&&(n.parent=i),FusionPageBuilderApp.collection.add(n),this.$el.find(".fusion-builder-column-inner").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderElements.findWhere({cid:i}),o=c.extend(!0,{},t.attributes);o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.parent=n.cid,FusionPageBuilderApp.collection.add(o),e.find(".fusion_module_block").each(function(){var e=c(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),n=c.extend(!0,{},t.attributes);n.created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=o.cid,n.from="fusion_builder_row_inner",FusionPageBuilderApp.collection.add(n)})}),i||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned")),n.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n.parent)},saveElementDialog:function(e){e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),c("#fusion-builder-layouts-elements-trigger").click(),c("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(e){var i=this.getInnerRowContent(),t=c("#fusion_builder_main_container"),n=c("#fusion-builder-save-element-input").val(),o=c("#fusion_save_global").is(":checked"),a=c("#fusion-builder-layouts-elements .fusion-page-layouts"),s=c("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),l=this.model,r=!1,u=null,d={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<t.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(u=this.model.attributes.params.fusion_global,delete(d=this.model.get("params")).fusion_global,this.model.set("params",d),i=this.getInnerRowContent(),d.fusion_global=u,this.model.set("params",d)),c.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),n.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),!(r=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==r&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==n?c.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:n,fusion_save_global:o,fusion_layout_content:i,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements",fusion_layout_element_type:"nested"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,a.prepend(e.responseText),c(".fusion-save-element-fields").remove(),s.hide(),o&&(l.attributes.params={fusion_global:c(e.responseText).attr("data-layout_id")},c('div.fusion_builder_column_element[data-cid="'+l.get("cid")+'"]').addClass("fusion-global-element"),c('div.fusion_builder_column_element[data-cid="'+l.get("cid")+'"]').attr("fusion-global-layout",c(e.responseText).attr("data-layout_id")),c('div.fusion_builder_column_element[data-cid="'+l.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+l.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,l.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getInnerRowContent:function(){var n="",e=this.$el,i=e.data("cid");FusionPageBuilderElements.findWhere({cid:i});return n+="[fusion_builder_row_inner]",e.find(".fusion-builder-column-inner").each(function(){var e=c(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);n+=t.getColumnContent(e)}),n+="[/fusion_builder_row_inner]"},sortableColumns:function(){var o=this;o.$el.find(".fusion-builder-row-container-inner").sortable({items:".fusion-builder-column-inner",helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog",tolerance:"pointer",update:function(e,i){var t=i.item.data("cid"),n=o.collection.find(function(e){return e.get("cid")===t});n.get("parent")===o.model.attributes.cid&&c(i.item).closest(e.target).length||n.set("parent",o.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_nested_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},removeRow:function(e,i){var t,n;e&&e.preventDefault(),n=this.model.get("parent"),t=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(t,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(r){r(document).ready(function(){FusionPageBuilder.NestedColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(r("#fusion-builder-nested-column-library-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),this.$el.addClass("fusion-add-to-nested"),this},addNestedColumns:function(e){var n,i,o,t,a,s,l;e&&e.preventDefault(),FusionPageBuilderViewManager.generateCid(),l=this.$el.parents(".fusion-builder-row-content").find(".fusion-builder-row-container-inner"),n=this,i=(r(e.target).is("li")?r(e.target):r(e.target).closest("li")).data("layout").split(","),_.size(i),o=this.options.view,t=fusionAllElements.fusion_builder_column_inner.params,a={},_.each(t,function(e){s=_.isObject(e.value)?e.default:e.value,a[e.param_name]=s}),_.each(i,function(e,i){var t={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:FusionPageBuilderApp.parentRowId,layout:e,view:o,params:a,appendAfter:l};n.collection.add([t])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},closeModal:function(e){e.preventDefault(),this.remove()}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(l){l(document).ready(function(){FusionPageBuilder.NestedColumnView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(l("#fusion-builder-inner-column-template").html()),events:{"click .fusion-builder-add-element":"addModule","click .fusion-builder-settings-column":"showSettings","click .fusion-builder-resize-inner-column":"columnSizeDialog","click .column-size":"columnSize","click .fusion-builder-remove-inner-column":"removeColumn","click .fusion-builder-clone-inner-column":"cloneColumn"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout"))},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),this},sortableElements:function(){var a=this;this.$el.sortable({items:".fusion_module_block",connectWith:".fusion-builder-column-inner",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog",tolerance:"pointer",update:function(e,i){var t=l(i.item),n=i.item.data("cid"),o=a.collection.find(function(e){return e.get("cid")===n});l(i.item).closest(e.target).length&&1===l(e.target).find(".fusion_module_block").length&&t.insertBefore(l(e.target).find(".fusion-builder-add-element")),o.get("parent")===a.model.attributes.cid&&l(i.item).closest(e.target).length||o.set("parent",a.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[o.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),l("body").append(i.render().el)},removeColumn:function(e){var i,t;e&&e.preventDefault(),t=this.model.get("parent"),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){e.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed"),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t)},cloneColumn:function(e){var o=l.extend(!0,{},this.model.attributes);e&&e.preventDefault(),o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.targetElement=this.$el,o.cloned=!0,FusionPageBuilderApp.collection.add(o),this.$el.find(".fusion_builder_column_element").each(function(){var e,i,t,n;l(this).hasClass("fusion_module_block")&&(e=l(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(n=l.extend(!0,{},t.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=o.cid,n.from="fusion_builder_column",FusionPageBuilderApp.collection.add(n))}),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},addModule:function(e){var i,t;e&&(e.preventDefault(),e.stopPropagation()),FusionPageBuilderApp.innerColumn="true",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),((t=l(e.target)).is("span")?t.parent(".fusion-builder-add-element"):t).parent().is(e.delegateTarget)&&(i=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),l("body").append(i.render().el))},columnSizeDialog:function(e){var i=this.$el.position().left,t=this.$el.parents(".fusion-builder-row-container-inner").width();e&&e.preventDefault(),t-i<240&&this.$el.find(".column-sizes").css({left:"auto",right:"0"}),this.$el.find(".column-sizes").toggle()},columnSize:function(e){var i=l(e.currentTarget),t=this.model.get("layout"),n=i.attr("data-column-size"),o="";e&&e.preventDefault(),void 0!==n&&(this.model.set("layout",n),this.$el.attr("data-column-size",n),this.$el.removeClass("fusion-builder-column-"+t),this.$el.addClass("fusion-builder-column-"+n),o=n.replace("_","/"),this.$el.find(".fusion-builder-resize-inner-column").text(o),this.$el.find(".column-sizes").hide(),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.find(".column-size-"+n).addClass("active-size"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.resized_column+" "+o,FusionPageBuilderEvents.trigger("fusion-element-edited"))},getColumnContent:function(e){var i,t="",n=void 0!==e?e:this.$el,o=n.data("cid"),a=FusionPageBuilderElements.findWhere({cid:o}),s={};return _.each(a.get("params"),function(e,i){s[i]="undefined"===e?"":e}),i={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(i,function(e,i){void 0===s[i]&&(s[i]=e)}),t+='[fusion_builder_column_inner type="'+a.get("layout")+'" background_position="'+s.background_position+'" background_color="'+s.background_color+'" border_size="'+s.border_size+'" border_color="'+s.border_color+'" border_style="'+s.border_style+'" spacing="'+s.spacing+'" background_image="'+s.background_image+'" background_repeat="'+s.background_repeat+'" padding_top="'+s.padding_top+'" padding_bottom="'+s.padding_bottom+'" padding_left="'+s.padding_left+'" padding_right="'+s.padding_right+'" margin_top="'+s.margin_top+'" margin_bottom="'+s.margin_bottom+'" class="'+s.class+'" id="'+s.id+'" animation_type="'+s.animation_type+'" animation_speed="'+s.animation_speed+'" animation_direction="'+s.animation_direction+'" hide_on_mobile="'+s.hide_on_mobile+'" center_content="'+s.center_content+'" last="'+s.last+'" min_height="'+s.min_height+'" hover_type="'+s.hover_type+'" link="'+s.link+'"]',n.find(".fusion_module_block").each(function(){t+=FusionPageBuilderApp.generateElementShortcode(l(this),!1)}),t+="[/fusion_builder_column_inner]"},getElementContent:function(){var e,i=this.$el,t=this.model,n={},o="";return _.each(t.get("params"),function(e,i){n[i]="undefined"===e?"":e}),e={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(e,function(e,i){void 0===n[i]&&(n[i]=e)}),o+='[fusion_builder_column_inner type="'+t.get("layout")+'" background_position="'+n.background_position+'" background_color="'+n.background_color+'" border_size="'+n.border_size+'" border_color="'+n.border_color+'" border_style="'+n.border_style+'" spacing="'+n.spacing+'" background_image="'+n.background_image+'" background_repeat="'+n.background_repeat+'" padding="'+n.padding+'" margin_top="'+n.margin_top+'" margin_bottom="'+n.margin_bottom+'" class="'+n.class+'" id="'+n.id+'" animation_type="'+n.animation_type+'" animation_speed="'+n.animation_speed+'" animation_direction="'+n.animation_direction+'" hide_on_mobile="'+n.hide_on_mobile+'" center_content="'+n.center_content+'" last="'+n.last+'" min_height="'+n.min_height+'" hover_type="'+n.hover_type+'" link="'+n.link+'"]',i.find(".fusion_module_block").each(function(){o+=FusionPageBuilderApp.generateElementShortcode(l(this),!1)}),o+="[/fusion_builder_column_inner]"}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(f){f(document).ready(function(){FusionPageBuilder.ColumnView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(f("#fusion-builder-column-template").html()),events:{"click .fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)":"addModule","click .fusion-builder-settings-column:not(.fusion-builder-column-inner .fusion-builder-settings-column)":"showSettings","click .fusion-builder-resize-column:not(.fusion-builder-column-inner .fusion-builder-resize-column)":"columnSizeDialog","click .column-size:not(.fusion-builder-column-inner .column-size)":"columnSize","click .fusion-builder-clone-column:not(.fusion-builder-column-inner .fusion-builder-clone-column)":"cloneColumn","click .fusion-builder-remove-column:not(.fusion-builder-column-inner .fusion-builder-remove-column)":"removeColumn","click .fusion-builder-save-column-dialog:not(.fusion-builder-column-inner .fusion-builder-save-column-dialog)":"saveColumnDialog"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout"))},render:function(){var e,i;return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),e=this.model.get("layout"),this.$el.find(".column-size-"+e).addClass("active-size"),i=e.replace("_","/"),this.$el.find(".fusion-builder-resize-column").text(i),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-column",this.model.attributes.params.fusion_global,this.model.get("cid")),this},sortableElements:function(){var a=this;this.$el.sortable({items:".fusion_module_block:not(.fusion_builder_row_inner .fusion_module_block), .fusion_builder_row_inner",connectWith:".fusion-builder-column-outer",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog, .fusion-builder-remove-inner-row, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",tolerance:"pointer",over:function(e){1===f(e.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&f(e.target).find(".ui-sortable-placeholder").insertBefore(f(e.target).find(".fusion-builder-add-element"))},update:function(e,i){var t=f(i.item),n=i.item.data("cid"),o=a.collection.find(function(e){return e.get("cid")===n});f(i.item).closest(e.target).length&&1===f(e.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&t.insertBefore(f(e.target).find("> .fusion-builder-add-element")),o.get("parent")===a.model.attributes.cid&&f(i.item).closest(e.target).length||o.set("parent",a.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[o.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},saveColumnDialog:function(e){e&&e.preventDefault(),FusionPageBuilderApp.showLibrary(),f("#fusion-builder-layouts-columns-trigger").click(),f("#fusion-builder-layouts-columns .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_column+"</a></div></div>")},saveElement:function(e){var i=this.$el,t=this.getColumnContent(i),n=f("#fusion_builder_main_container"),o=f("#fusion-builder-save-element-input").val(),a=f("#fusion_save_global").is(":checked"),s=f("#fusion-builder-layouts-columns .fusion-page-layouts"),l=f("#fusion-builder-layouts-columns .fusion-page-layouts .fusion-empty-library-message"),r=this.model,u=!1,d=null,c={};e&&e.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getColumnContent(i),c.fusion_global=d,this.model.set("params",c)),f.each(jQuery("ul.fusion-page-layouts.fusion-layout-columns li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),!(u=!0)}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==u&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?f.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"columns"},complete:function(e){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(e.responseText),f(".fusion-save-element-fields").remove(),l.hide(),a&&(r.attributes.params.fusion_global=f(e.responseText).attr("data-layout_id"),f('div[data-cid="'+r.get("cid")+'"]').addClass("fusion-global-column"),f('div[data-cid="'+r.get("cid")+'"]').attr("fusion-global-layout",f(e.responseText).attr("data-layout_id")),f('div[data-cid="'+r.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+r.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,r.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getColumnContent:function(e){var i,a="",t=e.data("cid"),n=FusionPageBuilderElements.findWhere({cid:t}),o={};return _.each(n.get("params"),function(e,i){o[i]="undefined"===e||void 0===e?"":e,"padding"===i&&""===o[i]&&(o.padding_top="",o.padding_right="",o.padding_bottom="",o.padding_left="",delete o[i]),"dimension_margin"===i&&""===o[i]&&(o.margin_top="",o.margin_bottom="",delete o[i])}),i={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(i,function(e,i){void 0===o[i]&&(o[i]=e)}),a+='[fusion_builder_column type="'+n.get("layout")+'"',_.each(o,function(e,i){a+=" "+i+'="'+e+'"'}),a+="]",e.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var e,i,t;f(this).hasClass("fusion_module_block")?a+=FusionPageBuilderApp.generateElementShortcode(f(this),!1):(i=(e=f(this)).data("cid"),void 0!==(t=FusionPageBuilderElements.findWhere({cid:i})).attributes.params&&void 0!==t.attributes.params.fusion_global?a+='[fusion_builder_row_inner fusion_global="'+t.attributes.params.fusion_global+'"]':a+="[fusion_builder_row_inner]",e.find(".fusion-builder-column-inner").each(function(){var e,i=f(this),t=i.data("cid"),n=FusionPageBuilderElements.findWhere({cid:t}),o={};_.each(n.get("params"),function(e,i){o[i]="undefined"===e||void 0===e?"":e}),e={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(e,function(e,i){void 0===o[i]&&(o[i]=e)}),a+='[fusion_builder_column_inner type="'+n.get("layout")+'"',_.each(o,function(e,i){a+=" "+i+'="'+e+'"'}),a+="]",i.find(".fusion_module_block").each(function(){a+=FusionPageBuilderApp.generateElementShortcode(f(this),!1)}),a+="[/fusion_builder_column_inner]"}),a+="[/fusion_builder_row_inner]")}),a+="[/fusion_builder_column]"},showSettings:function(e){var i,t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};e&&e.preventDefault(),i=new FusionPageBuilder.ModalView(t),f("body").append(i.render().el)},removeColumn:function(e){var i,t;e&&e.preventDefault(),t=this.model.get("parent"),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")||"fusion_builder_row_inner"===e.model.get("type")?e.removeRow():e.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t)},addModule:function(e){var i,t;e&&(e.preventDefault(),e.stopPropagation()),FusionPageBuilderApp.removeContextMenu(),FusionPageBuilderApp.innerColumn="false",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),((t=f(e.target)).is("span")?t.parent(".fusion-builder-add-element"):t).parent().is(e.delegateTarget)&&(i=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),f("body").append(i.render().el))},cloneColumn:function(e){var l=f.extend(!0,{},this.model.attributes);e&&e.preventDefault(),l.created="manually",l.cid=FusionPageBuilderViewManager.generateCid(),l.targetElement=this.$el,l.cloned=!0,FusionPageBuilderApp.collection.add(l),this.$el.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var e,i,t,n,o,a,s;f(this).hasClass("fusion_module_block")?(e=f(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(n=f.extend(!0,{},t.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.parent=l.cid,n.from="fusion_builder_column",FusionPageBuilderApp.collection.add(n)):f(this).hasClass("fusion_builder_row_inner")&&(a=void 0===(o=f(this)).data("cid")?o.find(".fusion-builder-data-cid").data("cid"):o.data("cid"),void 0!==(s=FusionPageBuilderViewManager.getView(a))&&s.cloneNestedRow("",l.cid))}),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},columnSizeDialog:function(e){e&&e.preventDefault(),this.$el.find(".column-sizes").toggle()},columnSize:function(e){var i=f(e.currentTarget),t=this.model.get("layout"),n=i.attr("data-column-size"),o="";e&&e.preventDefault(),void 0!==n&&(this.model.set("layout",n),this.$el.removeClass("fusion-builder-column-"+t),this.$el.addClass("fusion-builder-column-"+n),o=n.replace("_","/"),this.$el.find(".fusion-builder-resize-column").text(o),this.$el.find(".column-sizes").hide(),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.find(".column-size-"+n).addClass("active-size"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.resized_column+" "+o,FusionPageBuilderEvents.trigger("fusion-element-edited"))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(u){u(document).ready(function(){FusionPageBuilder.ModalView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(u("#fusion-builder-modal-template").html()),events:{"click .fusion-builder-modal-save":"saveSettings","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-remove-modal-view",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-close-modal",this.closeModal),this.options=e,this.elementType=""},initDynamicParams:function(){var e=void 0!==this.model&&"object"==typeof this.model.get("params")?this.model.get("params"):{},i=e.dynamic_params;if(this.dynamicParams=new FusionPageBuilder.DynamicParams({elementView:this}),"string"==typeof e.dynamic_params&&""!==e.dynamic_params)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(i))===i&&(i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)),this.dynamicParams.setData(i)}catch(e){}},render:function(){var e,i,t,n={model:this.model,collection:this.collection,view:this.options.view};return this.initDynamicParams(),n.dynamicParams=this.dynamicParams,void 0===this.model||void 0===this.model.get("view")||"row_inner"!==this.model.get("element_type")&&"fusion_builder_row"!==this.model.get("element_type")||this.model.get("parent")===this.model.get("view").$el.data("cid")||this.model.set("view",FusionPageBuilderViewManager.getView(this.model.get("parent")),{silent:!0}),void 0!==this.model?this.$el.html(this.template(this.model.toJSON())):this.$el.html(this.template()),t=this.$el.find(".fusion-builder-modal-container"),"column_library"===this.attributes["data-modal_view"]?e=new FusionPageBuilder.ColumnLibraryView(n):"element_library"===this.attributes["data-modal_view"]?(n.attributes={"data-parent_cid":this.model.get("cid")},e=new FusionPageBuilder.ElementLibraryView(n)):"all_elements_generator"===this.attributes["data-modal_view"]?(n.attributes={},e=new FusionPageBuilder.GeneratorElementsView(n)):"multi_element_child_settings"===this.attributes["data-modal_view"]?(n.attributes={},e=new FusionPageBuilder.MultiElementSettingsView(n)):"element_settings"===this.attributes["data-modal_view"]&&(n.attributes={"data-element_type":this.model.get("element_type")},void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&(this.elementType="multi"),n.view=this,e=void 0!==(i=fusionAllElements[this.model.get("element_type")].custom_settings_view_name)&&""!==i?new FusionPageBuilder[i](n):new FusionPageBuilder.ElementSettingsView(n)),this.settingsView=e,t.append(e.render().el),u(".fusion_builder_modal_overlay").length<1&&u(".fusion_builder_modal_inner_row_overlay").length<1&&u("body").addClass("fusion_builder_no_scroll").append('<div class="fusion_builder_modal_overlay"></div>'),"column_library"!==this.attributes["data-modal_view"]&&"element_library"!==this.attributes["data-modal_view"]&&"all_elements_generator"!==this.attributes["data-modal_view"]||this.elementSearchFilter(),"multi"===this.elementType&&this.$el.addClass("fusion_builder_modal_multi_element_settings_container"),this},closeModal:function(e){var i,t,n,o,a,s,l,r;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="",this.$el.find(".wp-color-picker").each(function(){u(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0===FusionPageBuilderApp.newContainerAdded&&(FusionPageBuilderApp.newContainerAdded=!1),this.$el.find(".tinymce").each(function(){l=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(l)}),void 0!==this.model&&!0!==FusionPageBuilderApp.MultiElementChildSettings&&"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,!0===FusionPageBuilderApp.shortcodeGenerator?void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",r=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"),FusionPageBuilderViewManager.getView(r).removeView(),r=""):void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_child"===this.model.get("multi")?FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="":(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""):"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")&&("fusion_builder_row"===this.model.get("element_type")?(i=this.model.get("parent"),void 0!==(t=FusionPageBuilderViewManager.getView(i))&&t.removeContainer()):(o=fusionAllElements[this.model.get("element_type")].params,n={},_.each(o,function(e){a=_.isObject(e.value)?e.default:e.value,n[e.param_name]=a}),s={params:n},this.model.set(s),e&&FusionPageBuilderEvents.trigger("fusion-element-added")),"element"===this.model.get("type")&&this.deleteModel(),void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view")),this.removeOverlay(),FusionPageBuilderEvents.trigger("fusion-settings-modal-cancel"),this.remove()},removeView:function(){this.removeOverlay(),void 0!==this.model&&"fusion_builder_row"!==this.model.get("type")&&"fusion_builder_column"!==this.model.get("type")&&"fusion_builder_row_inner"!==this.model.get("type")&&"fusion_builder_column_inner"!==this.model.get("type")||this.remove()},saveSettings:function(e){var n,i,t,o,a,s,l=this;e&&e.preventDefault(),this.$el.find(".wp-color-picker").each(function(){u(this).wpColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0!==FusionPageBuilderApp.MultiElementChildSettings?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,n={params:{}},"fusion_builder_container"===this.model.get("element_type")&&void 0!==this.model.attributes.params.admin_label&&(n.params.admin_label=this.model.attributes.params.admin_label),void 0!==this.model.attributes.params.fusion_global&&(n.params.fusion_global=this.model.attributes.params.fusion_global),this.$el.find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e,i,t=u(this);void 0!==(i=l.getSettingName(t,!1))&&(e=l.getSettingValue(t,!1),n.params[i]=e)}),(s=this.getDynamicValues())?(n.params.dynamic_params=s.string,n.dynamic_params=s.object):(delete n.params.dynamic_params,n.dynamic_params={}),void 0!==fusionAllElements[this.model.get("element_type")].escape_html&&!0===fusionAllElements[this.model.get("element_type")].escape_html&&(n.params.element_content=_.escape(n.params.element_content)),void 0!==fusionAllElements[this.model.get("element_type")].on_save&&(o=fusionAllElements[this.model.get("element_type")].on_save,"function"==typeof FusionPageBuilderApp[o]&&(n=FusionPageBuilderApp[o](n,this))),!0===FusionPageBuilderApp.shortcodeGenerator?"multi_element_parent"===this.model.get("multi")?(this.model.set(n,{silent:!0}),i=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(i),FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",void 0!==(a=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"))&&FusionPageBuilderViewManager.getView(a).removeView(),a="",this.remove(),this.removeOverlay()):"multi_element_child"===this.model.get("multi")?(this.model.set(n),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",this.remove()):("fusion_builder_column"===this.model.get("element_type")&&(n.params.type=this.model.get("layout")),"fusion_builder_container"===this.model.get("element_type")&&(n.params.element_content="[fusion_builder_row][/fusion_builder_row]"),this.model.set(n,{silent:!0}),i=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(i,FusionPageBuilderApp.shortcodeGeneratorEditorID),"video"!==FusionPageBuilderApp.shortcodeGeneratorEditorID&&(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""),this.remove(),!1!==FusionPageBuilderApp.builderActive&&!0!==FusionPageBuilderApp.fromExcerpt||(this.removeOverlay(),FusionPageBuilderApp.fromExcerpt=!1)):("multi_element_child"===this.model.get("multi")?(this.model.set(n,{silent:!0}),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),this.remove()):("multi_element_parent"===this.model.get("multi")?(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(n),this.$el.find(".tinymce").each(function(){t=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(t)}),FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view"),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),this.generatePreview()):(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(n),this.$el.find(".tinymce").each(function(){t=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(t)}),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),!0===FusionPageBuilderApp.builderActive&&this.generatePreview()),this.removeOverlay()),e&&FusionPageBuilderEvents.trigger("fusion-element-added")),FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGenerator=FusionPageBuilderApp.manualGenerator,FusionPageBuilderApp.shortcodeGeneratorEditorID=FusionPageBuilderApp.manualEditor,FusionPageBuilderApp.manuallyAdded=!1),this.$el.find(".tinymce").each(function(){t=u(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(t)}),FusionPageBuilderApp.activeModal="",FusionPageBuilderEvents.trigger("fusion-settings-modal-save")},getSettingName:function(e,i){if(!e.parents(".repeater-fields, .dynamic-param-fields").length||i)return e.is("#generator_element_content")||e.is("#fusion_builder_content_main")||e.is("#element_content")||e.is("#generator_multi_child_content")?"element_content":e.attr("id")},getSettingValue:function(e,i){var t;if(!e.parents(".repeater-fields, .dynamic-param-fields").length||i)return e.is("#fusion_builder_content_main")?t=e.val():e.is(":checkbox")||(t=e.is("#generator_element_content")?fusionBuilderGetContent("generator_element_content"):e.is("#generator_multi_child_content")?fusionBuilderGetContent("generator_multi_child_content"):e.is("textarea#element_content")&&e.parents(".fusion-builder-option").hasClass("tinymce")?fusionBuilderGetContent("element_content"):e.val()),e.is("input")&&""!==t&&(e.hasClass("fusion-builder-upload-field")||e.is("#generator_element_content")||e.is("#generator_multi_child_content")||(t=_.escape(t))),e.hasClass("fusion-builder-raw-textarea")&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-builder-code-block")&&1===Number(FusionPageBuilderApp.disable_encoding)&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-repeater-value")&&(t=this.getRepeaterValues(e)),"infobox_content"===name&&(t=_.escape(t)),t},getRepeaterValues:function(e){var n,i=[],o=this;return e.parent().find(".repeater-row").each(function(){n={},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e=jQuery(this),i=o.getSettingName(e,!0),t=o.getSettingValue(e,!0);n[i]=t}),i.push(n)}),i=JSON.stringify(i),i=FusionPageBuilderApp.base64Encode(i)},getDynamicValues:function(){var o=this,a=!1;return this.$el.find('[data-dynamic="true"]:not([data-parent-content="true"])').length&&(a={},this.$el.find('[data-dynamic="true"]:not([data-parent-content="true"])').each(function(){var n=jQuery(this).attr("data-option-id"),e=jQuery(this).find(".dynamic-wrapper").attr("data-id");a[n]={data:e},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e=jQuery(this),i=o.getSettingName(e,!0),t=o.getSettingValue(e,!0);a[n][i]=t})})),!!a&&{string:FusionPageBuilderApp.base64Encode(JSON.stringify(a)),object:a}},removeOverlay:function(){u(".fusion_builder_modal_overlay").length&&u(".fusion-builder-modal-settings-container").length<2&&(u(".fusion_builder_modal_overlay").remove(),u("body").removeClass("fusion_builder_no_scroll"))},generatePreview:function(){var e,i,t,n,o,a=this.model.get("element_type");"fusion_builder_container"===a&&(n=this.model.get("params"),i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el,o=fusionBuilderText.empty_section,""!==n.background_image&&(o=fusionBuilderText.empty_section_with_bg),i.find(".fusion-builder-empty-section").html(o),FusionPageBuilderViewManager.getView(this.model.get("cid")).updateStatusIcons()),void 0!==fusionAllElements[a].preview&&(e={model:this.model,collection:FusionPageBuilderElements},i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-module-preview"),t=new FusionPageBuilder.ElementPreviewView(e),i.html("").append(t.render().el))},deleteModel:function(){FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-remove").click()},elementSearchFilter:function(){var e,i,t=this.$el;t.find(".fusion-elements-filter").on("change paste keyup",function(){u(this).val()?(i=u(this).val().toLowerCase(),t.find(".fusion-builder-all-modules li").each(function(){"portfolio"===(e=(e=u(this).find(".fusion_module_title").text().trim().toLowerCase()).replace("this is a global column.",""))&&(e+=" recent works"),-1!==e.search(i)?u(this).show():u(this).hide()})):t.find(".fusion-builder-all-modules li").show()})}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NextPage=window.wp.Backbone.View.extend({className:"fusion-builder-next-page",template:FusionPageBuilder.template(e("#fusion-builder-next-page-template").html()),events:{"click .fusion-builder-delete-next-page":"removeContainer"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},removeContainer:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ContextMenuView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-context-menu").html()),className:"fusion-builder-context-menu",events:{'click [data-action="edit"]':"editTrigger",'click [data-action="save"]':"saveTrigger",'click [data-action="clone"]':"cloneTrigger",'click [data-action="remove"]':"removeTrigger",'click [data-action="copy"]':"copy",'click [data-action="paste-before"]':"pasteBefore",'click [data-action="paste-after"]':"pasteAfter",'click [data-action="paste-start"]':"pasteStart",'click [data-action="paste-end"]':"pasteEnd"},initialize:function(){this.copyData={data:{type:!1,content:!1}},this.getCopy()},render:function(){var e=jQuery("#fusion_builder_layout .inside").offset();return this.$el.html(this.template(jQuery.extend(!0,this.copyData,this.model.parent.attributes,{pageType:this.model.pageType}))),this.$el.css({top:this.model.event.pageY-e.top+"px",left:this.model.event.pageX-e.left+"px"}),this},editTrigger:function(e){"fusion_builder_row_inner"===this.model.parent.attributes.element_type?this.model.parentView.showInnerRowDialog(e):this.model.parentView.showSettings(e)},saveTrigger:function(e){"fusion_builder_column"===this.model.parent.attributes.element_type?this.model.parentView.saveColumnDialog(e):this.model.parentView.saveElementDialog(e)},cloneTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.cloneContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.cloneColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.cloneNestedRow(e);break;default:this.model.parentView.cloneElement(e)}},removeTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.removeContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.removeColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.removeRow(e);break;default:this.model.parentView.removeElement(e)}},copy:function(){var e,i,t=this.model.parent.attributes.element_type,n=jQuery("<textarea>");switch(this.model.parent.attributes.element_type){case"fusion_builder_container":e=this.model.parentView.getContainerContent();break;case"fusion_builder_column_inner":case"fusion_builder_column":e=this.model.parentView.getColumnContent(this.model.parentView.$el);break;case"fusion_builder_row_inner":e=this.model.parentView.getInnerRowContent();break;default:e=this.model.parentView.getElementContent()}jQuery("body").append(n),n.val(e).select(),document.execCommand("copy"),n.remove(),i={type:t,content:e},this.storeCopy(i)},storeCopy:function(e){"undefined"!=typeof Storage&&(localStorage.setItem("fusionCopyContent",e.content),localStorage.setItem("fusionCopyType",e.type),this.getCopy())},getCopy:function(){"undefined"!=typeof Storage&&localStorage.getItem("fusionCopyContent")&&(this.copyData.data.content=localStorage.getItem("fusionCopyContent"),this.copyData.data.type=localStorage.getItem("fusionCopyType"))},pasteAfter:function(){this.paste("after")},pasteBefore:function(){this.paste("before")},pasteStart:function(){this.paste("start")},pasteEnd:function(){this.paste("end")},paste:function(e){var i,t=this.copyData.data,n=t.type,o=t.content,a=!1,s="";"after"===e||"before"===e?(i=this.model.parent.attributes.parent,a=this.model.parentView.$el,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parent.attributes.cid,FusionPageBuilderApp.targetContainerCID=this.model.parent.attributes.cid)):(i=this.model.parent.attributes.cid,a=!1,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parentView.$el.find(".fusion-builder-row-content").first().data("cid"))),FusionPageBuilderApp.shortcodesToBuilder(o,i,a,e),-1===n.indexOf("fusion_builder_")&&(s=" "+fusionBuilderText.element),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.pasted+" "+fusionAllElements[n].name+s,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeMenu:function(e){e&&e.preventDefault(),FusionPageBuilderApp.contextMenuView=!1,this.remove()}})});FusionPageBuilder=FusionPageBuilder||{};!function(q){q(document).ready(function(){FusionPageBuilder.ElementSettingsView=window.wp.Backbone.View.extend({className:"fusion_builder_module_settings",template:FusionPageBuilder.template(q("#fusion-builder-block-module-settings-template").html()),events:{"click #qt_element_content_fusion_shortcodes_text_mode":"activateSCgenerator","click .option-dynamic-content":"addDynamicContent"},activateSCgenerator:function(e){openShortcodeGenerator(q(e.target))},initialize:function(){var e,i,t;this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeElement),void 0!==fusionAllElements[this.model.get("element_type")].on_settings&&(e=fusionAllElements[this.model.get("element_type")].on_settings,"function"==typeof FusionPageBuilderApp[e]&&(i=this.model.get("params"),t=FusionPageBuilderApp[e](i,this),this.model.set("params",t))),this.listenTo(FusionPageBuilderEvents,"fusion-dynamic-data-removed",this.removeDynamicStatus),this.listenTo(FusionPageBuilderEvents,"fusion-dynamic-data-added",this.addDynamicStatus),this.dynamicSelection=!1,this.dynamicParams="object"==typeof this.options&&"object"==typeof this.options.dynamicParams&&this.options.dynamicParams,this.onInit()},onInit:function(){},addDynamicContent:function(e){var i,t=jQuery(e.target).closest(".fusion-builder-option"),n=t.attr("data-option-id"),o=!1;this.dynamicSelection&&(n===this.dynamicSelection.model.get("param")&&(o=!0),this.dynamicSelection.removeView()),o||(i={model:new FusionPageBuilder.Element({param:n,option:t,parent:this})},this.dynamicSelection=new FusionPageBuilder.DynamicSelection(i),t.find(".fusion-dynamic-selection").html(this.dynamicSelection.render().el))},removeDynamicStatus:function(e){this.$el.find('.fusion-builder-option[data-option-id="'+e+'"]').attr("data-dynamic",!1),this.$el.find("#"+e).trigger("change")},addDynamicStatus:function(e){this.$el.find('.fusion-builder-option[data-option-id="'+e+'"]').attr("data-dynamic",!0),this.$el.find("#"+e).trigger("change")},render:function(){var e=this.$el,i=this.model.attributes;return this.beforeRender(),"object"==typeof this.dynamicParams&&(this.dynamicParams.createBackup(),i.dynamic_params=this.dynamicParams.getAll()),e.html(this.template({atts:i})),this.optionInit(e),setTimeout(function(){e.find("select, input, textarea, radio").filter(":eq(0)").not("[data-placeholder]").focus()},1),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],e),this.onRender(),FusionPageBuilderEvents.trigger("fusion-settings-modal-open"),this},beforeRender:function(){},onRender:function(){},optionInit:function(e){var i,t,n,o,a,s,l,r,u,d,c,f,m,p,g,h,b,v,y,C,E,w,B,P,F,A,k,x,j,T,Q,V,M,S,D,$,O,I,L,z,G=e,H=this,N="",R=!1,W=this,U=!1,J=[];"undefined"!==(w=this.model).attributes.params.settings_lvl&&"parent"===w.attributes.params.settings_lvl&&(U=!0,V=w.attributes.params),void 0!==w.get&&void 0!==w.get("allow_generator")&&!0===w.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0),$=void 0!==this.model.get&&void 0!==this.model.get("parent_values")&&this.model.get("parent_values"),j=G.find("[data-placeholder]"),t=G.find(".fusion-editor-field"),o=G.find(".fusion-builder-color-picker-hex"),a=G.find(".fusion-builder-upload-button"),s=G.find(".fusion-iconpicker"),l=G.find(".fusion-form-multiple-select"),r=G.find(".fusion-form-checkbox-button-set"),u=G.find(".fusion-form-radio-button-set"),C=G.find(".fusion-slider-container"),B=G.find(".fusion-select-field:not( .fusion-skip-init )"),F=G.find(".single-builder-dimension"),k=G.find(".fusion-builder-code-block"),M=G.find(".fusion-builder-link-button"),S=G.find(".fusion-datetime"),D=G.find(".fusion-multiple-image-container"),O=G.find(".fusion-builder-option.repeater"),I=G.find(".fusion-builder-option.sortable_text"),z=G.find(".fusion-builder-font-family"),j.length&&j.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")}),M.length&&FusionPageBuilderApp.fusionBuilderActivateLinkSelector(M),S.length&&jQuery(S).fusiondatetimepicker({format:"yyyy-MM-dd hh:mm:ss"}),this.optionDynamicData(G),o.length&&o.each(function(){var t=q(this),n=t.parents(".fusion-builder-option").find(".fusion-builder-default-reset"),o=void 0!==$&&void 0!==$[t.attr("id")]&&$[t.attr("id")];q(this).data("default")&&q(this).data("default").length?(q(this).wpColorPicker({change:function(e,i){W.colorChange(i.color.toString(),t,n,o)},clear:function(e){W.colorClear(e,t,o)}}),n.on("click","a",function(e){e.preventDefault(),W.colorClear(e,t,o)})):q(this).wpColorPicker({}),!0!==q(this).data("alpha")&&q(this).wpColorPicker().change()}),D.length&&D.each(function(){var i,t=jQuery(this);t.html(""),"string"==typeof t.parent().find("#image_ids").val()&&(i=t.parent().find("#image_ids").val().split(","),jQuery.each(i,function(e,i){""!==i&&"NaN"!==i&&void 0===wp.media.attachment(i).get("url")&&J.push(i)}),0<J.length?wp.media.query({post__in:J,posts_per_page:J.length}).more().then(function(e){W.renderAttachments(i,t)}):W.renderAttachments(i,t))}),k.length&&k.each(function(){var e;void 0!==wp.CodeMirror&&(A=q(this).attr("id"),x=G.find("#"+A),e=jQuery(this).data("language"),void 0!==(L=G.find("."+A).val())&&((L=jQuery.parseJSON(L)).lineNumbers=!0),void 0!==e&&"default"!==e&&(L.mode="text/"+e),FusionPageBuilderApp.codeEditor=wp.CodeMirror.fromTextArea(x[0],L),setTimeout(function(){FusionPageBuilderApp.codeEditor.refresh(),FusionPageBuilderApp.codeEditor.focus()},100))}),F.length&&F.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).parents(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val():"0px"))})}),B.length&&B.select2(),z.length&&(_.isUndefined(FusionPageBuilderApp.assets)||_.isUndefined(FusionPageBuilderApp.assets.webfonts)?jQuery.when(FusionPageBuilderApp.assets.getWebFonts()).done(function(){H.initAfterWebfontsLoaded(z)}):this.initAfterWebfontsLoaded(z)),a.length&&FusionPageBuilderApp.FusionBuilderActivateUpload(a),s.length&&s.each(function(){var e=jQuery(this);d=e.find(".fusion-iconpicker-input").val(),c=e.find(".fusion-iconpicker-input").attr("id"),f=e.find(".icon_select_container"),m=e.find(".fusion-icon-search"),FusionPageBuilderApp.fusion_builder_iconpicker(d,c,f,m)}),l.length&&l.each(function(){T=fusionBuilderText.select_options_or_leave_blank_for_all,-1!==jQuery(this).attr("id").indexOf("cat_slug")||-1!==jQuery(this).attr("id").indexOf("category")?T=fusionBuilderText.select_categories_or_leave_blank_for_all:-1!==jQuery(this).attr("id").indexOf("exclude_cats")&&(T=fusionBuilderText.select_categories_or_leave_blank_for_none),jQuery(this).select2({placeholder:T})}),r.length&&((v=G.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(y=v.find(".button-set-value").val())&&""!==y||v.find("a").addClass("ui-state-active"),"yes"===y&&v.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),r.find("a").on("click",function(e){e.preventDefault(),g=jQuery(this).parents(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),g.find(".button-set-value").val(g.find(".ui-state-active").map(function(e,i){return jQuery(i).data("value")}).get())})),u.length&&u.find("a").on("click",function(e){e.preventDefault(),h=jQuery(this).parents(".fusion-form-radio-button-set"),b=h.closest(".fusion-builder-option.subgroup").parent(),h.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),h.find(".button-set-value").val(h.find(".ui-state-active").data("value")).trigger("change"),h.closest(".fusion-builder-option.subgroup").length&&(b.find(".fusion-subgroup-content").removeClass("active"),b.find(".fusion-subgroup-"+h.find(".ui-state-active").data("value")).addClass("active"))}),I.length&&FusionPageBuilderApp.fusion_builder_sortable_text(I),C.length&&(E=0,Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())!==this.valueOf()&&this.toString().split(".")[1].length||0},C.each(function(){var i,t,e,n,o,a,s,l,r,u,d,c,f,m,p=jQuery(this).data("id"),g=jQuery(this).prev(".fusion-slider-input"),h=jQuery(this).data("min"),_=jQuery(this).data("max"),b=jQuery(this).data("step"),v=jQuery(this).data("direction"),y=g.val(),w=b.countDecimals(),B=!!jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").length&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default"),P=!!B&&jQuery(this).parent().find(".fusion-hidden-value"),F=!!B&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default");void 0!==$&&void 0!==$[p]&&B&&(jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default",$[p]),F=$[p],P&&""!==P.val()||(y=F)),i=E,t=p,e=g,n=h,o=_,a=b,s=y,l=w,r=B,u=P,d=F,c=v,f=noUiSlider.create(C[i],{start:[s],step:a,direction:c,range:{min:n,max:o},format:wNumb({decimals:l})}),m=!1,r&&""===u.val()&&r.parent().addClass("checked"),r&&r.on("click",function(e){e.preventDefault(),C[i].noUiSlider.set(d),u.val(""),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,i){r&&m&&(r.parent().removeClass("checked"),u.val(e[i])),m=!0,jQuery(this.target).closest(".fusion-slider-container").prev().val(e[i]).trigger("change"),G.find("#"+t).trigger("change")}),e.on("blur",function(e){this.value!==C[i].noUiSlider.get()&&(n<=this.value&&o>=this.value?C[i].noUiSlider.set(this.value):n>this.value?C[i].noUiSlider.set(n):o<this.value&&C[i].noUiSlider.set(o))}),E++})),void 0!==this.model.get&&"fusion_woo_shortcodes"===this.model.get("element_type")&&!0===FusionPageBuilderApp.shortcodeGenerator&&G.find("#element_content").attr("id","generator_element_content"),t.length&&(n=t.closest(".fusion-builder-option"),void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(p=FusionPageBuilderViewManager.generateCid(),this.view_cid=p,n.hide(),t.attr("id","fusion_builder_content_main"),i=new FusionPageBuilder.MultiElementSortablesView({model:this,el:this.$el.find(".fusion-builder-option-advanced-module-settings"),attributes:{cid:p,parentCid:this.model.get("cid")}}),FusionPageBuilderViewManager.addView(p,i),n.before(i.render()),""!==t.html()&&i.generateMultiElementChildSortables(t.html(),G.find(".fusion-builder-option-advanced-module-settings").data("element_type"),U,V)):(N=t.html(),!0===FusionPageBuilderApp.shortcodeGenerator?(!0===FusionPageBuilderApp.shortcodeGeneratorMultiElementChild?t.attr("id","generator_multi_child_content"):t.attr("id","generator_element_content"),P=t.attr("id"),setTimeout(function(){t.wp_editor(N,P),jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).on("focus",function(){Q=window.tinyMCE.get(P).getContent(),(Q=jQuery("<div/>").html(Q).text())===jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).setContent("")})},100)):(P=t.attr("id"),setTimeout(function(){void 0!==w.get("allow_generator")&&!0===w.get("allow_generator")&&(R=!0),t.wp_editor(N,P,R),jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).on("focus",function(){Q=window.tinyMCE.get(P).getContent(),(Q=jQuery("<div/>").html(Q).text())===jQuery("#"+P).data("placeholder")&&window.tinyMCE.get(P).setContent("")})},100)))),O.length&&O.each(function(){W.initRepeater(jQuery(this))}),G.find(".uploadattachment .fusion-builder-upload-button").on("click",function(){alert(fusionBuilderText.to_add_images)}),FusionPageBuilderApp.rangeOptionPreview(G)},beforeRemove:function(){},removeElement:function(){this.beforeRemove(),this.remove()},initRepeater:function(e){var t=this,i=e.data("option-id"),n=fusionAllElements[this.model.get("element_type")].params[i],o=void 0!==n?n.fields:{},a=this.model.get("params"),s=void 0!==a[i]?a[i]:"",l=e.find(".repeater-rows"),r=void 0!==n&&n.row_title,u=!1;if("string"==typeof s&&""!==s)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(s))===s&&(s=FusionPageBuilderApp.base64Decode(s),s=_.unescape(s),s=JSON.parse(s),u=!0)}catch(e){}else t.createRepeaterRow(o,{},l,r);"object"==typeof s&&u&&_.each(s,function(e,i){t.createRepeaterRow(o,s[i],l,r)}),e.on("click",".repeater-row-add",function(e){e.preventDefault(),t.createRepeaterRow(o,{},l,r)}),e.on("click",".repeater-row-remove",function(e){e.preventDefault(),jQuery(this).parents(".repeater-row").first().remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-plus2")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-plus2").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-plus2")}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove",update:function(){}})},createRepeaterRow:function(e,i,t,n){var o,a="",s=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),l={};a+='<div class="repeater-row">',a+='<div class="repeater-title">',a+='<span class="repeater-toggle-icon fusiona-plus2"></span>',a+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",a+='<span class="repeater-row-remove fusiona-plus2"></span>',a+="</div>",a+='<ul class="repeater-fields">',_.each(e,function(e){o=i[e.param_name],l[e.param_name]=e,a+=jQuery(s({field:e,value:o})).html()}),a+="</ul>",a+="</div>",this.optionInit(t.append(a).children("div:last-child")),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],t.children("div:last-child"),!1,l,this.$el)},colorChange:function(e,i,t){var n=i.data("default");e===n?t.addClass("checked"):t.removeClass("checked"),""===e&&null!==n&&(i.val(n),i.change(),i.val(""))},colorClear:function(e,i){var t=i.data("default");null!==t&&(i.val(t),i.change(),i.val(""),i.parent().parent().find(".wp-color-result").css("background-color",t))},renderAttachments:function(e,t){var n,o,a,s;0<e.length&&jQuery.each(e,function(e,i){""!==i&&"NaN"!==i&&(o=wp.media.attachment(i),a=o.get("sizes"),s=void 0!==a[200]?a[200].url:void 0!==a.thumbnail?a.thumbnail.url:o.get("url"),n='<div class="fusion-multi-image" data-image-id="'+o.get("id")+'">',n+='<img src="'+s+'"/>',n+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',n+="</div>",t.append(n))})},initAfterWebfontsLoaded:function(e){var i=this,t=FusionPageBuilderApp.assets.webfonts,n=[],o=[],a=[],s=[];s.push({id:"",text:fusionBuilderText.typography_default}),_.isUndefined(t.standard)||_.each(t.standard,function(e){n.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),_.isUndefined(t.google)||_.each(t.google,function(e){o.push({id:e.family,text:e.label})}),_.isUndefined(t.custom)||_.each(t.custom,function(e){e.family&&""!==e.family&&a.push({id:e.family.replace(/&quot;/g,"&#39"),text:e.label})}),a[0]&&s.push({text:"Custom Fonts",children:a}),s.push({text:"Standard Fonts",children:n}),s.push({text:"Google Fonts",children:o}),e.each(function(){var e=jQuery(this).find(".input-font_family");e.select2({data:s}),jQuery(this).find(".font-family").addClass("loaded"),e.val(e.data("value")).trigger("change"),i.renderVariant(jQuery(this)),i.renderSubset(jQuery(this)),e.on("change",function(){var e=jQuery(this).closest(".fusion-builder-font-family");i.renderVariant(e),i.renderSubset(e)})})},renderVariant:function(e){var i=[],t=e.find(".input-font_family").val(),n=this.getVariants(t),o=e.find(".input-variant"),a=void 0!==o.data("value")&&o.data("value").toString(),s=!1,l=o.data("default"),r=!1;o.hasClass("select2-hidden-accessible")&&(a=o.val(),o.select2("destroy").empty()),t&&""!==t?(e.find(".fusion-variant-wrapper").show(),_.each(n,function(e){e.id&&"italic"===e.id&&(e.id="400italic"),"function"==typeof e.id.toString&&e.id.toString()===a&&(s=!0),"function"==typeof e.id.toString&&"function"==typeof l.toString&&e.id.toString()===l.toString()&&(r=!0),i.push({id:e.id,text:e.label})}),o.select2({data:i}),!s&&r?a=l:s||"object"!=typeof n[0]||(a=n[0].id),o.val(a).trigger("change")):e.find(".fusion-variant-wrapper").hide()},renderSubset:function(e){var i=[],t=e.find(".input-font_family").val(),n=this.getSubsets(t),o=e.find(".input-subsets"),a=o.data("value"),s=!1,l=o.data("default"),r=!1;o.hasClass("select2-hidden-accessible")&&(a=o.val(),o.select2("destroy").empty()),t&&""!==t&&"object"==typeof n?(e.find(".fusion-subsets-wrapper").show(),_.each(n,function(e){e.id===a&&(s=!0),e.id===l&&(r=!0),i.push({id:e.id,text:e.label})}),o.select2({data:i}),!s&&r?a=l:s||"object"!=typeof n[0]||(a=n[0].id),o.val(a).trigger("change")):e.find(".fusion-subsets-wrapper").hide()},getVariants:function(i){var t=!1;return this.isCustomFont(i)?[{id:"400",label:"Normal 400"}]:(_.each(FusionPageBuilderApp.assets.webfonts.standard,function(e){if(i&&e.family===i)return t=e.variants,e.variants}),_.each(FusionPageBuilderApp.assets.webfonts.google,function(e){if(e.family===i)return t=e.variants,e.variants}),t)},getSubsets:function(i){var t=!1,e=FusionPageBuilderApp.assets.webfonts;return _.each(e.google,function(e){e.family===i&&(t=e.subsets)}),t},isCustomFont:function(i){var t=!1;return _.each(FusionPageBuilderApp.assets.webfonts.custom,function(e){e.family===i&&(t=!0)}),t}}),_.extend(FusionPageBuilder.ElementSettingsView.prototype,FusionPageBuilder.options.fusionDynamicData)})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(a){a(document).ready(function(){FusionPageBuilder.MultiElementSettingsView=FusionPageBuilder.ElementSettingsView.extend({events:function(){return _.extend({},FusionPageBuilder.ElementSettingsView.prototype.events,{"click .insert-slider-video":"addSliderVideo"})},addSliderVideo:function(e){var i,t,n,o;e&&e.preventDefault(),FusionPageBuilderApp.manualGenerator=FusionPageBuilderApp.shortcodeGenerator,FusionPageBuilderApp.manualEditor=FusionPageBuilderApp.shortcodeGeneratorEditorID,FusionPageBuilderApp.manuallyAdded=!0,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.shortcodeGeneratorEditorID="video",n=a(e.currentTarget).data("type"),i=fusionAllElements[n].params,t={},_.each(i,function(e){o=_.isObject(e.value)?e.default:e.value,t[e.param_name]=o}),this.collection.add([{type:"generated_element",added:"manually",element_type:n,params:t}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(r){var u,d,o,e,t,n,a;function i(i){if(n)return i();t?e.success(i):(t=!0,e=jQuery.ajax({url:a.ajaxurl,type:"post",dataType:"json",data:{action:"fusion_get_widget_form"}}).success(function(e){return t=!(n=!0),o=e.data,_.each(o,function(t,n){void 0===fusionAllElements.fusion_widget.params.type.value[n]&&jQuery.map(fusionAllElements.fusion_widget.params.type.value,function(e,i){e===t.name&&(t.title=i,o[i]=t,o[n].delete)})}),i&&i()}))}u=[],r(document).ready(function(){(a="undefined"!=typeof FusionApp?fusionAppConfig:fusionBuilderConfig).widget_element_enabled&&i(),FusionPageBuilder.BaseWidgetSettingsView=FusionPageBuilder.ElementSettingsView.extend({invalidWidgets:["Fusion_Widget_Social_Links"],widgetFieldName:function(e,i){var t=e.toLowerCase()+"__";try{t+=i.match(/\[(.*?)\]/g).slice(-1)[0].replace(/\[|(\])/g,"")}catch(e){}return t},registerWidget:function(e,i){var n,t,o,a,s,l;l=this,o={},n=r("<form></form>").html(e.form),t=["fieldset","input","select","textarea"].join(","),a=function(i,e){var t={};return _.each(e,function(e){t[e]=i[e]}),t},n.find(t).not('[type="button"]').each(function(){var t,e;switch(t=a(this,["id","className","name","tagName","type","value","placeholder","options","checked"]),e=l.widgetFieldName(i,t.name),t.options=_.map(t.options,function(e){return a(e,["value","text","selected"])}),t.tagName){case"INPUT":["text","number"].includes(t.type)?t.type="textfield":"checkbox"===t.type&&(t.type="radio_button_set",t.value={on:"On","":"Off"},t.default=t.checked?"on":"");break;case"SELECT":t.type="select",t.value=_.reduce(t.options,function(e,i){return i.selected&&(t.default=i.value),e[i.value]=i.text,e},{});break;case"TEXTAREA":t.type="textarea"}t.id&&(t.id="widget-menu-widget--menu_Link_color"===t.id?t.id.toLowerCase():t.id,t.heading=n.find('label[for="'+t.id+'"]').text()||t.placeholder),t.param_name=e,t.callback={},t.callback.function="fusion_get_widget_markup",t.callback.ajax=!0,"hidden"===t.type&&(delete t.dependency,t.hidden=!0),o[e]=t}),s=_.find(o,function(e){return!e.heading||!e.name}),u[i]={className:i,fields:o,data:e,isInvalid:s||this.invalidWidgets.includes(i),isCoreWidget:["WP_Widget_Text","WP_Widget_Media_Audio","WP_Widget_Media_Image","WP_Widget_Media_Video","WP_Widget_Media_Gallery","WP_Widget_Custom_HTML"].includes(i)}},registerWidgets:function(){var e=this;i(function(){e.widgetData=o,u.length||_.each(e.widgetData,e.registerWidget.bind(e)),e.setWidgetFields()})},clean:function(){this.destroyWidgetOptions(),this.deleteWpModels(),this.cleanForm()},cleanForm:function(){this.$el.find(".fusion-widget-settings-form").remove()},insertForm:function(){var e,i,t,n,o,a,s,l=this;e=this.$el.find("#general .fusion_widget .fusion-builder-option:first "),n=d.data,s=d.className,t={coreWidget:d.isCoreWidget,attributes:{id:n.id+"-"+this.cid,base:n.id,form:n.form,type:s,class:n.classname},widgetData:this.widgetData},this.appendedForm=this.formTemplate(t),e.after(this.appendedForm),t.coreWidget?(a=this.$el.find(".widget-inside").parent(),this.setFormValues(s),i=new jQuery.Event("widget-added"),"WP_Widget_Text"===s?wp.textWidgets.handleWidgetAdded(i,a):"WP_Widget_Custom_HTML"===s?wp.customHtmlWidgets.handleWidgetAdded(i,a):wp.mediaWidgets.handleWidgetAdded(i,a),this.$el.find(".widget-inside").show(),this.$el.find(".wp-editor-area").length&&setTimeout(function(){wp.textWidgets.widgetControls["text-"+l.cid].initializeEditor()},200),this.$el.find(".custom-html-widget-fields .code").length&&(o=this.$el.find(".custom-html-widget-fields .code"),l.codeBlock=o.next(".CodeMirror").get(0).CodeMirror,l.codeBlock||(l.codeBlock=CodeMirror.fromTextArea(o[0],{lineNumbers:!0,lineWrapping:!0,autofocus:!0,mode:"htmlmixed"})),setTimeout(function(){l.codeBlock.refresh(),l.codeBlock.focus()},100))):(a=this.$el.find(".fusion-widget-settings-form"),this.setFormValues(s),this.$el.find(".widget-inside").show())},setFormValues:function(e){var o=this,a=e.toLowerCase()+"__";_.each(this.model.attributes.params,function(e,i){var t,n;"type"!==i&&-1!==i.indexOf(a)&&(n='[name$="['+i.replace(a,"")+']"]',t=o.$el.find(n)),t&&t.length&&(t.is(":checkbox")?1===parseInt(e)||!0===e||"on"===e||"enabled"===e?t.prop("checked",!0):t.prop("checked",!1):t.val(e))})},deleteWpModels:function(){void 0!==wp.mediaWidgets.widgetControls&&void 0!==wp.mediaWidgets.modelCollection&&(wp.mediaWidgets.modelCollection.reset(),wp.mediaWidgets.widgetControls={}),void 0!==wp.textWidgets.widgetControls&&(wp.textWidgets.widgetControls={}),void 0!==wp.customHtmlWidgets.widgetControls&&(wp.customHtmlWidgets.widgetControls={})},destroyWidgetOptions:function(){this.$el.find(".wp-editor-area").each(function(){var e=jQuery(this).attr("id");void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))})},cleanWidget:function(){var t=this;d&&(_.each(d.fields,function(e,i){delete fusionAllElements.fusion_widget.params[i],delete t.model.attributes.params[i]}),d=null)},getWidget:function(){return d},setWidget:function(){var e=this.model.attributes.params.type;e&&u[e]&&(d=u[e])},updateWidget:function(){var t=this;!d||d.isCoreWidget||d.isInvalid||(fusionAllElements.fusion_widget.params=_.extend({type:fusionAllElements.fusion_widget.params.type},d.fields,fusionAllElements.fusion_widget.params),_.each(d.fields,function(e,i){t.model.attributes.params[i]||("object"==typeof e.value&&e.value[e.default]?t.model.attributes.params[i]=e.default:"object"!=typeof e.value&&(e.default||e.value)&&(t.model.attributes.params[i]=e.default||e.value))}))},setWidgetFields:function(){d&&d.className===this.model.attributes.params.type||(this.cleanWidget(),this.setWidget(),this.updateWidget())}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(n){n(document).ready(function(){FusionPageBuilder.MultiElementSortablesView=window.wp.Backbone.View.extend({initialize:function(){!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElement=!0),this.listenTo(FusionPageBuilderEvents,"fusion-multi-element-edited",this.generateContent),this.listenTo(FusionPageBuilderEvents,"fusion-multi-remove-sortables-view",this.removeView),this.element_type=this.$el.data("element_type"),this.child_views=[],this.fetchIds=[],this.childIds=[],this.updateGallery=!1,this.$el.attr("data-cid",this.attributes.cid),this.$sortable_options=this.$el.find(".fusion-builder-sortable-options"),this.$sortable_options.sortable({axis:"y",cancel:".fusion-builder-multi-setting-remove, .fusion-builder-multi-setting-options, .fusion-builder-multi-setting-clone",helper:"clone",update:function(){FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}}),this.$add_sortable_item=this.$el.find(".fusion-builder-add-multi-child").addClass("fusion-builder-add-sortable-initial")},events:{"click .fusion-builder-add-multi-child":"addChildElement"},render:function(){return this},addChildElement:function(e){var i,t,n,o={};e&&e.preventDefault(),i=fusionAllElements[this.element_type].params,n=void 0!==fusionAllElements[this.element_type].allow_generator?fusionAllElements[this.element_type].allow_generator:"",_.each(i,function(e){t=_.isObject(e.value)?e.default:e.value,o[e.param_name]=t}),this.model.collection.add([{type:"element",element_type:this.element_type,cid:FusionPageBuilderViewManager.generateCid(),view:this,created:"manually",multi:"multi_element_child",child_element:"true",parent:this.attributes.cid,params:o,allow_generator:n}]),this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},generateContent:function(){var i="";this.$sortable_options.find("li").each(function(){var e=n(this);i+=FusionPageBuilderApp.generateElementShortcode(e,!1)}),this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial")},updateGalleryContent:function(){var i="",t=this,e=FusionPageBuilderApp.collection.find(function(e){return e.get("cid")===t.attributes.parentCid});this.$sortable_options.find("li").each(function(){var e=n(this);i+=FusionPageBuilderApp.generateElementShortcode(e,!1)}),e.attributes.params.element_content=i,this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderEvents.trigger("fusion-element-added"),this.fetchIds=[],this.childIds=[]},removeView:function(e){e&&e.preventDefault(),this.remove()},generateMultiElementChildSortables:function(e,p,g,h){var b=this,i=jQuery.map(fusionMultiElements,function(e,i){return e}).join("|"),t=window.wp.shortcode.regexp(i),v=FusionPageBuilderApp.regExpShortcode(i),n=e.match(t);this.updateGallery=!1,""!==e&&this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),_.each(n,function(e){var i,t,n,o,a,s,l=e.match(v),r=l[2],u=""!==l[3]?window.wp.shortcode.attrs(l[3]):"",d=l[5],c="",f=(FusionPageBuilderViewManager.generateCid(),{params:{}}),m=void 0!==fusionAllElements[r].allow_generator?fusionAllElements[r].allow_generator:"";if(void 0!==u.named&&void 0!==u.named.title&&u.named.title.length?c=u.named.title:void 0!==u.named&&void 0!==u.named.title_front&&u.named.title_front.length?c=u.named.title_front:void 0!==u.named&&void 0!==u.named.name&&u.named.name.length?(c=u.named.name,void 0!==u.named.company&&u.named.company.length&&(c+=", "+u.named.company)):void 0!==u.named&&void 0!==u.named.name&&u.named.name.length?c=u.named.name:void 0!==u.named&&void 0!==u.named.image&&u.named.image.length&&"fusion_testimonial"!==r?-1!==(c=u.named.image).indexOf("/")&&-1===c.indexOf("[")&&(c=(c=c.split("/")).slice(-1)[0]):void 0!==u.named&&"image"===u.named.type&&void 0!==d&&d.length?-1!==(c=d).indexOf("/")&&-1===c.indexOf("[")&&(c=(c=c.split("/")).slice(-1)[0]):void 0!==u.named&&void 0!==u.named.video&&u.named.video.length?c=u.named.video:void 0!==u.named&&void 0!==d&&d.length&&(c=d),c=jQuery("<div/>").html(c).text(),c=jQuery("<div/>").html(c).text(),i={type:"element",element_type:p,element_name:c,cid:FusionPageBuilderViewManager.generateCid(),view:b,created:"auto",multi:"multi_element_child",child_element:"true",allow_generator:m,params:{},parent:b.attributes.cid},_.isObject(u.named)){for(t in u.named)n=t,("fusion_builder_column"===r&&"type"===n||"fusion_builder_column_inner"===r&&"type"===n)&&(f[n="layout"]=u.named[t]),f.params[n]=u.named[t];i=_.extend(i,f)}i.params.element_content=d,void 0!==fusionAllElements[r].option_dependency&&(o=fusionAllElements[r].option_dependency,a=f.params[o],s=f.params.element_content,f.params[a]=s),!0===g&&"fusion_content_box"===p&&(i.params.iconcolor="",i.params.backgroundcolor="",i.params.circlecolor="",i.params.circlebordercolor="",i.params.circlebordersize="",i.params.outercirclebordercolor="",i.params.outercirclebordersize="",i.params.animation_type=h.animation_type,i.params.animation_direction=h.animation_direction,i.params.animation_speed=h.animation_speed,i.params.link_target=h.link_target),"fusion_gallery"===b.model.attributes["data-element_type"]&&(void 0!==i.params.image&&""!==i.params.image||""!==i.params.image_id&&"NaN"!==i.params.image_id&&void 0!==i.params.image_id&&(void 0===wp.media.attachment(i.params.image_id).get("url")?(b.fetchIds.push(i.params.image_id),b.childIds.push(i.cid)):i.params.image=wp.media.attachment(i.params.image_id).get("url"),b.updateGallery=!0)),b.model.collection.add([i])}),"fusion_gallery"===b.model.attributes["data-element_type"]&&b.updateGallery&&(void 0!==b.fetchIds&&0<b.fetchIds.length?wp.media.query({post__in:b.fetchIds,posts_per_page:b.fetchIds.length}).more().then(function(){_.each(b.childIds,function(i){var e=FusionPageBuilderApp.collection.find(function(e){return e.get("cid")===i});void 0!==wp.media.attachment(e.attributes.params.image_id).get("url")&&(e.attributes.params.image=wp.media.attachment(e.attributes.params.image_id).get("url"))}),setTimeout(function(){b.updateGalleryContent()},200)}):setTimeout(function(){b.updateGalleryContent()},200))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(o){o(document).ready(function(){FusionPageBuilder.MultiElementSortableChild=window.wp.Backbone.View.extend({tagName:"li",className:"fusion-builder-data-cid",initialize:function(){this.template=FusionPageBuilder.template(o("#fusion-builder-multi-child-sortable").html()),this.listenTo(FusionPageBuilderEvents,"fusion-multi-child-update-preview",this.updatePreview)},events:{"click .fusion-builder-multi-setting-options":"showSettings","click .fusion-builder-multi-setting-remove":"removeView","click .fusion-builder-multi-setting-clone":"cloneElement"},render:function(){return this.$el.html(this.template({atts:this.model.attributes})),this},cloneElement:function(e){var i,t=this.$el.find(".multi-element-child-name").html();e&&e.preventDefault(),(i=o.extend(!0,{},this.model.attributes)).created="manually",i.cid=FusionPageBuilderViewManager.generateCid(),i.cloned=!0,i.targetElement=this.$el,i.titleLabel=t,FusionPageBuilderApp.collection.add(i),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},showSettings:function(e){var i,t,n={};e&&e.preventDefault(),(FusionPageBuilderApp.MultiElementChildSettings=!0)===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElementChild=!0),jQuery(document).find(".fusion-builder-option.range .fusion-hidden-value, .wp-color-picker, .has-child-dependency input, .has-child-dependency select, .has-child-dependency textarea, .has-child-dependency #fusion_builder_content_main, .has-child-dependency #fusion_builder_content_main_child").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){jQuery(this).val().length&&(n[jQuery(this).attr("id")]=jQuery(this).val())}),this.model.set({parent_values:n}),t={model:this.model,collection:this.collection,attributes:{"data-modal_view":"multi_element_child_settings"}},i=new FusionPageBuilder.ModalView(t),o(".fusion_builder_modal_multi_element_settings_container").last().after(i.render().el)},updatePreview:function(){var e,i,t,n,o=this.model.attributes,a=this.model;void 0!==o&&(e="",void 0!==o.params.title&&o.params.title.length?e=o.params.title:"fusion_flip_box"===a.get("element_type")&&void 0!==o.params.title_front&&o.params.title_front.length?e=o.params.title_front:"fusion_testimonial"===a.get("element_type")&&void 0!==o.params.name&&o.params.name.length?(e=o.params.name,void 0!==o.params.company&&o.params.company.length&&(e+=", "+o.params.company)):"fusion_testimonial"===a.get("element_type")&&void 0!==o.params.name&&o.params.name.length?e=o.params.name:void 0!==o.params.image&&o.params.image.length&&"fusion_testimonial"!==a.get("element_type")?(e=o.params.image,-1!==(i=e).indexOf("/")&&-1===e.indexOf("[")&&(e=(e=e.split("/")).slice(-1)[0]),_.isEmpty(e)&&(e=fusionBuilderText.image)):void 0!==o.params.video&&o.params.video.length?e=o.params.video:void 0!==o.params.element_content&&o.params.element_content.length&&(e=o.params.element_content),e=jQuery("<div/>").html(e).text(),(e=jQuery("<div/>").html(e).text())&&(e='<span class="fusion-child-name-label">'+e+"</span>",_.isEmpty(i)?jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e):(0===(t=i.substr(i.lastIndexOf("."))).indexOf(".")&&(i=(i=i.replace(/-\d+x\d+\./,".")).replace(t,"-66x66"+t)),(n=new Image).src=i,n.onload=function(){e='<img class="fusion-child-element-image" src="'+i+'" >'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)},n.onerror=function(){e='<span class="fusion-image-placeholder fusiona fusiona-image"></span>'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)})))},removeView:function(e){e&&e.preventDefault(),this.remove(),this.model.destroy(),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(r){r(document).ready(function(){FusionPageBuilder.ColumnLibraryView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(r("#fusion-builder-column-library-template").html()),events:{"click .fusion-builder-column-layouts li":"addColumns","click .fusion_builder_custom_columns_load":"addCustomColumn","click .fusion_builder_custom_sections_load":"addCustomSection","click .fusion-builder-section-next-page":"addNextPage"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeView),this.options=e},render:function(){var e=this;return this.$el.html(this.template(this.model.toJSON())),FusionPageBuilderApp.showSavedElements("columns",this.$el.find("#custom-columns")),"container"===FusionPageBuilderApp.activeModal&&FusionPageBuilderApp.showSavedElements("sections",this.$el.find("#custom-sections")),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomColumn:function(t){var e,i,n,o;t&&t.preventDefault(),FusionPageBuilderApp.activeModal="column",!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,e=this.model,i=r(t.currentTarget).data("layout_id"),o=r(t.currentTarget).find(".fusion_module_title").text(),n=r(t.currentTarget).closest("li").hasClass("fusion-global"),r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),r.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:n,fusion_layout_id:i},success:function(e){var i=JSON.parse(e);FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentRowId)},complete:function(){e.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_column+o,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}}))},addColumns:function(e){var o,i,a,s,l;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="column",o=this,i=(r(e.target).is("li")?r(e.target):r(e.target).closest("li")).data("layout").split(","),_.size(i),a=this.options.view,s=fusionAllElements.fusion_builder_column.params,_.each(i,function(e,i){var t,n={};_.each(s,function(e){l=_.isObject(e.value)?e.default:e.value,n[e.param_name]=l}),t={type:"fusion_builder_column",element_type:"fusion_builder_column",cid:FusionPageBuilderViewManager.generateCid(),parent:o.model.get("cid"),layout:e,view:a,params:n},o.collection.add([t])}),this.model.unset("added"),FusionPageBuilderEvents.trigger("fusion-columns-added"),e&&(fusionHistoryManager.turnOnTracking(),!0===FusionPageBuilderApp.newContainerAdded?(window.fusionHistoryState=fusionBuilderText.added_section,FusionPageBuilderApp.newContainerAdded=!1):window.fusionHistoryState=fusionBuilderText.added_columns,FusionPageBuilderEvents.trigger("fusion-element-added"))},removeView:function(){FusionPageBuilderApp.activeModal="",this.remove()},addCustomSection:function(t){var e,i,n,o,a=this.model,s=this.model.get("parent"),l=FusionPageBuilderViewManager.getView(s);o=l.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=o.find(".fusion-builder-data-cid").data("cid"),t&&t.preventDefault(),void 0!==l&&l.removeContainer(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,e=r(t.currentTarget).data("layout_id"),n=r(t.currentTarget).find(".fusion_module_title").text(),i=r(t.currentTarget).closest("li").hasClass("fusion-global"),r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),r.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:i,fusion_layout_id:e},success:function(e){var i=JSON.parse(e);FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,r(t.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),r(t.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()},complete:function(){a.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_section+n,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}}))},addNextPage:function(e){var i,t,n=this.model.get("parent"),o=FusionPageBuilderViewManager.getView(n);e&&e.preventDefault(),i=o.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=i.find(".fusion-builder-data-cid").data("cid"),t=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_next_page",added:"manually",module_type:"fusion_builder_next_page",cid:t,params:{},view:o,appendAfter:i,created:"auto"}]),void 0!==o&&(FusionPageBuilderApp.targetContainerCID="",o.removeContainer()),FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.DynamicSelection=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-dynamic-selection").html()),className:"fusion-builder-dynamic-selection option-field",events:{},render:function(){var e,i=this.model.get("option");return i.length&&i.attr("data-dynamic-selection",!0),e={params:FusionPageBuilderApp.dynamicValues.getOrderedParams(),option:i.attr("data-option-type")},this.$el.html(this.template(e)),this.initSelect(),this},initSelect:function(){var i=this,t=this.model.get("parent"),n=this.model.get("option"),o=this.model.get("param"),a=this.$el.find(".fusion-select-field");a.hasClass("fusion-select-inited")||(a.find("optgroup").each(function(){0===jQuery(this).find("option").length&&jQuery(this).remove()}),a.select2({placeholder:fusionBuilderText.select_dynamic_content}),a.on("change.select2",function(e){a.select2("close"),t.dynamicParams.addParam(o,jQuery(e.target).val()),t.initEditDynamic(n.find(".fusion-dynamic-content"),!0),i.removeView()}))},removeView:function(){var e=this.model.get("option"),i=this.model.get("parent");this.$el.remove(),i&&(i.dynamicSelection=!1),e.length&&e.attr("data-dynamic-selection",!1),this.model.destroy(),this.remove()}})}),(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDynamicData={optionDynamicData:function(e){var i=this;(e=e||this.$el).find('[data-dynamic="true"] .fusion-dynamic-content').each(function(){i.initEditDynamic(jQuery(this))})},initEditDynamic:function(i,e){var t=this.dynamicParams.getAll(),n=this,o=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),a=i.closest(".fusion-builder-option").attr("data-option-id"),s=FusionPageBuilderApp.dynamicValues.getOptions(),l="object"==typeof t&&"object"==typeof t[a]?t[a]:{data:void 0},r=!(!l||"object"!=typeof s[l.data])&&s[l.data],u=!!r&&r.fields,d=r&&"string"==typeof r.label?r.label:l.data,c="",f=i.find(".dynamic-param-fields"),m=jQuery.extend(!0,{},fusionDynamicData.commonDynamicFields),p="object"==typeof r.exclude&&_.values(r.exclude);"object"==typeof t[a]&&(p&&"object"==typeof m&&_.each(m,function(e,i){-1!==_.indexOf(p,i)&&delete m[i]}),"object"!=typeof m||_.isEmpty(m)||(u="object"==typeof u?_.extend(u,m):m),f.empty(),u&&(_.each(u,function(e,i){var t=l[i];c+=jQuery(o({field:e,value:t})).html()}),f.append(c)),r&&(i.find(".dynamic-title h3").text(d),i.find(".dynamic-wrapper").attr("data-id",l.data)),i.off("click"),i.on("click",".dynamic-title",function(){jQuery(this).parent().find(".dynamic-param-fields").slideToggle(300),jQuery(this).find(".dynamic-toggle-icon").hasClass("fusiona-pen")?jQuery(this).find(".dynamic-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus"):jQuery(this).find(".dynamic-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-pen")}),i.on("click",".dynamic-remove.fusiona-trash-o",function(e){e.preventDefault(),n.removeDynamicData(i)}),"function"==typeof this.optionInit&&this.optionInit(i),void 0!==e&&e&&(i.find(".dynamic-param-fields").show(),i.find(".dynamic-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus")))},removeDynamicData:function(e){var i=e.closest(".fusion-builder-option").attr("data-option-id");void 0!==this.dynamicParams&&this.dynamicParams.removeParam(i)},setDynamicParamValue:function(e,i,t){var n=e.parent().closest(".fusion-builder-option").attr("data-option-id");void 0!==this.dynamicParams&&this.dynamicParams.updateParam(n,i,t)}};FusionPageBuilder=FusionPageBuilder||{};var FusionPageBuilderEvents=_.extend({},Backbone.Events);function openShortcodeGenerator(e){var i,t="#"+e.parent().parent().find(".wp-editor-area").attr("id");window.cursorPosition=0,window.editorArea=t,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.isTinyMceActive()?window.SCmoduleContentEditorMode="tinymce":window.SCmoduleContentEditorMode="html","tinymce"!==window.SCmoduleContentEditorMode&&(window.cursorPosition=jQuery(t).getCursorPosition()),i=new FusionPageBuilder.ModalView({model:this.model,collection:FusionPageBuilderElements,attributes:{"data-modal_view":"all_elements_generator"},view:this}),jQuery("body").append(i.render().el)}!function(P){var m,t;P.fn.outerHTML=function(){return this.length?this[0].outerHTML||(e=this[0],(t=document.createElement("div")).appendChild(e.cloneNode(!0)),i=t.innerHTML,t=null,i):this;var e,i,t},window.fusionBuilderGetContent=function(e,i,t){var n;if(void 0===i&&(i=!1),void 0===t&&(t=!1),t||void 0===window.tinyMCE||!window.tinyMCE.get(e)||window.tinyMCE.get(e).isHidden()?P("#"+e).length&&(n=P("#"+e).val().replace(/\r?\n/g,"\r\n")):n=window.tinyMCE.get(e).getContent(),i&&void 0!==window.tinyMCE&&void 0!==n&&(n=(n=n.replace(/<p>\[/g,"[")).replace(/\]<\/p>/g,"]")),void 0!==n)return n.trim()},t=0,m=function(e,i){clearTimeout(t),t=setTimeout(e,i)},P(window).load(function(){P("#fusion_toggle_builder").data("enabled")&&P("#fusion_toggle_builder").trigger("click")}),P("#publishing-action #publish").on("click",function(){FusionPageBuilderApp.saveGlobal=!1}),P(window).bind("beforeunload",function(){var e="undefined"!=typeof tinymce&&tinymce.get("content");if((e&&!e.isHidden()&&e.isDirty()||wp.autosave&&wp.autosave.server.postChanged())&&!0===FusionPageBuilderApp.saveGlobal&&!P("#publish").hasClass("disable"))return FusionPageBuilderApp.saveGlobal=!1,""}),P(document).ready(function(){var e,o,a,s,l,i,t,n,r,u,d;function c(){var e=document.getElementById("fusion_builder_controls");fusionBuilderStickyHeader(e,jQuery("#wpadminbar").height())}function f(){FusionPageBuilderElements.reset(),FusionPageBuilderViewManager.set("elementCount",0),FusionPageBuilderViewManager.set("views",{}),P("#fusion_builder_container").html(""),FusionPageBuilderApp.shortcodeGenerator=!1}P(document).click(function(e){P(e.target).parents(".column-sizes").length||P(e.target).hasClass("fusion-builder-resize-column")||P(".column-sizes").hide()}),FusionPageBuilder.AppView=window.wp.Backbone.View.extend({el:P("#fusion_builder_main_container"),template:FusionPageBuilder.template(P("#fusion-builder-app-template").html()),events:{"click .fusion-builder-layout-button-save":"saveLayout","click .fusion-builder-layout-button-load":"loadLayout","click .fusion-builder-layout-button-delete":"deleteLayout","click .fusion-builder-layout-buttons-clear":"clearLayout","click .fusion-builder-demo-button-load":"loadDemoPage","click .fusion-builder-layout-custom-css":"customCSS","click .fusion-builder-template-buttons-save":"saveTemplateDialog","click #fusion-builder-layouts .fusion-builder-modal-close":"hideLibrary","click .fusion-builder-library-dialog":"openLibrary","mouseenter .fusion-builder-layout-buttons-history":"showHistoryDialog","mouseleave .fusion-builder-layout-buttons-history":"hideHistoryDialog","click .fusion-builder-element-button-save":"saveElement","click #fusion-load-template-dialog":"loadPreBuiltPage","click .fusion-builder-layout-buttons-toggle-containers":"toggleAllContainers","click .fusion-builder-global-tooltip":"unglobalize","click .fusion-builder-publish-tooltip":"publish",contextmenu:"contextMenu"},initialize:function(){this.builderActive=!1,this.pauseBuilder=!1,this.ajaxurl=fusionBuilderConfig.ajaxurl,this.fusion_load_nonce=fusionBuilderConfig.fusion_load_nonce,this.fusion_builder_plugin_dir=fusionBuilderConfig.fusion_builder_plugin_dir,this.layoutIsLoading=!1,this.layoutIsSaving=!1,this.saveGlobal=!1,this.layoutIsDeleting=!1,this.parentRowId="",this.parentColumnId="",this.targetContainerCID="",this.activeModal="",this.innerColumn="",this.blankPage="",this.newLayoutLoaded=!1,this.newContainerAdded=!1,this.fullWidth=fusionBuilderConfig.full_width,this.allContent="",this.shortcodeGenerator="",this.shortcodeGeneratorMultiElement="",this.shortcodeGeneratorMultiElementChild="",this.allowShortcodeGenerator="",this.shortcodeGeneratorActiveEditor="",this.shortcodeGeneratorEditorID="",this.manuallyAdded=!1,this.manualGenerator=!1,this.manualEditor="",this.fromExcerpt=!1,this.disable_encoding=fusionBuilderConfig.disable_encoding,this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.codeEditor="",this.MultiElementChildSettings=!1,this.listenTo(this.collection,"add",this.addBuilderElement),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-removed",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-show-loader",this.showLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-loader",this.hideLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-library",this.hideLibrary),this.listenTo(FusionPageBuilderEvents,"fusion-save-layout",this.saveLayout),this.listenTo(FusionPageBuilderEvents,"fusion-save-history-state",this.saveHistoryState),this.toggledContainers=!0,this.render(),"function"==typeof FusionPageBuilder.Assets&&(this.assets=new FusionPageBuilder.Assets),jQuery("body").hasClass("gutenberg-editor-page")||(P("#fusion_toggle_builder").hasClass("fusion_builder_is_active")&&this.initialBuilderLayout(!0),fusionHistoryManager.turnOnTracking(),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()),this.contextMenuView=!1,this.clipboard={},this.dynamicValues=new FusionPageBuilder.DynamicValues,"object"==typeof fusionDynamicData&&this.dynamicValues.addData(null,fusionDynamicData.dynamicOptions)},render:function(){return this.$el.html(this.template()),this.sortableContainers(),this},unglobalize:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params"),o=t.model.get("element_type");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_remove_global))return!1;delete n.fusion_global,t.model.set("params",n),t.$el.removeClass("fusion-global-element fusion-global-container fusion-global-column"),jQuery(e.currentTarget).remove(),t.$el.removeAttr("fusion-global-layout"),"fusion_builder_container"===o&&t.$el.find(".fusion-builder-container-content > .fusion-builder-section-content").removeAttr("fusion-global-layout"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.removed_global,FusionPageBuilderEvents.trigger("fusion-element-edited")},publish:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_publish))return!1;n.status="published",t.model.set("params",n),t.updateStatusIcons(),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.container_published,FusionPageBuilderEvents.trigger("fusion-element-edited")},isTinyMceActive:function(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()},base64Encode:function(e){var i,t,n,o,a,s,l=this._keyStr,r=0,u=0,d="",c=[];if(!e)return e;for(e=unescape(encodeURIComponent(e));i=(a=e.charCodeAt(r++)<<16|e.charCodeAt(r++)<<8|e.charCodeAt(r++))>>18&63,t=a>>12&63,n=a>>6&63,o=63&a,c[u++]=l.charAt(i)+l.charAt(t)+l.charAt(n)+l.charAt(o),r<e.length;);return d=c.join(""),((s=e.length%3)?d.slice(0,s-3):d)+"===".slice(s||3)},base64Decode:function(e){var i,t,n,o,a,s,l="",r=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");r<e.length;)i=this._keyStr.indexOf(e.charAt(r++))<<2|(o=this._keyStr.indexOf(e.charAt(r++)))>>4,t=(15&o)<<4|(a=this._keyStr.indexOf(e.charAt(r++)))>>2,n=(3&a)<<6|(s=this._keyStr.indexOf(e.charAt(r++))),l+=String.fromCharCode(i),64!==a&&(l+=String.fromCharCode(t)),64!==s&&(l+=String.fromCharCode(n));return l=this.utf8Decode(l)},utf8Decode:function(e){for(var i,t="",n=0,o=0,a=0;n<e.length;)(o=e.charCodeAt(n))<128?(t+=String.fromCharCode(o),n++):191<o&&o<224?(a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),n+=3);return t},fusionBuilderMCEremoveEditor:function(e){void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))},fusion_builder_sortable_text:function(e){e.find(".fusion-sortable-text-options").each(function(){var t=jQuery(this);t.sortable({handle:".fusion-sortable-move"}),t.on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).find("input").val()+"|"}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")}),t.on("click",".fusion-sortable-remove",function(e){e.preventDefault(),jQuery(e.target).closest(".fusion-sortable-option").remove(),t.trigger("sortupdate")}),t.on("change keyup","input",function(){t.trigger("sortupdate")}),t.prev(".fusion-builder-add-sortable-child").on("click",function(e){var i=t.next(".fusion-placeholder-example").clone(!0);e.preventDefault(),i.removeClass("fusion-placeholder-example").removeAttr("style").appendTo(t),setTimeout(function(){t.find(".fusion-sortable-option:last-child input").focus()},100),t.trigger("sortupdate")})})},fusion_builder_iconpicker:function(t,e,i,n){var o=jQuery(".fusion-icons-rendered").html(),a=jQuery(".fusion-icon-picker-nav-rendered").html(),s="",l=jQuery(i),r=l.parent(),u="",d="";""!==t&&("fusion-prefix-"===t.substr(0,14)?t=t.replace("fusion-prefix-",""):void 0===(t=t.split(" "))[1]&&(t[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(s=t[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(e,i){if(i[0]===s)return null!==i[2]&&(t[0]="fa-"+i[2]),null!==i[1]&&(t[1]=i[1]),!1})),r.find(".fusion-iconpicker-input").attr("value",t[0]+" "+t[1]))),l.html(o).before('<div class="fusion-icon-picker-nav">'+a+"</div>"),r.find(".fusion-icon-picker-nav > a").on("click",function(e){e.preventDefault(),jQuery(".fusion-icon-picker-nav-active").removeClass("fusion-icon-picker-nav-active"),jQuery(this).addClass("fusion-icon-picker-nav-active"),l.find(".fusion-icon-set").css("display","none"),l.find(jQuery(this).attr("href")).css("display","grid")}),""!==t&&(u="."+(Array.isArray(t)?t.join("."):t),l.find(u).parent().addClass("selected-element").css("display","flex"),d=l.find(".selected-element").closest(".fusion-icon-set").prepend(l.find(".selected-element")).attr("id"),r.find('.fusion-icon-picker-nav a[href="#'+d+'"]').trigger("click")),jQuery(n).on("change paste keyup",function(){var t=jQuery(this);m(function(){var e,i;if(t.val()){if((i=t.val().toLowerCase()).length<3)return;l.find(".fusion-icon-set .icon_preview").css("display","none"),e=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(i),_.each(e,function(e){l.find(".icon_preview."+e.name).css("display","flex")}),_.each(l.find(".fusion-icon-set"),function(t){var n=!1;t.classList.add("no-search-results"),jQuery(".icon_preview").each(function(e,i){"none"!==i.style.display&&t.classList.contains("no-search-results")&&(n=!0)}),n||t.querySelector(".no-search-results-notice")?n&&t.classList.remove("no-search-results"):jQuery(t).append('<div class="no-search-results-notice">'+fusionBuilderText.no_results_in.replace("%s",jQuery('a[href="#'+t.id+'"]').html())+"</div>")})}else l.find(".fusion-icon-set .icon_preview").css("display","flex"),_.each(l.find(".fusion-icon-set"),function(e){e.classList.remove("no-search-results")})},100)})},contextMenu:function(e){var i,t,n,o=this,a=jQuery(e.target),s=a.closest("[data-cid]:not(.fusion-builder-row-content)"),l="default";if(!a.hasClass("fusion_builder_blank_page")&&!a.closest(".fusion_builder_blank_page").length){if(a.data("cid")&&(s=a),a.hasClass("fusion-builder-section-header")||a.closest(".fusion-builder-section-header").length){if(a.hasClass("fusion-builder-section-name"))return;s=a.closest(".fusion_builder_container").find(".fusion-builder-section-content").first()}if(this.removeContextMenu(),e.preventDefault(),t=FusionPageBuilderViewManager.getView(s.data("cid"))){if(n=this.getElementType(t.model.attributes.element_type),jQuery("body").hasClass("fusion-builder-library-edit")&&!a.closest(".fusion-builder-row-container-inner").length){if(jQuery("body").hasClass("fusion-element-post-type-sections")&&(l="container"),jQuery("body").hasClass("fusion-element-post-type-columns")&&(l="column","fusion_builder_container"===n))return;if(jQuery("body").hasClass("fusion-element-post-type-elements")&&(l="element","fusion_builder_container"===n||"fusion_builder_column"===n||"fusion_builder_column_inner"===n))return}t&&(i={model:{parent:t.model,event:e,parentView:t,pageType:l}},this.contextMenuView=new FusionPageBuilder.ContextMenuView(i),this.$el.append(this.contextMenuView.render().el),this.$el.one("click",function(){o.removeContextMenu()}))}}},removeContextMenu:function(){this.contextMenuView&&"function"==typeof this.contextMenuView.removeMenu&&this.contextMenuView.removeMenu()},getElementType:function(e){return"fusion_builder_container"===e||"fusion_builder_column"===e||"fusion_builder_column_inner"===e?e:e in fusionMultiElements?"parent_element":-1!==_.values(fusionMultiElements).indexOf(e)?"child_element":"fusion_builder_row_inner"===e&&FusionPageBuilderApp.pauseBuilder?"fusion_builder_row_inner":"element"},fusionBuilderImagePreview:function(e){var i,t,n=e.siblings(".fusion-builder-upload-field"),o=n.siblings(".fusion-builder-upload-preview"),a=e.siblings(".upload-image-remove"),s=n.val().trim();if(i=0<=s.indexOf("<img")?s:'<img src="'+s+'" />',"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===s)return o.length&&(o.remove(),a.remove(),e.val("Upload Image")),t=e.parents(".fusion-builder-option").next().find("#"+e.data("param")+"_id"),"element_content"===e.data("param")&&(t=e.parents(".fusion-builder-option").next().find("#image_id")),void(t.length&&t.val(""));o.length||(e.siblings(".preview").before('<div class="fusion-builder-upload-preview"><strong class="fusion-builder-upload-preview-title">Preview</strong><div class="fusion-builder-preview-image"><img src="" width="300" height="300" /></div></div>'),e.after('<input type="button" class="button upload-image-remove" value="Remove" />'),e.val("Edit"),o=n.siblings(".fusion-builder-upload-preview")),o.find("img").replaceWith(i)}},FusionBuilderActivateUpload:function(e){e.click(function(e){var c,a,o,s,i,f=!1,m=!1,p="",l="",r="",g=P(this).closest(".fusion_builder_module_settings").data("element_type"),h=P(this).closest(".fusion-builder-option").data("option-id");return e&&e.preventDefault(),"fusion-multiple-upload"===(c=P(this)).data("id")&&(f=!0),"fusion-multiple-images"===c.data("id")&&(m=!0,o=jQuery(c.next(".fusion-multiple-image-container"))[0],s=jQuery(c).prev(".fusion-multi-image-input")),a=wp.media({library:{type:c.data("type")},title:c.data("title"),multiple:!(!f&&!m)&&"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog "+c.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=a,m&&"fusion_gallery"===g&&(i=s.val(),l="string"==typeof i?i.split(","):"",wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",a.options.syncSelection=!0,a.options.state=void 0!==i&&""!==i?"gallery-edit":"gallery"),a.on("open",function(){var e,i,t=a.state().get("selection"),n=a.state().get("library"),o=[];m?("fusion_gallery"===g&&"gallery-edit"===a.options.state||P(".fusion-builder-media-dialog").addClass("hide-menu"),jQuery.each(l,function(e,i){""!==i&&"NaN"!==i&&(void 0!==wp.media.attachment(i).get("url")?(t.add(wp.media.attachment(i)),n.add(wp.media.attachment(i))):o.push(i))}),0<o.length&&wp.media.query({post__in:o,posts_per_page:o.length}).more().then(function(){jQuery.each(l,function(e,i){""!==i&&"NaN"!==i&&(t.add(wp.media.attachment(i)),n.add(wp.media.attachment(i)))})})):(r=c.parents(".fusion-builder-option.upload").data("option-id"),void 0!==(i=void 0!==(i=c.parents(".fusion-builder-module-settings").find("#"+r+"_id").val())?i:c.parents(".fusion-builder-module-settings").find("#image_id").val())&&""!==i&&(i=i.split("|")[0]),e=wp.media.attachment(i),P(".fusion-builder-media-dialog").addClass("hide-menu"),i&&e.fetch({success:function(e){n.add(e?[e]:[]),t.add(e?[e]:[])}}))}),m&&"fusion_gallery"===g&&a.on("update",function(e){var i,t="";i=e.map(function(e){var i=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?t=e.attributes.sizes.thumbnail.url:e.attributes.url&&(t=e.attributes.url),m&&(p+='<div class="fusion-multi-image" data-image-id="'+i+'">',p+='<img src="'+t+'"/>',p+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',p+="</div>"),e.id}),s.val(i),jQuery(o).html(p)}),a.on("select insert",function(){var l,r,u,e,i,t,n,d=a.state();void 0===d.get("selection")?l=jQuery(a.$el).find("#embed-url-field").val():(e=d.get("selection").map(function(e){return e.id}),m&&s.val(e),f&&(i=jQuery(c).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child")).length&&(!(t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i.data("cid")}))||void 0!==t.attributes.params.image&&""!==t.attributes.params.image||jQuery(c).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child .fusion-builder-multi-setting-remove").trigger("click")),d.get("selection").map(function(t){var n,e,i,o=t.toJSON(),a=d.display(t).toJSON(),s={};r=o.id,u=a.size,o.sizes&&o.sizes[a.size]&&o.sizes[a.size].url?l=o.sizes[a.size].url:o.url&&(l=o.url),m&&(p+='<div class="fusion-multi-image" data-image-id="'+r+'">',p+='<img src="'+l+'"/>',p+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',p+="</div>"),f&&(n=fusionAllElements[g].element_child,e=fusionAllElements[g].params[h].child_params,i=void 0===fusionAllElements[g].params[h].create_children||fusionAllElements[g].params[h].create_children,_.each(e,function(e,i){s[i]=fusionAllElements[n].params[i].value}),_.each(e,function(e,i){fusionAllElements[n].params[i].value=t.attributes[e]}),"image"===h&&(fusionAllElements[g].params[h+"_id"].value=r+"|"+u),i&&(jQuery(c).parents(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview")),_.each(s,function(e,i){fusionAllElements[n].params[i].value=e}))})),jQuery(o).html(p),f||m||(c.siblings(".fusion-builder-upload-field").val(l).trigger("change"),n=c.parents(".fusion-builder-option").next().find("#"+h+"_id"),"element_content"===h&&(n=c.parents(".fusion-builder-option").next().find("#image_id")),n.length&&n.val(r+"|"+u),FusionPageBuilderApp.fusionBuilderImagePreview(c))}),a.open(),!1}),e.siblings(".fusion-builder-upload-field").on("input",function(){FusionPageBuilderApp.fusionBuilderImagePreview(P(this).siblings(".fusion-builder-upload-button"))}),e.siblings(".fusion-builder-upload-field").each(function(){FusionPageBuilderApp.fusionBuilderImagePreview(P(this).siblings(".fusion-builder-upload-button"))}),jQuery("body").on("click",".fusion-multi-image-remove",function(){var e,i,t,n=jQuery(this).parents(".fusion-multiple-upload-images").find(".fusion-multi-image-input");i=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(t=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(i))&&e.splice(t,1),e=e.join(","),n.val(e),jQuery(this).parent(".fusion-multi-image").remove()})},fusionBuilderActivateLinkSelector:function(e){var t,n,o=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),s=jQuery(".link-target"),l=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),r=window.wpLink,u=window.wpLinkL10n;jQuery(e).click(function(i){l.insertBefore(o),t=jQuery(i.target).prev(".fusion-builder-link-field"),n=t.val(),o.hide(),a.hide(),s.hide(),l.show(),(r=!window.wpLink&&P.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:u.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(e){i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation(),n=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),t.val(n).trigger("change"),o.show(),a.show(),s.show(),e.remove(),jQuery("#wp-link-cancel").unbind("click"),r.close()},r.open("fusion-custom-css-field"),jQuery("#wp-link-url").val(n)}),jQuery("body").on("click","#fusion-link-submit",function(){r.fusionUpdateLink(jQuery(this))}),jQuery("body").on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){o.show(),a.show(),s.show(),l.remove()})},fusionBuilderSetContent:function(e,i){void 0!==window.tinyMCE&&window.tinyMCE.get(e)&&!window.tinyMCE.get(e).isHidden()?(window.tinyMCE.get(e).getParam("wpautop",!0)&&void 0!==window.switchEditors&&(i=window.switchEditors.wpautop(i)),window.tinyMCE.get(e).setContent(i,{format:"html"})):P("#"+e).val(i)},layoutLoaded:function(){this.newLayoutLoaded=!0},clearLayout:function(e){if(e&&e.preventDefault(),!1===confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this_layout))return!1;this.blankPage=!0,this.clearBuilderLayout(!0),fusionHistoryManager.clearEditor("blank")},showHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").show()},hideHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").hide()},saveTemplateDialog:function(e){e&&e.preventDefault(),this.showLibrary(),P("#fusion-builder-layouts-templates-trigger").click()},loadPreBuiltPage:function(e){e&&e.preventDefault(),this.showLibrary(),P("#fusion-builder-layouts-demos-trigger").click()},saveLayout:function(e){var i,t,n,o,a,s,l,r,u,d=[];e&&e.preventDefault(),jQuery('input[id^="pyre_"], select[id^="pyre_"]').each(function(e){r=jQuery(this).attr("id"),u=jQuery(this).val(),void 0!==r&&void 0!==u&&(d[e]=[r,u])}),i=fusionBuilderGetContent("content",!0),t=P("#new_template_name").val(),n=P("#fusion-builder-layouts-templates .fusion-page-layouts"),o=P("#fusion_builder_main_container").data("post-id"),a=P("#fusion-builder-layouts-templates .fusion-page-layouts .fusion-empty-library-message"),s=P("#fusion-custom-css-field").val(),l=P("#page_template").val(),""!==t?(P.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:t,fusion_layout_content:i,fusion_layout_post_type:"fusion_template",fusion_current_post_id:o,fusion_custom_css:s,fusion_page_template:l,fusion_options:d},complete:function(e){n.prepend(e.responseText),a.hide()}}),P("#new_template_name").val("")):alert(fusionBuilderText.please_enter_template_name)},saveElement:function(e){var i;e&&e.preventDefault(),P(e.currentTarget).data("element-type"),i=P(e.currentTarget).data("element-cid"),FusionPageBuilderViewManager.getView(i).saveElement()},loadLayout:function(e){var i,t,n,o;e&&e.preventDefault(),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,i=P(e.currentTarget).closest("li"),t=P(e.currentTarget).data("load-type"),n=fusionBuilderGetContent("content"),o=jQuery("#fusion-custom-css-field").val(),P.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:i.data("layout_id")},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),P("body").removeClass("fusion_builder_inner_row_no_scroll"),P(".fusion_builder_modal_inner_row_overlay").remove(),P("#fusion-builder-layouts").hide()},success:function(e){var i;FusionPageBuilderApp.layoutLoaded(),i=JSON.parse(e),"above"===t?(n=i.post_content+n,void 0!==i.custom_css&&P("#fusion-custom-css-field").val(i.custom_css+"\n"+o)):"below"===t?(n+=i.post_content,void 0!==i.custom_css&&(o.length?P("#fusion-custom-css-field").val(o+"\n"+i.custom_css):P("#fusion-custom-css-field").val(i.custom_css))):(n=i.post_content,void 0!==i.custom_css&&P("#fusion-custom-css-field").val(i.custom_css),jQuery.each(i.post_meta,function(e,i){jQuery("#"+e).val(i).trigger("change")})),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(n),void 0!==i.page_template&&P("#page_template").val(i.page_template),FusionPageBuilderApp.layoutIsLoading=!1},complete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}}))},loadDemoPage:function(e){var i,t,n,o;if(e&&e.preventDefault(),!1===confirm(fusionBuilderText.importing_single_page))return!1;!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,i=P(e.currentTarget).data("page-name"),t=P(e.currentTarget).data("demo-name"),n=P(e.currentTarget).data("post-id"),P.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_demo",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,page_name:i,demo_name:t,post_id:n},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),P("body").removeClass("fusion_builder_inner_row_no_scroll"),P(".fusion_builder_modal_inner_row_overlay").remove(),P("#fusion-builder-layouts").hide()},success:function(e){var i,t;FusionPageBuilderApp.layoutLoaded(),i=JSON.parse(e),o=i.post_content,FusionPageBuilderApp.clearBuilderLayout(!1),FusionPageBuilderApp.createBuilderLayout(o),void 0!==i.page_template&&P("#page_template").val(i.page_template),t=i.meta,_.each(t,function(e,i){P("#"+i).val(e).trigger("change")}),FusionPageBuilderApp.layoutIsLoading=!1},complete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}}))},deleteLayout:function(e){var i,t,n=!1;if(e&&(e.preventDefault(),P(e.currentTarget).closest("li").hasClass("fusion-global")?(t=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_global),n=!0):t=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this),!1===t))return!1;!0!==this.layoutIsDeleting&&(this.layoutIsDeleting=!0,i=P(e.currentTarget).closest("li"),P.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_delete_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:i.data("layout_id")},success:function(){var e="elements";i.parents("#fusion-builder-layouts-templates").length&&(e="templates"),i.remove(),FusionPageBuilderApp.layoutIsDeleting=!1,P("#fusion-builder-layouts-"+e+" .fusion-page-layouts").find("li").length||P("#fusion-builder-layouts-"+e+" .fusion-page-layouts .fusion-empty-library-message").show(),!0===n&&P.each(P('div[fusion-global-layout="'+i.data("layout_id")+'"]'),function(e,i){P(this).hasClass("fusion-builder-section-content")?P(this).parent().parent().find("a.fusion-builder-remove").first().trigger("click"):(P(this).find("a.fusion-builder-remove").first().trigger("click"),P(this).find("a.fusion-builder-remove-inner-row").first().trigger("click"))})}}))},openLibrary:function(e){e&&e.preventDefault(),this.showLibrary(),P("#fusion-builder-layouts-templates-trigger").click()},showLibrary:function(e){e&&e.preventDefault(),P("#fusion-builder-layouts").show(),P("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>'),setTimeout(function(){P(".fusion-builder-save-element-input, #new_template_name").focus()},20)},hideLibrary:function(e){e&&e.preventDefault(),P("#fusion-builder-layouts").hide(),P("body").removeClass("fusion_builder_inner_row_no_scroll"),P(".fusion_builder_modal_inner_row_overlay").remove(),P(".fusion-save-element-fields").remove()},showLoader:function(){P("#fusion_builder_main_container").css("height","148px"),P("#fusion_builder_container").hide(),P("#fusion-loader").fadeIn("fast")},hideLoader:function(){P("#fusion_builder_container").fadeIn("fast"),P("#fusion_builder_main_container").removeAttr("style"),P("#fusion-loader").fadeOut("fast")},sortableContainers:function(){this.$el.sortable({handle:".fusion-builder-section-header",items:".fusion_builder_container, .fusion-builder-next-page",cancel:".fusion-builder-section-name, .fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-element",cursor:"move",update:function(){fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_container,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},initialBuilderLayout:function(e){FusionPageBuilderViewManager.removeViews(),FusionPageBuilderEvents.trigger("fusion-show-loader"),setTimeout(function(){var i=fusionBuilderGetContent("content",!0,e),t="",n="",o="";try{jQuery("body").hasClass("fusion-builder-library-edit")||(i=FusionPageBuilderApp.validateContent(i)),FusionPageBuilderApp.createBuilderLayout(i),FusionPageBuilderEvents.trigger("fusion-hide-loader")}catch(e){FusionPageBuilderApp.fusionBuilderSetContent("content",i),jQuery("#fusion_toggle_builder").trigger("click"),t=FusionPageBuilderApp.$el.find("#content-error"),n=FusionPageBuilderApp.$el,o=t.clone(),t.dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,buttons:{OK:function(){jQuery(this).dialog("close")}},close:function(){n.append(o)}}),t.dialog("open")}},50)},validateContent:function(t){var n,i,o,e=""===t,a="",s=[],l=[];if(-1!==t.indexOf("[fullwidth"))throw"Avada 4.0.3 or earlier fullwidth container used!";return e||(t=(t=t.replace(/\[fusion\_text \/\]/g,"[fusion_text][/fusion_text]").replace(/\[\/fusion\_text\]\[\/fusion\_text\]/g,"[/fusion_text]")).replace(/\$\$/g,"&#36;&#36;"),a=t,a=wp.shortcode.replace("fusion_builder_container",a,function(){return"@|@"}),a=(a=wp.shortcode.replace("fusion_builder_next_page",a,function(){return"@|@"})).trim().split("@|@"),_.each(a,function(e){""!==e.trim()&&(t=t.replace(e,'[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]'+e+"[/fusion_builder_row][/fusion_builder_container]"))}),a=wp.shortcode.replace("fusion_builder_container",t,function(e){l.push(e.content)}),_.each(l,function(e){e=wp.shortcode.replace("fusion_builder_row",e,function(e){return e.content}),e=(e=wp.shortcode.replace("fusion_builder_column",e,function(){return"@|@"})).trim().split("@|@"),_.each(e,function(e){""!==e.trim()&&"[fusion_builder_row][/fusion_builder_row]"!==e.trim()&&(i='[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+e+"[/fusion_builder_column]",t=t.replace(e,i))})}),a=wp.shortcode.replace("fusion_builder_column_inner",t,function(e){s.push(e.content)}),a=wp.shortcode.replace("fusion_builder_column",t,function(e){s.push(e.content)}),_.each(s,function(i){n=fusionAllElements,_.each(n,function(e){void 0===e.generator_only&&(i=wp.shortcode.replace(e.shortcode,i,function(){return"@|@"}))}),i=i.trim().split("@|@"),_.each(i,function(e){""!==e.trim()&&"<br />"!==e.trim()&&(o="@=%~@","@"===e.slice(-1)&&(o="#=%~#"),t=t.replace(e,"[fusion_text]"+e.slice(0,-1)+o+e.slice(-1)+"[/fusion_text]"))})}),t=t.replace(/@=%~@/g,"").replace(/#=%~#/g,""),t=wp.shortcode.replace("fusion_text",t,function(e){if(n=fusionAllElements,a=e.content,_.each(n,function(e){void 0===e.generator_only&&(a=wp.shortcode.replace(e.shortcode,a,function(){return"|"}))}),!a.replace(/\|/g,"").length)return e.content})),t=t.replace(/&#36;&#36;/g,function(){return"$$"})},validateLibraryContent:function(e){var i='[fusion_builder_container hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]',t="[/fusion_builder_row][/fusion_builder_container]";return""===e||(jQuery("body").hasClass("fusion-element-post-type-elements")?e=i+'[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+e+"[/fusion_builder_column]"+t:jQuery("body").hasClass("fusion-element-post-type-columns")&&(e=i+e+t)),e=e.replace(/&#36;&#36;/g,function(){return"$$"})},clearBuilderLayout:function(e){this.$el.find(".fusion-builder-blank-page-content").each(function(){var e=P(this),i=FusionPageBuilderViewManager.getView(e.data("cid"));void 0!==i&&i.removeBlankPageHelper()}),this.$el.find(".fusion-builder-section-content").each(function(){var e=P(this),i=FusionPageBuilderViewManager.getView(e.data("cid"));void 0!==i&&i.removeContainer()}),e&&!0===this.blankPage&&(this.$el.find(".fusion-builder-blank-page-content").length||this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]"),this.blankPage=!1)},convertGalleryElement:function(e){var i=window.wp.shortcode.regexp("fusion_gallery"),s=this.regExpShortcode("fusion_gallery"),t=e.match(i),l=e,r=[];return _.each(t,function(e){var i,t=e.match(s),n=""!==t[3]?window.wp.shortcode.attrs(t[3]):"",o="",a="";void 0!==n.named.image_ids&&(i=n.named.image_ids.split(","),_.each(i,function(e){o+='[fusion_gallery_image image="" image_id="'+e+'" /]',r.push(e)}),a=e.replace("][/fusion_gallery]","]"+o+"[/fusion_gallery]").replace("/]","]"+o+"[/fusion_gallery]").replace('image_ids="'+n.named.image_ids+'" ',""),l=l.replace(e,a))}),wp.media.query({post__in:r,posts_per_page:r.length}).more(),l},createBuilderLayout:function(e){jQuery("body").hasClass("fusion-builder-library-edit")&&(e=FusionPageBuilderApp.validateLibraryContent(e)),e=this.convertGalleryElement(e),this.shortcodesToBuilder(e),jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():this.builderToShortcodes()},shortcodesToBuilder:function(e,v,y,w){var B,P,F,i,t;""!==e||this.$el.find(".fusion-builder-blank-page-content").length?(B=this,t=_.keys(fusionAllElements).join("|"),P=window.wp.shortcode.regexp(t),F=this.regExpShortcode(t),i=e.match(P),_.each(i,function(e){var i,t,n,o,a,s,l,r,u,d,c=e.match(F),f=c[2],m=""!==c[3]?window.wp.shortcode.attrs(c[3]):"",p=void 0!==c[5]?c[5]:"",g=FusionPageBuilderViewManager.generateCid(),h={params:{}},b=void 0!==p&&""!==p&&p.match(P);if(i={type:f,element_type:f,cid:g,created:"manually",multi:"",params:{},allow_generator:void 0!==fusionAllElements[f].allow_generator?fusionAllElements[f].allow_generator:""},"fusion_builder_container"===f&&"fusion_builder_next_page"===f||(i.parent=v),"fusion_builder_container"!==f&&"fusion_builder_row"!==f&&"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f&&"fusion_builder_row_inner"!==f&&"fusion_builder_blank_page"!==f&&"fusion_builder_next_page"!==f&&(-1===f.indexOf("fusion_")&&-1===f.indexOf("layerslider")&&-1===f.indexOf("rev_slider")&&void 0===fusionAllElements[f]||(i.type="element")),_.isObject(m.named)){for(t in"fusion_builder_container"!==f&&"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f||void 0!==m.named.background_blend_mode||(backgroundColor=m.named.background_color,videoBg="fusion_builder_container"===f&&void 0!==m.named.video_bg?m.named.video_bg:"","fusion_builder_container"!==f||"undefined"!=typeof backgroundColor&&""!==backgroundColor||(backgroundColor=fusionAllElements[f].defaults.background_color),""!==backgroundColor&&(alphaBackgroundColor=jQuery.Color(backgroundColor).alpha(),alphaBackgroundColor<1&&0!==alphaBackgroundColor&&(""!==m.named.background_image||""!==videoBg)&&(m.named.background_blend_mode="overlay"))),"fusion_builder_container"!==f&&"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f||void 0===m.named.radial_direction||(d={bottom:"center bottom","bottom center":"center bottom",left:"left center",right:"right center",top:"center top",center:"center center","center left":"left center"},m.named.radial_direction in d&&(m.named.radial_direction=d[m.named.radial_direction])),"fusion_fontawesome"===f&&(void 0===m.named.iconcolor_hover&&"string"==typeof m.named.iconcolor&&(m.named.iconcolor_hover=m.named.iconcolor),void 0===m.named.circlecolor_hover&&"string"==typeof m.named.circlecolor&&(m.named.circlecolor_hover=m.named.circlecolor),void 0===m.named.circlebordercolor_hover&&"string"==typeof m.named.circlebordercolor&&(m.named.circlebordercolor_hover=m.named.circlebordercolor)),"fusion_countdown"===f&&(void 0===m.named.counter_border_radius&&"string"==typeof m.named.border_radius&&(m.named.counter_border_radius=m.named.border_radius),void 0===m.named.label_color&&"string"==typeof m.named.counter_text_color&&(m.named.label_color=m.named.counter_text_color)),m.named)n=t,"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f||"type"!==n||(h[n="layout"]=m.named[t]),h.params[n]=m.named[t],"fusion_products_slider"===f&&"cat_slug"===t&&(h.params.cat_slug=m.named[t].replace(/\|/g,",")),"gradient_colors"===t&&(delete h.params[n],-1!==m.named[t].indexOf("|")?(h.params.button_gradient_top_color=m.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)"),h.params.button_gradient_bottom_color=m.named[t].split("|")[1]?m.named[t].split("|")[1].replace("transparent","rgba(255,255,255,0)"):m.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)")):h.params.button_gradient_bottom_color=h.params.button_gradient_top_color=m.named[t].replace("transparent","rgba(255,255,255,0)")),"gradient_hover_colors"===t&&(delete h.params[n],-1!==m.named[t].indexOf("|")?(h.params.button_gradient_top_color_hover=m.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)"),h.params.button_gradient_bottom_color_hover=m.named[t].split("|")[1]?m.named[t].split("|")[1].replace("transparent","rgba(255,255,255,0)"):m.named[t].split("|")[0].replace("transparent","rgba(255,255,255,0)")):h.params.button_gradient_bottom_color_hover=h.params.button_gradient_top_color_hover=m.named[t].replace("transparent","rgba(255,255,255,0)")),"overlay_color"===t&&""!==m.named[t]&&"fusion_builder_container"===f&&(delete h.params[n],l=void 0!==m.named.overlay_opacity?m.named.overlay_opacity:1,h.params.background_color=jQuery.Color(m.named[t]).alpha(l).toRgbaString()),"overlay_opacity"===t&&delete h.params[n],"scrolling"===t&&"fusion_blog"===f&&(delete h.params.paging,"no"===(void 0!==m.named.paging?m.named.paging:"")&&"pagination"===m.named.scrolling&&(h.params.scrolling="no")),"fusion_portfolio"===f&&("layout"===t&&("grid"===m.named[t]&&m.named.hasOwnProperty("boxed_text")?m.named.boxed_text="no_text":"grid-with-text"===m.named[t]&&(h.params[t]="grid")),"boxed_text"===t&&(h.params.text_layout=m.named[t],delete h.params[t]),"content_length"===t&&"full-content"===m.named[t]&&(h.params[t]="full_content")),"fusion_pricing_table"===f&&("backgroundcolor"!==t||m.named.hasOwnProperty("background_color_hover")||(h.params.background_color_hover=m.named.bordercolor)),"padding"!==t||"fusion_widget_area"!==f&&"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f||(1===(r=m.named[t].split(" ")).length&&(h.params.padding_top=r[0],h.params.padding_right=r[0],h.params.padding_bottom=r[0],h.params.padding_left=r[0]),2===r.length&&(h.params.padding_top=r[0],h.params.padding_right=r[1],h.params.padding_bottom=r[0],h.params.padding_left=r[1]),3===r.length&&(h.params.padding_top=r[0],h.params.padding_right=r[1],h.params.padding_bottom=r[2],h.params.padding_left=r[1]),4===r.length&&(h.params.padding_top=r[0],h.params.padding_right=r[1],h.params.padding_bottom=r[2],h.params.padding_left=r[3]),delete h.params[t]);"fusion_table"===f&&void 0===m.named.fusion_table_type&&("1"!==p.charAt(18)&&"2"!==p.charAt(18)||(h.params.fusion_table_type=p.charAt(18))),"fusion_content_boxes"!==f&&"fusion_flip_boxes"!==f||(void 0!==m.named.image_width&&(h.params.image_max_width=m.named.image_width),p=p.replace(/image_width/g,"image_max_width")),"fusion_button"!==f&&"fusion_tagline_box"!==f||(u="fusion_tagline_box"===f?"button_":"",void 0!==m.named[u+"shape"]&&("square"===m.named[u+"shape"]?h.params[u+"border_radius"]="0":"round"===m.named[u+"shape"]?(h.params[u+"border_radius"]="2","3d"===m.named.type&&(h.params[u+"border_radius"]="4")):"pill"===m.named[u+"shape"]?h.params[u+"border_radius"]="25":""===m.named[u+"shape"]&&(h.params[u+"border_radius"]=""),delete h.params[u+"shape"])),"fusion_button"===f&&(void 0===m.named.border_color&&void 0!==m.named.accent_color&&""!==m.named.accent_color&&(h.params.border_color=m.named.accent_color),void 0===m.named.border_hover_color&&void 0!==m.named.accent_hover_color&&""!==m.named.accent_hover_color&&(h.params.border_hover_color=m.named.accent_hover_color)),"fusion_register"===f&&void 0===m.named.register_note&&(h.params.register_note=fusionBuilderText.user_login_register_note),i=_.extend(i,h)}b||"fusion_builder_column"===f||(i.params.element_content=p),f in fusionMultiElements&&(i.multi="multi_element_parent"),void 0!==fusionAllElements[f].option_dependency&&(o=fusionAllElements[f].option_dependency,a=h.params[o],s=h.params.element_content,h.params[a]=s),b&&"fusion_builder_container"!==f&&"fusion_builder_row"!==f&&"fusion_builder_row_inner"!==f&&"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f&&"fusion_builder_next_page"!==f&&(i.params.element_content=p),void 0!==y&&y&&(i.targetElement=y),void 0!==w&&w&&(i.targetElementPosition=w),B.collection.add([i]),b&&("fusion_builder_container"!==f&&"fusion_builder_row"!==f&&"fusion_builder_row_inner"!==f&&"fusion_builder_column"!==f&&"fusion_builder_column_inner"!==f||B.shortcodesToBuilder(p,g))})):this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]")},addBuilderElement:function(i){var e,t,n,o,a={model:i,collection:FusionPageBuilderElements};switch(i.get("type")){case"fusion_builder_blank_page":e=new FusionPageBuilder.BlankPageView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("view"))?this.$el.find("#fusion_builder_container").append(e.render().el):i.get("view").$el.after(e.render().el);break;case"fusion_builder_container":""!==FusionPageBuilderApp.targetContainerCID&&(i.attributes.view=FusionPageBuilderViewManager.getView(FusionPageBuilderApp.targetContainerCID),FusionPageBuilderApp.targetContainerCID=""),e=new FusionPageBuilder.ContainerView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("view"))?(this.$el.find("#fusion_builder_container").append(e.render().el),this.$el.find(".fusion_builder_blank_page").remove()):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("view").$el.after(e.render().el):i.get("view").$el.before(e.render().el),"manually"!==i.get("created")&&e.addRow(),(!_.isUndefined(i.attributes.params.admin_toggled)&&"no"===i.attributes.params.admin_toggled||_.isUndefined(i.attributes.params.admin_toggled))&&(FusionPageBuilderApp.toggledContainers=!1,P(".fusion-builder-layout-buttons-toggle-containers").find("span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"));break;case"fusion_builder_row":e=new FusionPageBuilder.RowView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").hide().end().append(e.render().el),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_row_inner":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),e=new FusionPageBuilder.InnerRowView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("appendAfter"))?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(e.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").before(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-column-controls").after(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el):(i.get("appendAfter").after(e.render().el),i.unset("appendAfter")),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_column":i.get("layout")&&(a.className="fusion-builder-column fusion-builder-column-outer fusion-builder-column-"+i.get("layout"),e=new FusionPageBuilder.ColumnView(a),_.isUndefined(i.get("cloned"))||!0!==i.get("cloned")||(i.targetElement=e.$el,i.unset("cloned")),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?(void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container .fusion-builder-empty-section").after(e.render().el),i.unset("from")):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el));break;case"fusion_builder_column_inner":a.className="fusion-builder-column fusion-builder-column-inner fusion-builder-column-"+i.get("layout"),e=new FusionPageBuilder.NestedColumnView(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el);break;case"element":a.attributes={"data-cid":i.get("cid")},void 0!==i.get("multi")&&"multi_element_child"===i.get("multi")?(e=new FusionPageBuilder.MultiElementSortableChild(a),i.targetElement=e.$el,i.attributes.view.child_views.push(e),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("targetElement"))?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").append(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el),_.isUndefined(i.get("titleLabel"))||(_.isUndefined(i.get("cloned"))||e.$el.find(".multi-element-child-name").html(i.get("titleLabel")),i.unset("cloned"))):(FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),e=new FusionPageBuilder.ElementView(a),void 0!==(t=this.collection.find(function(e){return e.get("cid")===i.get("parent")}))&&"fusion_builder_column_inner"===t.get("type")?_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element").before(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)").before(e.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(e.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(e.render().el):i.get("targetElement").before(e.render().el),FusionPageBuilderViewManager.addView(i.get("cid"),e),"manually"===i.get("added")?(a.attributes={"data-modal_view":"element_settings"},e=new FusionPageBuilder.ModalView(a),P("body").append(e.render().el)):(n=i.get("element_type"),void 0!==fusionAllElements[n].preview&&(o=new FusionPageBuilder.ElementPreviewView(a),e.$el.find(".fusion-builder-module-preview").append(o.render().el))));break;case"generated_element":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),"fusion_builder_column_inner"!==i.get("element_type")&&"fusion_builder_column"!==i.get("element_type")&&(a.attributes={"data-modal_view":"element_settings"},e=new FusionPageBuilder.ModalView(a),P("body").append(e.render().el));break;case"fusion_builder_next_page":e=new FusionPageBuilder.NextPage(a),FusionPageBuilderViewManager.addView(i.get("cid"),e),_.isUndefined(i.get("appendAfter"))?P(".fusion_builder_container:last-child").after(e.render().el):i.get("appendAfter").next().next().hasClass("fusion-builder-next-page")||i.get("appendAfter").after(e.render().el)}},regExpShortcode:_.memoize(function(e){return new RegExp("\\[(\\[?)("+e+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)")}),findShortcodeMatches:function(e,i){var t,n;return _.isObject(e)&&(e=e.value),t="",e=void 0!==e?e:"",n=window.wp.shortcode.regexp(i),new RegExp("\\[(\\[?)("+i+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)"),void 0!==e&&""!==e&&(t=e.match(n)),t},libraryBuilderToShortcodes:function(){var e,i,t="";jQuery("body").hasClass("fusion-element-post-type-elements")?jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").length?(e=jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getInnerRowContent()):jQuery(".fusion_module_block").length&&(t=FusionPageBuilderApp.generateElementShortcode(jQuery(".fusion_module_block"),!1)):jQuery("body").hasClass("fusion-element-post-type-columns")?jQuery(".fusion-builder-column-outer").length&&(e=jQuery(".fusion-builder-column-outer").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getColumnContent(jQuery(".fusion-builder-column-outer"))):jQuery("body").hasClass("fusion-element-post-type-sections")&&jQuery(".fusion-builder-section-content").length&&(e=jQuery(".fusion-builder-section-content.fusion-builder-data-cid").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getContainerContent()),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",t),FusionPageBuilderEvents.trigger("fusion-save-history-state")},500)},builderToShortcodes:function(){var n="",i=this;jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():"undefined"===this.pauseBuilder||this.pauseBuilder||(this.$el.find(".fusion_builder_container").each(function(){var e=P(this).find(".fusion-builder-section-content");n+=i.generateElementShortcode(P(this),!0),e.find(".fusion_builder_row").each(function(){var e=P(this);n+="[fusion_builder_row]",e.find(".fusion-builder-column-outer").each(function(){var e=P(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);n+=t.getColumnContent(e)}),n+="[/fusion_builder_row]"}),n+="[/fusion_builder_container]",P(this).next().hasClass("fusion-builder-next-page")&&(n+="[fusion_builder_next_page]")}),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",n),FusionPageBuilderEvents.trigger("fusion-save-history-state"),FusionPageBuilderApp.setGoogleFonts(n)},500))},setGoogleFonts:function(e){var i={},t=jQuery("#fusion-google-fonts-field"),n=t.val();if(n&&""!==n)try{n=JSON.parse(n)}catch(e){}i=this.setElementFonts(e,i),i=this.setInlineFonts(e,i),"object"==typeof n?(_.each(n,function(e,t){_.each(e,function(e,i){n[t][i]=_.values(e)})}),_.isEqual(n,i)||(_.isEmpty(i)&&(i=""),n=i)):_.isEmpty(i)||(n=i),t.val(JSON.stringify(n))},setElementFonts:function(e,t){var i,n,a={},s=[];return""!==e&&-1!==e.indexOf("fusion_font_")&&(i=new RegExp('(fusion_font_[^=]*=")([^"]*)"',"g"),"object"==typeof(n=e.match(i))&&_.each(n,function(e,i){var t=e.slice(0,-1).split('="'),n=t[0].replace("fusion_font_family_","").replace("fusion_font_subset_","").replace("fusion_font_variant_",""),o="family";-1!==t[0].indexOf("fusion_font_subset_")?o="subset":-1!==t[0].indexOf("fusion_font_variant_")&&(o="variant"),""===t[1]&&"family"===o||("object"!=typeof a[n]?a[n]={}:"family"===o&&(s.push(a[n]),a[n]={}),a[n][o]=t[1],void 0!==a[n].family&&void 0!==a[n].subset&&void 0!==a[n].variant&&(s.push(a[n]),delete a[n]))}),_.each(a,function(e,i){void 0!==e.family&&""!==e.family&&s.push(a[i])}),_.each(s,function(e,i){void 0!==e.family&&""!==e.family&&(void 0===t[e.family]&&(t[e.family]={variants:[],subsets:[]}),"string"!=typeof e.variant||t[e.family].variants.includes(e.variant)||t[e.family].variants.push(e.variant),"string"!=typeof e.subset||t[e.family].subsets.includes(e.subset)||t[e.family].subsets.push(e.subset))})),t},setInlineFonts:function(e,t){var i,n,o={},a=[],s=[];return""!==e&&-1!==e.indexOf("data-fusion-google-")&&(i=new RegExp('data-fusion-google-[^=]*="([^"]*)"',"g"),"object"==typeof(n=e.match(i))&&_.each(n,function(e,i){var t=e.slice(0,-1).split('="'),n="family";-1!==t[0].indexOf("data-fusion-google-subset")?n="subset":-1!==t[0].indexOf("data-fusion-google-variant")&&(n="variant"),"string"==typeof o.family&&"family"===n&&(a.push(o),o={}),o[n]=t[1],void 0!==o.family&&void 0!==o.subset&&void 0!==o.variant&&(s.push(o),o={})}),_.each(a,function(e,i){void 0!==e.family&&s.push(a[i])}),_.each(s,function(e,i){void 0===t[e.family]&&(t[e.family]={variants:[],subsets:[]}),"string"==typeof e.variant&&t[e.family].variants.push(e.variant),"string"==typeof e.subset&&t[e.family].subsets.push(e.subset)})),t},syncGlobalLayouts:function(){var i,t,n=P("#fusion_builder_main_container"),o=!1,a=[];0!==n.find('div[class^="fusion-global-"],div[class*=" fusion-global-"]').length&&P('div[class^="fusion-global-"],div[class*=" fusion-global-"]').each(function(){var e=P(this).attr("fusion-global-layout");1<n.find('[fusion-global-layout="'+e+'"]').length&&P('[fusion-global-layout="'+e+'"]').each(function(){o=!1,P(this).hasClass("fusion-global-container")?o=FusionPageBuilderApp.isChildElementChanged(P(this),"container"):P(this).hasClass("fusion-global-column")&&(o=FusionPageBuilderApp.isChildElementChanged(P(this),"column")),i=void 0===P(this).data("cid")?P(this).find(".fusion-builder-data-cid").data("cid"):P(this).data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(0<_.keys(t.changed).length||!0===o)&&-1===P.inArray(e,a)&&(FusionPageBuilderApp.updateGlobalLayouts(this,t,e),a.push(e))})})},isChildElementChanged:function(e,i){var a,t,s=!1;if("container"===i)e.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var e,i=P(this),t=i.data("cid");if(e=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),0<_.keys(e.changed).length)return!(s=!0);i.find(".fusion-builder-column-outer").each(function(){var e=P(this),o=e.data("cid"),i=FusionPageBuilderElements.find(function(e){return e.get("cid")===o});if(0<_.keys(i.changed).length)return!(s=!0);e.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var e,i,t,n;if(P(this).hasClass("fusion_module_block")){if(e=P(this),i=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),0<_.keys(t.changed).length)return!(s=!0)}else P(this).hasClass("fusion_builder_row_inner")&&(n=P(this).data("cid"),void 0!==FusionPageBuilderViewManager.getView(n)&&(s=FusionPageBuilderApp.isNestedRowChanged("",o)))})})});else if("column"===i){if(a=e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===a}),0<_.keys(t.changed).length)return!(s=!0);e.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var e,i,t,n,o;if(P(this).hasClass("fusion_module_block")){if(e=P(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),0<_.keys(t.changed).length)return!(s=!0)}else P(this).hasClass("fusion_builder_row_inner")&&(o=void 0===(n=P(this)).data("cid")?n.find(".fusion-builder-data-cid").data("cid"):n.data("cid"),void 0!==FusionPageBuilderViewManager.getView(o)&&(s=FusionPageBuilderApp.isNestedRowChanged("",a)))})}return s},isNestedRowChanged:function(e){var n;return e&&e.preventDefault(),0<_.keys(this.model.changed).length?!(n=!0):(this.$el.find(".fusion-builder-column-inner").each(function(){var e=P(this),i=e.data("cid"),t=FusionPageBuilderElements.findWhere({cid:i});if(0<_.keys(t.changed).length)return!(n=!0);e.find(".fusion_module_block").each(function(){var e=P(this),i=void 0===e.data("cid")?e.find(".fusion-builder-data-cid").data("cid"):e.data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i});if(0<_.keys(t.changed).length)return!(n=!0)})}),n)},checkGlobalParents:function(i){var e,t=P("#fusion_builder_main_container");module=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),"undefined"!=typeof module&&(void 0!==module.attributes.params&&void 0!==module.attributes.params.fusion_global&&1<t.find('[fusion-global-layout="'+module.attributes.params.fusion_global+'"]').length&&void 0!==(e=FusionPageBuilderViewManager.getView(module.get("cid")))&&FusionPageBuilderApp.updateGlobalLayouts(e.$el,module,module.attributes.params.fusion_global),void 0!==module.attributes.params&&void 0!==module.get("parent")&&FusionPageBuilderApp.checkGlobalParents(module.get("parent")))},updateGlobalLayouts:function(e,i,t){var n,o,a,s,l=P(e),r="";P(e).hasClass("fusion_builder_column_element")&&!P(e).hasClass("fusion_builder_row_inner")?r+=FusionPageBuilderApp.generateElementShortcode(P(e),!1):P(e).hasClass("fusion_builder_row_inner")?(a=l.data("cid"),s=FusionPageBuilderViewManager.getView(a),r+=s.getInnerRowContent(l)):P(e).hasClass("fusion-builder-column")?(n=P(e).data("cid"),o=FusionPageBuilderViewManager.getView(n),r+=o.getColumnContent(P(e))):P(e).hasClass("fusion_builder_container")&&(r+=FusionPageBuilderApp.generateElementShortcode(P(e),!0),l.find(".fusion_builder_row").each(function(){var e=P(this);r+="[fusion_builder_row]",e.find(".fusion-builder-column-outer").each(function(){var e=P(this),i=e.data("cid"),t=FusionPageBuilderViewManager.getView(i);r+=t.getColumnContent(e)}),r+="[/fusion_builder_row]"}),r+="[/fusion_builder_container]"),P.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_update_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:t,fusion_layout_content:r},complete:function(){}})},saveHistoryState:function(){!0===this.newLayoutLoaded&&(fusionHistoryManager.clearEditor(),this.newLayoutLoaded=!1),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()},generateElementShortcode:function(e,i,t){var n,o,a,s,l,r,u,d,c,f,m,p,g,h,_,b,v,y,w="",B="";for(f in s=void 0!==(n=!0===t?e:(a=void 0===(o=e).data("cid")?o.find(".fusion-builder-data-cid").data("cid"):o.data("cid"),FusionPageBuilderElements.find(function(e){return e.get("cid")===a})))?n.get("element_type"):"undefined",r="",l=n.attributes,(u=void 0!==fusionAllElements[s].remove_from_atts?fusionAllElements[s].remove_from_atts:[]).push("undefined"),d=void 0!==fusionAllElements[s].option_dependency?fusionAllElements[s].option_dependency:"",l)if("params"===(m=f))if(p=void 0!==n.get(m)?n.get(m):"","params"===m)for(g in p)"element_content"===g?(B=h=void 0!==p[g]?p[g]:"",void 0!==p[d]&&""!==d&&(B=void 0!==p[c=void 0!==p[d=fusionAllElements[s].option_dependency]?p[d]:""]?p[c]:"")):((_="")!==d&&(c=void 0!==p[d]?p[d]:"",void 0!==fusionAllElements[s].params[g]&&void 0!==fusionAllElements[s].params[g].dependency&&(v=void 0!==(b=fusionAllElements[s].params[g].dependency).element?b.element:"",y=void 0!==b.value?b.value:"",v===d&&y!==c&&(_="",_=g))),-1<P.inArray(g,u)||_===g||(null===(h=void 0!==p[g]?p[g]:"")&&(h=""),w+=" "+g+'="'+h+'"'));else""!==p&&(w+=" "+m+'="'+p+'"');return r="["+s+w,""===B&&"fusion_tab"!==s&&"fusion_text"!==s&&"fusion_code"!==s&&void 0!==l.type&&"element"===l.type?(i=!0,r+=" /]"):r+="]",i||(r+=B+"[/"+s+"]"),r},customCSS:function(e){e&&e.preventDefault(),P(".fusion-custom-css").slideToggle()},toggleAllContainers:function(e){var i,t,n=this;e&&e.preventDefault(),(i=P(".fusion-builder-layout-buttons-toggle-containers").find("span")).hasClass("dashicons-arrow-up")?(i.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){t=jQuery(this).find(".fusion-builder-data-cid").data("cid"),n.collection.find(function(e){return e.get("cid")===t}).attributes.params.admin_toggled="yes",jQuery(this).addClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down")})):(i.addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){t=jQuery(this).find(".fusion-builder-data-cid").data("cid"),n.collection.find(function(e){return e.get("cid")===t}).attributes.params.admin_toggled="no",jQuery(this).removeClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down")})),FusionPageBuilderEvents.trigger("fusion-element-edited")},showSavedElements:function(e,i){var t,n=jQuery("#fusion-builder-layouts-"+e).find(".fusion-page-layouts").clone();n.find("li").each(function(){t=jQuery(this).find(".fusion-builder-demo-button-load").attr("data-post-id"),jQuery(this).find(".fusion-layout-buttons").remove(),jQuery(this).find("h4").attr("class","fusion_module_title"),jQuery(this).attr("data-layout_id",t),jQuery(this).addClass("fusion_builder_custom_"+e+"_load"),""!==jQuery(this).attr("data-layout_type")&&jQuery(this).addClass("fusion-element-type-"+jQuery(this).attr("data-layout_type"))}),i.append('<div id="fusion-loader"><span class="fusion-builder-loader"></span></div>'),i.append('<ul class="fusion-builder-all-modules">'+n.html()+"</div>")},rangeOptionPreview:function(e){e.find(".fusion-range-option").each(function(){P(this).next().html(P(this).val()),P(this).on("change mousemove",function(){P(this).next().html(P(this).val())})})},addClassToElement:function(e,i,t,n){var o=fusionBuilderText.global_element;e.addClass(i),e.attr("fusion-global-layout",t),"fusion-global-column"===i?o=fusionBuilderText.global_column:"fusion-global-container"===i&&(o=fusionBuilderText.global_container),e.find(".fusion-builder-container-utility-toolbar").length?e.find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>"):e.append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>")},calculateTableData:function(e,i){var t,n,o,a,s,l;return void 0===e.element_content||""===e.element_content||(t=jQuery.parseHTML(e.element_content.trim()),o=(n=jQuery(t).find("tbody > tr")).length+1,a=jQuery(t).find("th").length,s=n.first().children("td").length,l=Math.max(a,s),e.fusion_table_columns=l,e.fusion_table_rows=o),e},checkOptionDependency:function(e,n,o,a,t){var s,l,r,u,i,d,c,f,m={},p="",g="",h=e.params;function _(e,i,t){return"=="===t&&e==i||("!="===t&&e!=i||(">"===t&&i<e||"<"===t&&e<i))}void 0!==a&&(h=a),void 0!==e.shortcode&&"fusion_section_separator"===e.shortcode&&(i=n.find("#divider_type"),d=i.parents("ul").find('li[data-option-id="divider_candy"]').find(".fusion-option-divider_candy").find('.ui-button[data-value="bottom,top"]'),c=i.parents("ul").find('li[data-option-id="divider_position"]').find(".fusion-option-divider_position").find('.ui-button[data-value="center"]'),"triangle"!==i.val()?d.hide():d.show(),"bigtriangle"!==i.val()?c.hide():c.show(),i.on("change paste keyup",function(){"triangle"!==jQuery(this).val()?d.hide():d.show(),"bigtriangle"!==jQuery(this).val()?(c.hide(),c.hasClass("ui-state-active")&&c.prev().click()):c.show()})),jQuery.each(h,function(e,t){void 0!==t.dependency&&(r=e,u=[],jQuery.each(t.dependency,function(e,i){void 0!==a&&"parent_"===i.element.substring(0,7)&&g.indexOf("#"+i.element.replace("parent_",""))<0?g+=", #"+i.element.replace("parent_",""):p.indexOf("#"+i.element)<0&&(p+=", #"+i.element),void 0===m[i.element]?m[i.element]=[{option:r,or:t.or}]:m[i.element].push({option:r,or:t.or}),"parent_"===i.element.substring(0,7)?s=void 0!==a?n.parents(".fusion-builder-main-settings").find("#"+i.element.replace("parent_","")).val():"object"==typeof o&&o[i.element.replace(i.element.substring(0,7),"")]?o[i.element.replace(i.element.substring(0,7),"")]:"":""===(s=n.find("#"+i.element).val())&&"true"===n.find("#"+i.element).closest(".fusion-builder-option").attr("data-dynamic")&&(s="using-dynamic-value"),u.push(_(s,i.value,i.operator))}),f=n.find("#"+e).parents(".fusion-builder-option").first(),-1===P.inArray(!1,u)&&void 0===t.or||-1!==P.inArray(!0,u)&&void 0!==t.or?f.fadeIn(300):f.hide())}),p.length&&n.on("change paste keyup",p.substring(2),function(){l=jQuery(this).attr("id"),jQuery.each(m[l],function(e,i){u=[],jQuery.each(h[i.option].dependency,function(e,i){""===(s="parent_"===i.element.substring(0,7)?"object"==typeof o&&o[i.element.replace(i.element.substring(0,7),"")]?o[i.element.replace(i.element.substring(0,7),"")]:"":n.find("#"+i.element).val())&&"true"===jQuery("#"+l).closest(".fusion-builder-option").attr("data-dynamic")&&(s="using-dynamic-value"),u.push(_(s,i.value,i.operator))}),f=n.find("#"+i.option).parents(".fusion-builder-option").first(),-1===P.inArray(!1,u)&&void 0===i.or||-1!==P.inArray(!0,u)&&void 0!==i.or?f.fadeIn(300):f.hide()})}),void 0!==a&&void 0!==t&&g.length&&t.on("change paste keyup",g.substring(2),function(){l=jQuery(this).attr("id"),jQuery.each(m["parent_"+l],function(e,i){u=[],jQuery.each(h[i.option].dependency,function(e,i){s="parent_"===i.element.substring(0,7)?t.find("#"+i.element.replace("parent_","")).val():t.find("#"+i.element).val(),u.push(_(s,i.value,i.operator))}),f=n.find("#"+i.option).parents(".fusion-builder-option").first(),-1===P.inArray(!1,u)&&void 0===i.or||-1!==P.inArray(!0,u)&&void 0!==i.or?f.fadeIn(300):f.hide()})})}}),FusionPageBuilderApp=new FusionPageBuilder.AppView({model:FusionPageBuilder.Element,collection:FusionPageBuilderElements}),o=P("#fusion_use_builder"),a=P("#fusion_toggle_builder"),s=P("#fusion_builder_layout"),l=P("#fusion_main_editor_wrap"),a.hasClass("fusion_builder_is_active")&&(s.show(),FusionPageBuilderApp.builderActive=!0,c(),jQuery("body").addClass("fusion-builder-enabled")),a.click(function(e){var i,t,n;e&&e.preventDefault(),P(this).hasClass("fusion_builder_is_active")?(P(this),f(),t=P("body"),window.wpActiveEditor="content",o.val("off"),s.hide(),a.children("span").text(a.data("builder")),a.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),l.toggleClass("fusion_builder_hidden"),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),n=t.scrollTop(),jQuery("html, body").scrollTop(n+1),FusionPageBuilderApp.builderActive=!1,jQuery("body").removeClass("fusion-builder-enabled"),jQuery("body").trigger("scroll")):(i=P(this),f(),FusionPageBuilderApp.initialBuilderLayout(),o.val("active"),s.show(),i.children("span").text(i.data("editor")),i.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),l.toggleClass("fusion_builder_hidden"),c(),FusionPageBuilderApp.builderActive=!0,jQuery("body").addClass("fusion-builder-enabled"))}),jQuery("#fusion_toggle_front_end").on("click",function(e){var i=jQuery("#title"),t=jQuery(this);e.preventDefault(),window.confirm(fusionBuilderText.front_end_redirect_confirm)&&(i.val()||i.val("FB #"+jQuery("#post_ID").val()),wp.autosave&&wp.autosave.server.triggerSave(),jQuery(document).on("heartbeat-tick.autosave",function(){jQuery(window).off("beforeunload.edit-post"),window.location=t.attr("href")}))}),P("body").on("click",".upload-image-remove",function(e){var i,t,n,o;e&&e.preventDefault(),i=P(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-field"),t=P(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-preview"),n=P(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-button"),i.val("").trigger("change"),n.val("Upload Image"),t.remove(),o=n.parents(".fusion-builder-option").next().find("#"+n.data("param")+"_id"),"element_content"===n.data("param")&&(o=n.parents(".fusion-builder-option").next().find("#image_id")),o.length&&o.val(""),jQuery(this).remove()}),P("body").on("click",".fusion-builder-history-list li",function(e){var i;e&&e.preventDefault(),i=P(e.currentTarget).data("state-id"),fusionHistoryManager.historyStep(i)}),P("body").on("click",".fusion-tabs-menu a",function(e){var i;e&&e.preventDefault(),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),P(this).parent().addClass("current").removeClass("inactive"),P(this).parent().siblings().removeClass("current").addClass("inactive"),i=P(this).attr("href"),P(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content").not(i).css("display","none"),P(".fusion-builder-layouts-tab").hide(),P(this).parents(".fusion-builder-modal-container").length?P(this).parents(".fusion-builder-modal-container").find(i).fadeIn("fast"):P(i).fadeIn("fast"),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50)}),jQuery(".fusion_builder_modal_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),FusionPageBuilderEvents.trigger("fusion-close-modal")}),jQuery(".fusion_builder_modal_inner_row_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-close-inner-modal"),FusionPageBuilderEvents.trigger("fusion-hide-library")}),e=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+e).show(),jQuery(".fusion-builder-demo-select").on("change",function(){e=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),jQuery(".fusion-builder-demo-page-link").val(""),jQuery("#fusion-builder-layouts-demos .demo-"+e).show()}),jQuery(".fusion-builder-demo-page-link").on("input",function(){var e,i,t,n=jQuery(this).val();"/"===(n=n.replace("https://","").replace("http://",""))[n.length-1]||_.isEmpty(n)||(n+="/"),i=(e=jQuery("#fusion-builder-layouts-demos").find('.fusion-page-layout[data-page-link="'+n+'"]')).closest(".fusion-page-layouts"),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),_.isEmpty(n)?(t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+t).show()):e.length?(i.show(),i.find(".fusion-page-layout").hide(),e.show()):jQuery("#fusion-builder-demo-url-invalid").show()}),jQuery("body").on("click",".icon_select_container .icon_preview",function(e){var i,t="fas",n=jQuery(this).find("i"),o="",a=jQuery(this).closest(".fusion-iconpicker");e.preventDefault(),i="fa-"+jQuery(this).find("i").attr("data-name"),n.hasClass("fas")||n.hasClass("fab")||n.hasClass("far")||n.hasClass("fal")?n.hasClass("fab")?t="fab":n.hasClass("far")?t="far":n.hasClass("fal")&&(t="fal"):o="fusion-prefix-"+jQuery(this).find("i").attr("class"),""===o&&(o=i+" "+t),P(this).hasClass("selected-element")?(a.find(".selected-element").removeClass("selected-element"),a.find(".fusion-iconpicker-input").attr("value","").trigger("change")):(a.find(".selected-element").removeClass("selected-element"),P(this).find("i").parent().addClass("selected-element"),a.find(".fusion-iconpicker-input").attr("value",o).trigger("change"))}),P(document).on("click","#qt_content_fusion_shortcodes_text_mode, #qt_excerpt_fusion_shortcodes_text_mode, #qt_element_content_fusion_shortcodes_text_mode",function(){openShortcodeGenerator(P(this))}),P('input[type="radio"][name="screen_columns"]').on("click",function(){P(window).trigger("resize")}),P(".notice-dismiss, #show-settings-link").on("click",function(){setTimeout(function(){P(window).trigger("resize")},750)}),P("#new_template_name").keydown(function(e){return 13!==e.keyCode&&"13"!==e.keyCode||(e.preventDefault(),e.stopPropagation(),FusionPageBuilderEvents.trigger("fusion-save-layout"),!1)}),P("body").on("keydown","#fusion-builder-save-element-input",function(e){return 13!==e.keyCode&&"13"!==e.keyCode||(e.preventDefault(),e.stopPropagation(),P(".fusion-builder-element-button-save").trigger("click"),!1)}),jQuery(".fusion-preview").click(function(e){e.preventDefault(),jQuery("#post-preview").trigger("click")}),jQuery(".fusion-save-draft").click(function(e){e.preventDefault(),jQuery("#save-post").trigger("click")}),jQuery(".fusion-update").click(function(e){e.preventDefault(),jQuery("#publish").trigger("click")}),i=fusionBuilderConfig.fontawesomeicons,t='<div class="fusion-icons-rendered" style="height:0px; overflow:hidden;">',n={fas:"",fab:"",far:"",fal:""},r={fas:"Solid",far:"Regular",fal:"Light",fab:"Brands"},u='<div class="fusion-icon-picker-nav-rendered" style="height:0px; overflow:hidden;">',d="undefined"!=typeof fusionIconSearch&&Array.isArray(fusionIconSearch),_.each(i,function(i,t){_.each(i[1],function(e){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(e)&&(n[e]+='<span class="icon_preview '+t+'" title="'+t+" - "+r[e]+'"><i class="'+i[0]+" "+e+'" data-name="'+i[0].substr(3)+'"></i></span>')})}),_.each(r,function(e,i){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(i)&&(u+='<a href="#fusion-'+i+'">'+e+"</a>",t+='<div id="fusion-'+i+'" class="fusion-icon-set">'+n[i]+"</div>")}),i=fusionBuilderConfig.customIcons,_.each(i,function(i,e){u+='<a href="#'+e+'">'+i.name+"</a>",t+='<div id="'+e+'" class="fusion-icon-set fusion-custom-icon-set">',_.each(i.icons,function(e){d&&fusionIconSearch.push({name:e}),t+='<span class="icon_preview '+e+'" title="'+i.css_prefix+e+'"><i class="'+i.css_prefix+e+'" data-name="'+e+'"></i></span>'}),t+="</div>"}),u+="</div>",t+="</div>",P("body").append(t+u)})}(jQuery),function(o){window.fusionBuilderInsertIntoEditor=function(e,i){var t,n;"tinymce"!==window.SCmoduleContentEditorMode||""!==i&&void 0!==i?("excerpt"===(t=o(null===i||""===i||void 0===i?window.editorArea:"#"+i)).attr("id")&&(FusionPageBuilderApp.fromExcerpt=!0),void 0===window.cursorPosition?0===t.getCursorPosition()?t.val(e+t.val()):t.val().length===t.getCursorPosition()?t.val(t.val()+e):t.val(t.val().slice(0,t.getCursorPosition())+e+t.val().slice(t.getCursorPosition())):t.val([t.val().slice(0,window.cursorPosition),e,t.val().slice(window.cursorPosition)].join(""))):void 0!==window.tinyMCE&&((n=FusionPageBuilderApp.shortcodeGeneratorActiveEditor).focus(),"excerpt"===n.id&&(FusionPageBuilderApp.fromExcerpt=!0),window.tinyMCE.activeEditor.execCommand("mceInsertContent",!1,e),window.tinyMCE.activeEditor.execCommand("mceCleanup",!1)),!1===FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGeneratorActiveEditor="")}}(jQuery),function(o){o.fn.getCursorPosition=function(){var e,i,t=o(this).get(0),n=0;return"selectionStart"in t?n=t.selectionStart:"selection"in document&&(t.focus(),e=document.selection.createRange(),i=document.selection.createRange().text.length,e.moveStart("character",-t.value.length),n=e.text.length-i),n}}(jQuery),function(n){var o={},a=new Array("[]"),t=new Array("[]"),s=0;window.tracking="on",window.fusionHistoryState="",(window.fusionHistoryManager=o).captureEditor=function(){var e;o.isTrackingOn()&&(25==s?a.shift():s+=1,1<s&&(n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").prepend('<li data-state-id="'+s+'" class="history-state-'+s+' fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionHistoryState+"</li>")),e=fusionBuilderGetContent("content",!0),a[s]=e,t[s]=fusionHistoryState,o.updateButtons(),fusionHistoryState="")},o.turnOnTracking=function(){window.tracking="on","undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.pauseBuilder&&o.turnOffTracking()},o.turnOffTracking=function(){window.tracking="off"},o.doUndo=function(e){var i;e&&e.preventDefault(),o.hasUndo()&&(o.turnOffTracking(),"[]"!==(i=a[--s])&&(FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(i),n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").find(".history-state-"+s).addClass("fusion-history-active-state")),o.updateButtons())},o.doRedo=function(e){var i;e&&e.preventDefault(),o.hasRedo()&&(o.turnOffTracking(),i=a[s+=1],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(i),o.updateButtons(),n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").find(".history-state-"+s).addClass("fusion-history-active-state"))},o.historyStep=function(e,i){var t;i&&i.preventDefault(),t=a[e],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(t),s=e,o.updateButtons(),n(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),n(".fusion-builder-history-list").find(".history-state-"+s).addClass("fusion-history-active-state")},o.isTrackingOn=function(){return"on"===window.tracking},o.logStacks=function(){},o.clearEditor=function(e){var i;a=new Array("[]"),t=new Array("[]"),s=1,fusionHistoryState="","blank"===e?a[s]="":(i=fusionBuilderGetContent("content",!0),a[s]=i),o.updateButtons(),n(".fusion-builder-history-list").html('<li data-state-id="1" class="history-state-1 fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionBuilderText.empty+"</li>")},o.hasUndo=function(){return 1!==s},o.hasRedo=function(){return s<a.length-1},o.getCommands=function(){return a},o.updateButtons=function(){o.hasUndo()?(n(".fusion-builder-layout-buttons-undo").addClass("fusion-history-has-step"),n(".fusion-builder-layout-buttons-history").addClass("fusion-history-has-step")):(n(".fusion-builder-layout-buttons-undo").removeClass("fusion-history-has-step"),n(".fusion-builder-layout-buttons-history").removeClass("fusion-history-has-step")),o.hasRedo()?n(".fusion-builder-layout-buttons-redo").addClass("fusion-history-has-step"):n(".fusion-builder-layout-buttons-redo").removeClass("fusion-history-has-step")}}(jQuery);